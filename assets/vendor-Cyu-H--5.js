var bg=e=>{throw TypeError(e)};var Jd=(e,t,n)=>t.has(e)||bg("Cannot "+n);var q=(e,t,n)=>(Jd(e,t,"read from private field"),n?n.call(e):t.get(e)),Be=(e,t,n)=>t.has(e)?bg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),_e=(e,t,n,r)=>(Jd(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Nt=(e,t,n)=>(Jd(e,t,"access private method"),n);var Hu=(e,t,n,r)=>({set _(o){_e(e,t,o,n)},get _(){return q(e,t,r)}});function $S(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function T1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P1={exports:{}},Jc={},A1={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eu=Symbol.for("react.element"),US=Symbol.for("react.portal"),VS=Symbol.for("react.fragment"),jS=Symbol.for("react.strict_mode"),HS=Symbol.for("react.profiler"),GS=Symbol.for("react.provider"),KS=Symbol.for("react.context"),qS=Symbol.for("react.forward_ref"),XS=Symbol.for("react.suspense"),YS=Symbol.for("react.memo"),QS=Symbol.for("react.lazy"),Cg=Symbol.iterator;function JS(e){return e===null||typeof e!="object"?null:(e=Cg&&e[Cg]||e["@@iterator"],typeof e=="function"?e:null)}var N1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D1=Object.assign,M1={};function es(e,t,n){this.props=e,this.context=t,this.refs=M1,this.updater=n||N1}es.prototype.isReactComponent={};es.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};es.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F1(){}F1.prototype=es.prototype;function Qp(e,t,n){this.props=e,this.context=t,this.refs=M1,this.updater=n||N1}var Jp=Qp.prototype=new F1;Jp.constructor=Qp;D1(Jp,es.prototype);Jp.isPureReactComponent=!0;var Eg=Array.isArray,O1=Object.prototype.hasOwnProperty,Zp={current:null},L1={key:!0,ref:!0,__self:!0,__source:!0};function B1(e,t,n){var r,o={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)O1.call(t,r)&&!L1.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Eu,type:e,key:i,ref:a,props:o,_owner:Zp.current}}function ZS(e,t){return{$$typeof:Eu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ev(e){return typeof e=="object"&&e!==null&&e.$$typeof===Eu}function e_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Sg=/\/+/g;function Zd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?e_(""+e.key):t.toString(36)}function Nl(e,t,n,r,o){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Eu:case US:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+Zd(a,0):r,Eg(o)?(n="",e!=null&&(n=e.replace(Sg,"$&/")+"/"),Nl(o,t,n,"",function(l){return l})):o!=null&&(ev(o)&&(o=ZS(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(Sg,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",Eg(e))for(var s=0;s<e.length;s++){i=e[s];var u=r+Zd(i,s);a+=Nl(i,t,n,u,o)}else if(u=JS(e),typeof u=="function")for(e=u.call(e),s=0;!(i=e.next()).done;)i=i.value,u=r+Zd(i,s++),a+=Nl(i,t,n,u,o);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Gu(e,t,n){if(e==null)return e;var r=[],o=0;return Nl(e,r,"","",function(i){return t.call(n,i,o++)}),r}function t_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qt={current:null},Dl={transition:null},n_={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:Dl,ReactCurrentOwner:Zp};function W1(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:Gu,forEach:function(e,t,n){Gu(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Gu(e,function(){t++}),t},toArray:function(e){return Gu(e,function(t){return t})||[]},only:function(e){if(!ev(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Te.Component=es;Te.Fragment=VS;Te.Profiler=HS;Te.PureComponent=Qp;Te.StrictMode=jS;Te.Suspense=XS;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n_;Te.act=W1;Te.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=D1({},e.props),o=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Zp.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)O1.call(t,u)&&!L1.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Eu,type:e.type,key:o,ref:i,props:r,_owner:a}};Te.createContext=function(e){return e={$$typeof:KS,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:GS,_context:e},e.Consumer=e};Te.createElement=B1;Te.createFactory=function(e){var t=B1.bind(null,e);return t.type=e,t};Te.createRef=function(){return{current:null}};Te.forwardRef=function(e){return{$$typeof:qS,render:e}};Te.isValidElement=ev;Te.lazy=function(e){return{$$typeof:QS,_payload:{_status:-1,_result:e},_init:t_}};Te.memo=function(e,t){return{$$typeof:YS,type:e,compare:t===void 0?null:t}};Te.startTransition=function(e){var t=Dl.transition;Dl.transition={};try{e()}finally{Dl.transition=t}};Te.unstable_act=W1;Te.useCallback=function(e,t){return qt.current.useCallback(e,t)};Te.useContext=function(e){return qt.current.useContext(e)};Te.useDebugValue=function(){};Te.useDeferredValue=function(e){return qt.current.useDeferredValue(e)};Te.useEffect=function(e,t){return qt.current.useEffect(e,t)};Te.useId=function(){return qt.current.useId()};Te.useImperativeHandle=function(e,t,n){return qt.current.useImperativeHandle(e,t,n)};Te.useInsertionEffect=function(e,t){return qt.current.useInsertionEffect(e,t)};Te.useLayoutEffect=function(e,t){return qt.current.useLayoutEffect(e,t)};Te.useMemo=function(e,t){return qt.current.useMemo(e,t)};Te.useReducer=function(e,t,n){return qt.current.useReducer(e,t,n)};Te.useRef=function(e){return qt.current.useRef(e)};Te.useState=function(e){return qt.current.useState(e)};Te.useSyncExternalStore=function(e,t,n){return qt.current.useSyncExternalStore(e,t,n)};Te.useTransition=function(){return qt.current.useTransition()};Te.version="18.3.1";A1.exports=Te;var E=A1.exports;const Z=T1(E),z1=$S({__proto__:null,default:Z},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r_=E,o_=Symbol.for("react.element"),i_=Symbol.for("react.fragment"),a_=Object.prototype.hasOwnProperty,s_=r_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u_={key:!0,ref:!0,__self:!0,__source:!0};function $1(e,t,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)a_.call(t,r)&&!u_.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:o_,type:e,key:i,ref:a,props:o,_owner:s_.current}}Jc.Fragment=i_;Jc.jsx=$1;Jc.jsxs=$1;P1.exports=Jc;var $=P1.exports,U1={exports:{}},In={},V1={exports:{}},j1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,F){var U=A.length;A.push(F);e:for(;0<U;){var j=U-1>>>1,K=A[j];if(0<o(K,F))A[j]=F,A[U]=K,U=j;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var F=A[0],U=A.pop();if(U!==F){A[0]=U;e:for(var j=0,K=A.length,Y=K>>>1;j<Y;){var ne=2*(j+1)-1,pe=A[ne],te=ne+1,J=A[te];if(0>o(pe,U))te<K&&0>o(J,pe)?(A[j]=J,A[te]=U,j=te):(A[j]=pe,A[ne]=U,j=ne);else if(te<K&&0>o(J,U))A[j]=J,A[te]=U,j=te;else break e}}return F}function o(A,F){var U=A.sortIndex-F.sortIndex;return U!==0?U:A.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,d=null,f=3,h=!1,v=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(A){for(var F=n(l);F!==null;){if(F.callback===null)r(l);else if(F.startTime<=A)r(l),F.sortIndex=F.expirationTime,t(u,F);else break;F=n(l)}}function w(A){if(p=!1,x(A),!v)if(n(u)!==null)v=!0,B(b);else{var F=n(l);F!==null&&z(w,F.startTime-A)}}function b(A,F){v=!1,p&&(p=!1,m(_),_=-1),h=!0;var U=f;try{for(x(F),d=n(u);d!==null&&(!(d.expirationTime>F)||A&&!N());){var j=d.callback;if(typeof j=="function"){d.callback=null,f=d.priorityLevel;var K=j(d.expirationTime<=F);F=e.unstable_now(),typeof K=="function"?d.callback=K:d===n(u)&&r(u),x(F)}else r(u);d=n(u)}if(d!==null)var Y=!0;else{var ne=n(l);ne!==null&&z(w,ne.startTime-F),Y=!1}return Y}finally{d=null,f=U,h=!1}}var C=!1,S=null,_=-1,k=5,R=-1;function N(){return!(e.unstable_now()-R<k)}function P(){if(S!==null){var A=e.unstable_now();R=A;var F=!0;try{F=S(!0,A)}finally{F?L():(C=!1,S=null)}}else C=!1}var L;if(typeof y=="function")L=function(){y(P)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,W=M.port2;M.port1.onmessage=P,L=function(){W.postMessage(null)}}else L=function(){g(P,0)};function B(A){S=A,C||(C=!0,L())}function z(A,F){_=g(function(){A(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,B(b))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(A){switch(f){case 1:case 2:case 3:var F=3;break;default:F=f}var U=f;f=F;try{return A()}finally{f=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,F){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var U=f;f=A;try{return F()}finally{f=U}},e.unstable_scheduleCallback=function(A,F,U){var j=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?j+U:j):U=j,A){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=U+K,A={id:c++,callback:F,priorityLevel:A,startTime:U,expirationTime:K,sortIndex:-1},U>j?(A.sortIndex=U,t(l,A),n(u)===null&&A===n(l)&&(p?(m(_),_=-1):p=!0,z(w,U-j))):(A.sortIndex=K,t(u,A),v||h||(v=!0,B(b))),A},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(A){var F=f;return function(){var U=f;f=F;try{return A.apply(this,arguments)}finally{f=U}}}})(j1);V1.exports=j1;var l_=V1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c_=E,kn=l_;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H1=new Set,Vs={};function Mi(e,t){za(e,t),za(e+"Capture",t)}function za(e,t){for(Vs[e]=t,e=0;e<t.length;e++)H1.add(t[e])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dh=Object.prototype.hasOwnProperty,d_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_g={},kg={};function f_(e){return dh.call(kg,e)?!0:dh.call(_g,e)?!1:d_.test(e)?kg[e]=!0:(_g[e]=!0,!1)}function h_(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function p_(e,t,n,r){if(t===null||typeof t>"u"||h_(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xt(e,t,n,r,o,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){At[e]=new Xt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];At[t]=new Xt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){At[e]=new Xt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){At[e]=new Xt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){At[e]=new Xt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){At[e]=new Xt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){At[e]=new Xt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){At[e]=new Xt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){At[e]=new Xt(e,5,!1,e.toLowerCase(),null,!1,!1)});var tv=/[\-:]([a-z])/g;function nv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(tv,nv);At[t]=new Xt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(tv,nv);At[t]=new Xt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(tv,nv);At[t]=new Xt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){At[e]=new Xt(e,1,!1,e.toLowerCase(),null,!1,!1)});At.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){At[e]=new Xt(e,1,!1,e.toLowerCase(),null,!0,!0)});function rv(e,t,n,r){var o=At.hasOwnProperty(t)?At[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(p_(t,n,o,r)&&(n=null),r||o===null?f_(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var to=c_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ku=Symbol.for("react.element"),na=Symbol.for("react.portal"),ra=Symbol.for("react.fragment"),ov=Symbol.for("react.strict_mode"),fh=Symbol.for("react.profiler"),G1=Symbol.for("react.provider"),K1=Symbol.for("react.context"),iv=Symbol.for("react.forward_ref"),hh=Symbol.for("react.suspense"),ph=Symbol.for("react.suspense_list"),av=Symbol.for("react.memo"),yo=Symbol.for("react.lazy"),q1=Symbol.for("react.offscreen"),Rg=Symbol.iterator;function fs(e){return e===null||typeof e!="object"?null:(e=Rg&&e[Rg]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,ef;function ks(e){if(ef===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ef=t&&t[1]||""}return`
`+ef+e}var tf=!1;function nf(e,t){if(!e||tf)return"";tf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=s);break}}}finally{tf=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ks(e):""}function v_(e){switch(e.tag){case 5:return ks(e.type);case 16:return ks("Lazy");case 13:return ks("Suspense");case 19:return ks("SuspenseList");case 0:case 2:case 15:return e=nf(e.type,!1),e;case 11:return e=nf(e.type.render,!1),e;case 1:return e=nf(e.type,!0),e;default:return""}}function vh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ra:return"Fragment";case na:return"Portal";case fh:return"Profiler";case ov:return"StrictMode";case hh:return"Suspense";case ph:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case K1:return(e.displayName||"Context")+".Consumer";case G1:return(e._context.displayName||"Context")+".Provider";case iv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case av:return t=e.displayName||null,t!==null?t:vh(e.type)||"Memo";case yo:t=e._payload,e=e._init;try{return vh(e(t))}catch{}}return null}function m_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vh(t);case 8:return t===ov?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function X1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function g_(e){var t=X1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function qu(e){e._valueTracker||(e._valueTracker=g_(e))}function Y1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=X1(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ql(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function mh(e,t){var n=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Ig(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=jo(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Q1(e,t){t=t.checked,t!=null&&rv(e,"checked",t,!1)}function gh(e,t){Q1(e,t);var n=jo(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?yh(e,t.type,n):t.hasOwnProperty("defaultValue")&&yh(e,t.type,jo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Tg(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function yh(e,t,n){(t!=="number"||ql(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Rs=Array.isArray;function pa(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+jo(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function xh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Pg(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Q(92));if(Rs(n)){if(1<n.length)throw Error(Q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:jo(n)}}function J1(e,t){var n=jo(t.value),r=jo(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ag(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Z1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Z1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Xu,ex=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Xu=Xu||document.createElement("div"),Xu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Xu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function js(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var As={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},y_=["Webkit","ms","Moz","O"];Object.keys(As).forEach(function(e){y_.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),As[t]=As[e]})});function tx(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||As.hasOwnProperty(e)&&As[e]?(""+t).trim():t+"px"}function nx(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=tx(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var x_=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bh(e,t){if(t){if(x_[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function Ch(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eh=null;function sv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Sh=null,va=null,ma=null;function Ng(e){if(e=ku(e)){if(typeof Sh!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=rd(t),Sh(e.stateNode,e.type,t))}}function rx(e){va?ma?ma.push(e):ma=[e]:va=e}function ox(){if(va){var e=va,t=ma;if(ma=va=null,Ng(e),t)for(e=0;e<t.length;e++)Ng(t[e])}}function ix(e,t){return e(t)}function ax(){}var rf=!1;function sx(e,t,n){if(rf)return e(t,n);rf=!0;try{return ix(e,t,n)}finally{rf=!1,(va!==null||ma!==null)&&(ax(),ox())}}function Hs(e,t){var n=e.stateNode;if(n===null)return null;var r=rd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Q(231,t,typeof n));return n}var _h=!1;if(qr)try{var hs={};Object.defineProperty(hs,"passive",{get:function(){_h=!0}}),window.addEventListener("test",hs,hs),window.removeEventListener("test",hs,hs)}catch{_h=!1}function w_(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Ns=!1,Xl=null,Yl=!1,kh=null,b_={onError:function(e){Ns=!0,Xl=e}};function C_(e,t,n,r,o,i,a,s,u){Ns=!1,Xl=null,w_.apply(b_,arguments)}function E_(e,t,n,r,o,i,a,s,u){if(C_.apply(this,arguments),Ns){if(Ns){var l=Xl;Ns=!1,Xl=null}else throw Error(Q(198));Yl||(Yl=!0,kh=l)}}function Fi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ux(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Dg(e){if(Fi(e)!==e)throw Error(Q(188))}function S_(e){var t=e.alternate;if(!t){if(t=Fi(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Dg(o),e;if(i===r)return Dg(o),t;i=i.sibling}throw Error(Q(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?e:t}function lx(e){return e=S_(e),e!==null?cx(e):null}function cx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=cx(e);if(t!==null)return t;e=e.sibling}return null}var dx=kn.unstable_scheduleCallback,Mg=kn.unstable_cancelCallback,__=kn.unstable_shouldYield,k_=kn.unstable_requestPaint,it=kn.unstable_now,R_=kn.unstable_getCurrentPriorityLevel,uv=kn.unstable_ImmediatePriority,fx=kn.unstable_UserBlockingPriority,Ql=kn.unstable_NormalPriority,I_=kn.unstable_LowPriority,hx=kn.unstable_IdlePriority,Zc=null,_r=null;function T_(e){if(_r&&typeof _r.onCommitFiberRoot=="function")try{_r.onCommitFiberRoot(Zc,e,void 0,(e.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:N_,P_=Math.log,A_=Math.LN2;function N_(e){return e>>>=0,e===0?32:31-(P_(e)/A_|0)|0}var Yu=64,Qu=4194304;function Is(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Is(s):(i&=a,i!==0&&(r=Is(i)))}else a=n&~o,a!==0?r=Is(a):i!==0&&(r=Is(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,i=t&-t,o>=i||o===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-er(t),o=1<<n,r|=e[n],t&=~o;return r}function D_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function M_(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-er(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=D_(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}function Rh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function px(){var e=Yu;return Yu<<=1,!(Yu&4194240)&&(Yu=64),e}function of(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Su(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-er(t),e[t]=n}function F_(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-er(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}function lv(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-er(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var ze=0;function vx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var mx,cv,gx,yx,xx,Ih=!1,Ju=[],Do=null,Mo=null,Fo=null,Gs=new Map,Ks=new Map,wo=[],O_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fg(e,t){switch(e){case"focusin":case"focusout":Do=null;break;case"dragenter":case"dragleave":Mo=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":Gs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ks.delete(t.pointerId)}}function ps(e,t,n,r,o,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},t!==null&&(t=ku(t),t!==null&&cv(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function L_(e,t,n,r,o){switch(t){case"focusin":return Do=ps(Do,e,t,n,r,o),!0;case"dragenter":return Mo=ps(Mo,e,t,n,r,o),!0;case"mouseover":return Fo=ps(Fo,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Gs.set(i,ps(Gs.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ks.set(i,ps(Ks.get(i)||null,e,t,n,r,o)),!0}return!1}function wx(e){var t=hi(e.target);if(t!==null){var n=Fi(t);if(n!==null){if(t=n.tag,t===13){if(t=ux(n),t!==null){e.blockedOn=t,xx(e.priority,function(){gx(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Th(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Eh=r,n.target.dispatchEvent(r),Eh=null}else return t=ku(n),t!==null&&cv(t),e.blockedOn=n,!1;t.shift()}return!0}function Og(e,t,n){Ml(e)&&n.delete(t)}function B_(){Ih=!1,Do!==null&&Ml(Do)&&(Do=null),Mo!==null&&Ml(Mo)&&(Mo=null),Fo!==null&&Ml(Fo)&&(Fo=null),Gs.forEach(Og),Ks.forEach(Og)}function vs(e,t){e.blockedOn===t&&(e.blockedOn=null,Ih||(Ih=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,B_)))}function qs(e){function t(o){return vs(o,e)}if(0<Ju.length){vs(Ju[0],e);for(var n=1;n<Ju.length;n++){var r=Ju[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Do!==null&&vs(Do,e),Mo!==null&&vs(Mo,e),Fo!==null&&vs(Fo,e),Gs.forEach(t),Ks.forEach(t),n=0;n<wo.length;n++)r=wo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<wo.length&&(n=wo[0],n.blockedOn===null);)wx(n),n.blockedOn===null&&wo.shift()}var ga=to.ReactCurrentBatchConfig,Zl=!0;function W_(e,t,n,r){var o=ze,i=ga.transition;ga.transition=null;try{ze=1,dv(e,t,n,r)}finally{ze=o,ga.transition=i}}function z_(e,t,n,r){var o=ze,i=ga.transition;ga.transition=null;try{ze=4,dv(e,t,n,r)}finally{ze=o,ga.transition=i}}function dv(e,t,n,r){if(Zl){var o=Th(e,t,n,r);if(o===null)vf(e,t,r,ec,n),Fg(e,r);else if(L_(o,e,t,n,r))r.stopPropagation();else if(Fg(e,r),t&4&&-1<O_.indexOf(e)){for(;o!==null;){var i=ku(o);if(i!==null&&mx(i),i=Th(e,t,n,r),i===null&&vf(e,t,r,ec,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else vf(e,t,r,null,n)}}var ec=null;function Th(e,t,n,r){if(ec=null,e=sv(r),e=hi(e),e!==null)if(t=Fi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=ux(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ec=e,null}function bx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(R_()){case uv:return 1;case fx:return 4;case Ql:case I_:return 16;case hx:return 536870912;default:return 16}default:return 16}}var Ro=null,fv=null,Fl=null;function Cx(){if(Fl)return Fl;var e,t=fv,n=t.length,r,o="value"in Ro?Ro.value:Ro.textContent,i=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[i-r];r++);return Fl=o.slice(e,1<r?1-r:void 0)}function Ol(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zu(){return!0}function Lg(){return!1}function Tn(e){function t(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zu:Lg,this.isPropagationStopped=Lg,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zu)},persist:function(){},isPersistent:Zu}),t}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hv=Tn(ts),_u=et({},ts,{view:0,detail:0}),$_=Tn(_u),af,sf,ms,ed=et({},_u,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ms&&(ms&&e.type==="mousemove"?(af=e.screenX-ms.screenX,sf=e.screenY-ms.screenY):sf=af=0,ms=e),af)},movementY:function(e){return"movementY"in e?e.movementY:sf}}),Bg=Tn(ed),U_=et({},ed,{dataTransfer:0}),V_=Tn(U_),j_=et({},_u,{relatedTarget:0}),uf=Tn(j_),H_=et({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),G_=Tn(H_),K_=et({},ts,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),q_=Tn(K_),X_=et({},ts,{data:0}),Wg=Tn(X_),Y_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Q_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},J_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Z_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=J_[e])?!!t[e]:!1}function pv(){return Z_}var ek=et({},_u,{key:function(e){if(e.key){var t=Y_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ol(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Q_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pv,charCode:function(e){return e.type==="keypress"?Ol(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ol(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),tk=Tn(ek),nk=et({},ed,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zg=Tn(nk),rk=et({},_u,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pv}),ok=Tn(rk),ik=et({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),ak=Tn(ik),sk=et({},ed,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),uk=Tn(sk),lk=[9,13,27,32],vv=qr&&"CompositionEvent"in window,Ds=null;qr&&"documentMode"in document&&(Ds=document.documentMode);var ck=qr&&"TextEvent"in window&&!Ds,Ex=qr&&(!vv||Ds&&8<Ds&&11>=Ds),$g=" ",Ug=!1;function Sx(e,t){switch(e){case"keyup":return lk.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _x(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var oa=!1;function dk(e,t){switch(e){case"compositionend":return _x(t);case"keypress":return t.which!==32?null:(Ug=!0,$g);case"textInput":return e=t.data,e===$g&&Ug?null:e;default:return null}}function fk(e,t){if(oa)return e==="compositionend"||!vv&&Sx(e,t)?(e=Cx(),Fl=fv=Ro=null,oa=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ex&&t.locale!=="ko"?null:t.data;default:return null}}var hk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!hk[e.type]:t==="textarea"}function kx(e,t,n,r){rx(r),t=tc(t,"onChange"),0<t.length&&(n=new hv("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ms=null,Xs=null;function pk(e){Lx(e,0)}function td(e){var t=sa(e);if(Y1(t))return e}function vk(e,t){if(e==="change")return t}var Rx=!1;if(qr){var lf;if(qr){var cf="oninput"in document;if(!cf){var jg=document.createElement("div");jg.setAttribute("oninput","return;"),cf=typeof jg.oninput=="function"}lf=cf}else lf=!1;Rx=lf&&(!document.documentMode||9<document.documentMode)}function Hg(){Ms&&(Ms.detachEvent("onpropertychange",Ix),Xs=Ms=null)}function Ix(e){if(e.propertyName==="value"&&td(Xs)){var t=[];kx(t,Xs,e,sv(e)),sx(pk,t)}}function mk(e,t,n){e==="focusin"?(Hg(),Ms=t,Xs=n,Ms.attachEvent("onpropertychange",Ix)):e==="focusout"&&Hg()}function gk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return td(Xs)}function yk(e,t){if(e==="click")return td(t)}function xk(e,t){if(e==="input"||e==="change")return td(t)}function wk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rr=typeof Object.is=="function"?Object.is:wk;function Ys(e,t){if(rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!dh.call(t,o)||!rr(e[o],t[o]))return!1}return!0}function Gg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Kg(e,t){var n=Gg(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gg(n)}}function Tx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Tx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Px(){for(var e=window,t=ql();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ql(e.document)}return t}function mv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function bk(e){var t=Px(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Tx(n.ownerDocument.documentElement,n)){if(r!==null&&mv(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=Kg(n,i);var a=Kg(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ck=qr&&"documentMode"in document&&11>=document.documentMode,ia=null,Ph=null,Fs=null,Ah=!1;function qg(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ah||ia==null||ia!==ql(r)||(r=ia,"selectionStart"in r&&mv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fs&&Ys(Fs,r)||(Fs=r,r=tc(Ph,"onSelect"),0<r.length&&(t=new hv("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ia)))}function el(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var aa={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionend:el("Transition","TransitionEnd")},df={},Ax={};qr&&(Ax=document.createElement("div").style,"AnimationEvent"in window||(delete aa.animationend.animation,delete aa.animationiteration.animation,delete aa.animationstart.animation),"TransitionEvent"in window||delete aa.transitionend.transition);function nd(e){if(df[e])return df[e];if(!aa[e])return e;var t=aa[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ax)return df[e]=t[n];return e}var Nx=nd("animationend"),Dx=nd("animationiteration"),Mx=nd("animationstart"),Fx=nd("transitionend"),Ox=new Map,Xg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qo(e,t){Ox.set(e,t),Mi(t,[e])}for(var ff=0;ff<Xg.length;ff++){var hf=Xg[ff],Ek=hf.toLowerCase(),Sk=hf[0].toUpperCase()+hf.slice(1);Qo(Ek,"on"+Sk)}Qo(Nx,"onAnimationEnd");Qo(Dx,"onAnimationIteration");Qo(Mx,"onAnimationStart");Qo("dblclick","onDoubleClick");Qo("focusin","onFocus");Qo("focusout","onBlur");Qo(Fx,"onTransitionEnd");za("onMouseEnter",["mouseout","mouseover"]);za("onMouseLeave",["mouseout","mouseover"]);za("onPointerEnter",["pointerout","pointerover"]);za("onPointerLeave",["pointerout","pointerover"]);Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ts="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_k=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ts));function Yg(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,E_(r,t,void 0,e),e.currentTarget=null}function Lx(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;Yg(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;Yg(o,s,l),i=u}}}if(Yl)throw e=kh,Yl=!1,kh=null,e}function Ge(e,t){var n=t[Oh];n===void 0&&(n=t[Oh]=new Set);var r=e+"__bubble";n.has(r)||(Bx(t,e,2,!1),n.add(r))}function pf(e,t,n){var r=0;t&&(r|=4),Bx(n,e,r,t)}var tl="_reactListening"+Math.random().toString(36).slice(2);function Qs(e){if(!e[tl]){e[tl]=!0,H1.forEach(function(n){n!=="selectionchange"&&(_k.has(n)||pf(n,!1,e),pf(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[tl]||(t[tl]=!0,pf("selectionchange",!1,t))}}function Bx(e,t,n,r){switch(bx(t)){case 1:var o=W_;break;case 4:o=z_;break;default:o=dv}n=o.bind(null,t,n,e),o=void 0,!_h||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function vf(e,t,n,r,o){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=hi(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}sx(function(){var l=i,c=sv(n),d=[];e:{var f=Ox.get(e);if(f!==void 0){var h=hv,v=e;switch(e){case"keypress":if(Ol(n)===0)break e;case"keydown":case"keyup":h=tk;break;case"focusin":v="focus",h=uf;break;case"focusout":v="blur",h=uf;break;case"beforeblur":case"afterblur":h=uf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Bg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=V_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=ok;break;case Nx:case Dx:case Mx:h=G_;break;case Fx:h=ak;break;case"scroll":h=$_;break;case"wheel":h=uk;break;case"copy":case"cut":case"paste":h=q_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=zg}var p=(t&4)!==0,g=!p&&e==="scroll",m=p?f!==null?f+"Capture":null:f;p=[];for(var y=l,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,m!==null&&(w=Hs(y,m),w!=null&&p.push(Js(y,w,x)))),g)break;y=y.return}0<p.length&&(f=new h(f,v,null,n,c),d.push({event:f,listeners:p}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==Eh&&(v=n.relatedTarget||n.fromElement)&&(hi(v)||v[Xr]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(v=n.relatedTarget||n.toElement,h=l,v=v?hi(v):null,v!==null&&(g=Fi(v),v!==g||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=l),h!==v)){if(p=Bg,w="onMouseLeave",m="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=zg,w="onPointerLeave",m="onPointerEnter",y="pointer"),g=h==null?f:sa(h),x=v==null?f:sa(v),f=new p(w,y+"leave",h,n,c),f.target=g,f.relatedTarget=x,w=null,hi(c)===l&&(p=new p(m,y+"enter",v,n,c),p.target=x,p.relatedTarget=g,w=p),g=w,h&&v)t:{for(p=h,m=v,y=0,x=p;x;x=ji(x))y++;for(x=0,w=m;w;w=ji(w))x++;for(;0<y-x;)p=ji(p),y--;for(;0<x-y;)m=ji(m),x--;for(;y--;){if(p===m||m!==null&&p===m.alternate)break t;p=ji(p),m=ji(m)}p=null}else p=null;h!==null&&Qg(d,f,h,p,!1),v!==null&&g!==null&&Qg(d,g,v,p,!0)}}e:{if(f=l?sa(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=vk;else if(Vg(f))if(Rx)b=xk;else{b=gk;var C=mk}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=yk);if(b&&(b=b(e,l))){kx(d,b,n,c);break e}C&&C(e,f,l),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&yh(f,"number",f.value)}switch(C=l?sa(l):window,e){case"focusin":(Vg(C)||C.contentEditable==="true")&&(ia=C,Ph=l,Fs=null);break;case"focusout":Fs=Ph=ia=null;break;case"mousedown":Ah=!0;break;case"contextmenu":case"mouseup":case"dragend":Ah=!1,qg(d,n,c);break;case"selectionchange":if(Ck)break;case"keydown":case"keyup":qg(d,n,c)}var S;if(vv)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else oa?Sx(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Ex&&n.locale!=="ko"&&(oa||_!=="onCompositionStart"?_==="onCompositionEnd"&&oa&&(S=Cx()):(Ro=c,fv="value"in Ro?Ro.value:Ro.textContent,oa=!0)),C=tc(l,_),0<C.length&&(_=new Wg(_,e,null,n,c),d.push({event:_,listeners:C}),S?_.data=S:(S=_x(n),S!==null&&(_.data=S)))),(S=ck?dk(e,n):fk(e,n))&&(l=tc(l,"onBeforeInput"),0<l.length&&(c=new Wg("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=S))}Lx(d,t)})}function Js(e,t,n){return{instance:e,listener:t,currentTarget:n}}function tc(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Hs(e,n),i!=null&&r.unshift(Js(e,i,o)),i=Hs(e,t),i!=null&&r.push(Js(e,i,o))),e=e.return}return r}function ji(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Qg(e,t,n,r,o){for(var i=t._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=Hs(n,i),u!=null&&a.unshift(Js(n,u,s))):o||(u=Hs(n,i),u!=null&&a.push(Js(n,u,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var kk=/\r\n?/g,Rk=/\u0000|\uFFFD/g;function Jg(e){return(typeof e=="string"?e:""+e).replace(kk,`
`).replace(Rk,"")}function nl(e,t,n){if(t=Jg(t),Jg(e)!==t&&n)throw Error(Q(425))}function nc(){}var Nh=null,Dh=null;function Mh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fh=typeof setTimeout=="function"?setTimeout:void 0,Ik=typeof clearTimeout=="function"?clearTimeout:void 0,Zg=typeof Promise=="function"?Promise:void 0,Tk=typeof queueMicrotask=="function"?queueMicrotask:typeof Zg<"u"?function(e){return Zg.resolve(null).then(e).catch(Pk)}:Fh;function Pk(e){setTimeout(function(){throw e})}function mf(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),qs(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);qs(t)}function Oo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ey(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ns=Math.random().toString(36).slice(2),wr="__reactFiber$"+ns,Zs="__reactProps$"+ns,Xr="__reactContainer$"+ns,Oh="__reactEvents$"+ns,Ak="__reactListeners$"+ns,Nk="__reactHandles$"+ns;function hi(e){var t=e[wr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Xr]||n[wr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ey(e);e!==null;){if(n=e[wr])return n;e=ey(e)}return t}e=n,n=e.parentNode}return null}function ku(e){return e=e[wr]||e[Xr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function rd(e){return e[Zs]||null}var Lh=[],ua=-1;function Jo(e){return{current:e}}function qe(e){0>ua||(e.current=Lh[ua],Lh[ua]=null,ua--)}function Ue(e,t){ua++,Lh[ua]=e.current,e.current=t}var Ho={},Ut=Jo(Ho),nn=Jo(!1),ki=Ho;function $a(e,t){var n=e.type.contextTypes;if(!n)return Ho;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function rn(e){return e=e.childContextTypes,e!=null}function rc(){qe(nn),qe(Ut)}function ty(e,t,n){if(Ut.current!==Ho)throw Error(Q(168));Ue(Ut,t),Ue(nn,n)}function Wx(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(Q(108,m_(e)||"Unknown",o));return et({},n,r)}function oc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ho,ki=Ut.current,Ue(Ut,e),Ue(nn,nn.current),!0}function ny(e,t,n){var r=e.stateNode;if(!r)throw Error(Q(169));n?(e=Wx(e,t,ki),r.__reactInternalMemoizedMergedChildContext=e,qe(nn),qe(Ut),Ue(Ut,e)):qe(nn),Ue(nn,n)}var Vr=null,od=!1,gf=!1;function zx(e){Vr===null?Vr=[e]:Vr.push(e)}function Dk(e){od=!0,zx(e)}function Zo(){if(!gf&&Vr!==null){gf=!0;var e=0,t=ze;try{var n=Vr;for(ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Vr=null,od=!1}catch(o){throw Vr!==null&&(Vr=Vr.slice(e+1)),dx(uv,Zo),o}finally{ze=t,gf=!1}}return null}var la=[],ca=0,ic=null,ac=0,Nn=[],Dn=0,Ri=null,Hr=1,Gr="";function ui(e,t){la[ca++]=ac,la[ca++]=ic,ic=e,ac=t}function $x(e,t,n){Nn[Dn++]=Hr,Nn[Dn++]=Gr,Nn[Dn++]=Ri,Ri=e;var r=Hr;e=Gr;var o=32-er(r)-1;r&=~(1<<o),n+=1;var i=32-er(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Hr=1<<32-er(t)+o|n<<o|r,Gr=i+e}else Hr=1<<i|n<<o|r,Gr=e}function gv(e){e.return!==null&&(ui(e,1),$x(e,1,0))}function yv(e){for(;e===ic;)ic=la[--ca],la[ca]=null,ac=la[--ca],la[ca]=null;for(;e===Ri;)Ri=Nn[--Dn],Nn[Dn]=null,Gr=Nn[--Dn],Nn[Dn]=null,Hr=Nn[--Dn],Nn[Dn]=null}var En=null,xn=null,Xe=!1,Qn=null;function Ux(e,t){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ry(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,En=e,xn=Oo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,En=e,xn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ri!==null?{id:Hr,overflow:Gr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,En=e,xn=null,!0):!1;default:return!1}}function Bh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Wh(e){if(Xe){var t=xn;if(t){var n=t;if(!ry(e,t)){if(Bh(e))throw Error(Q(418));t=Oo(n.nextSibling);var r=En;t&&ry(e,t)?Ux(r,n):(e.flags=e.flags&-4097|2,Xe=!1,En=e)}}else{if(Bh(e))throw Error(Q(418));e.flags=e.flags&-4097|2,Xe=!1,En=e}}}function oy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;En=e}function rl(e){if(e!==En)return!1;if(!Xe)return oy(e),Xe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Mh(e.type,e.memoizedProps)),t&&(t=xn)){if(Bh(e))throw Vx(),Error(Q(418));for(;t;)Ux(e,t),t=Oo(t.nextSibling)}if(oy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){xn=Oo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}xn=null}}else xn=En?Oo(e.stateNode.nextSibling):null;return!0}function Vx(){for(var e=xn;e;)e=Oo(e.nextSibling)}function Ua(){xn=En=null,Xe=!1}function xv(e){Qn===null?Qn=[e]:Qn.push(e)}var Mk=to.ReactCurrentBatchConfig;function gs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,e));var o=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,e))}return e}function ol(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function iy(e){var t=e._init;return t(e._payload)}function jx(e){function t(m,y){if(e){var x=m.deletions;x===null?(m.deletions=[y],m.flags|=16):x.push(y)}}function n(m,y){if(!e)return null;for(;y!==null;)t(m,y),y=y.sibling;return null}function r(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function o(m,y){return m=zo(m,y),m.index=0,m.sibling=null,m}function i(m,y,x){return m.index=x,e?(x=m.alternate,x!==null?(x=x.index,x<y?(m.flags|=2,y):x):(m.flags|=2,y)):(m.flags|=1048576,y)}function a(m){return e&&m.alternate===null&&(m.flags|=2),m}function s(m,y,x,w){return y===null||y.tag!==6?(y=Sf(x,m.mode,w),y.return=m,y):(y=o(y,x),y.return=m,y)}function u(m,y,x,w){var b=x.type;return b===ra?c(m,y,x.props.children,w,x.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===yo&&iy(b)===y.type)?(w=o(y,x.props),w.ref=gs(m,y,x),w.return=m,w):(w=Vl(x.type,x.key,x.props,null,m.mode,w),w.ref=gs(m,y,x),w.return=m,w)}function l(m,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=_f(x,m.mode,w),y.return=m,y):(y=o(y,x.children||[]),y.return=m,y)}function c(m,y,x,w,b){return y===null||y.tag!==7?(y=Ei(x,m.mode,w,b),y.return=m,y):(y=o(y,x),y.return=m,y)}function d(m,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Sf(""+y,m.mode,x),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ku:return x=Vl(y.type,y.key,y.props,null,m.mode,x),x.ref=gs(m,null,y),x.return=m,x;case na:return y=_f(y,m.mode,x),y.return=m,y;case yo:var w=y._init;return d(m,w(y._payload),x)}if(Rs(y)||fs(y))return y=Ei(y,m.mode,x,null),y.return=m,y;ol(m,y)}return null}function f(m,y,x,w){var b=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:s(m,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ku:return x.key===b?u(m,y,x,w):null;case na:return x.key===b?l(m,y,x,w):null;case yo:return b=x._init,f(m,y,b(x._payload),w)}if(Rs(x)||fs(x))return b!==null?null:c(m,y,x,w,null);ol(m,x)}return null}function h(m,y,x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(x)||null,s(y,m,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ku:return m=m.get(w.key===null?x:w.key)||null,u(y,m,w,b);case na:return m=m.get(w.key===null?x:w.key)||null,l(y,m,w,b);case yo:var C=w._init;return h(m,y,x,C(w._payload),b)}if(Rs(w)||fs(w))return m=m.get(x)||null,c(y,m,w,b,null);ol(y,w)}return null}function v(m,y,x,w){for(var b=null,C=null,S=y,_=y=0,k=null;S!==null&&_<x.length;_++){S.index>_?(k=S,S=null):k=S.sibling;var R=f(m,S,x[_],w);if(R===null){S===null&&(S=k);break}e&&S&&R.alternate===null&&t(m,S),y=i(R,y,_),C===null?b=R:C.sibling=R,C=R,S=k}if(_===x.length)return n(m,S),Xe&&ui(m,_),b;if(S===null){for(;_<x.length;_++)S=d(m,x[_],w),S!==null&&(y=i(S,y,_),C===null?b=S:C.sibling=S,C=S);return Xe&&ui(m,_),b}for(S=r(m,S);_<x.length;_++)k=h(S,m,_,x[_],w),k!==null&&(e&&k.alternate!==null&&S.delete(k.key===null?_:k.key),y=i(k,y,_),C===null?b=k:C.sibling=k,C=k);return e&&S.forEach(function(N){return t(m,N)}),Xe&&ui(m,_),b}function p(m,y,x,w){var b=fs(x);if(typeof b!="function")throw Error(Q(150));if(x=b.call(x),x==null)throw Error(Q(151));for(var C=b=null,S=y,_=y=0,k=null,R=x.next();S!==null&&!R.done;_++,R=x.next()){S.index>_?(k=S,S=null):k=S.sibling;var N=f(m,S,R.value,w);if(N===null){S===null&&(S=k);break}e&&S&&N.alternate===null&&t(m,S),y=i(N,y,_),C===null?b=N:C.sibling=N,C=N,S=k}if(R.done)return n(m,S),Xe&&ui(m,_),b;if(S===null){for(;!R.done;_++,R=x.next())R=d(m,R.value,w),R!==null&&(y=i(R,y,_),C===null?b=R:C.sibling=R,C=R);return Xe&&ui(m,_),b}for(S=r(m,S);!R.done;_++,R=x.next())R=h(S,m,_,R.value,w),R!==null&&(e&&R.alternate!==null&&S.delete(R.key===null?_:R.key),y=i(R,y,_),C===null?b=R:C.sibling=R,C=R);return e&&S.forEach(function(P){return t(m,P)}),Xe&&ui(m,_),b}function g(m,y,x,w){if(typeof x=="object"&&x!==null&&x.type===ra&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ku:e:{for(var b=x.key,C=y;C!==null;){if(C.key===b){if(b=x.type,b===ra){if(C.tag===7){n(m,C.sibling),y=o(C,x.props.children),y.return=m,m=y;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===yo&&iy(b)===C.type){n(m,C.sibling),y=o(C,x.props),y.ref=gs(m,C,x),y.return=m,m=y;break e}n(m,C);break}else t(m,C);C=C.sibling}x.type===ra?(y=Ei(x.props.children,m.mode,w,x.key),y.return=m,m=y):(w=Vl(x.type,x.key,x.props,null,m.mode,w),w.ref=gs(m,y,x),w.return=m,m=w)}return a(m);case na:e:{for(C=x.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(m,y.sibling),y=o(y,x.children||[]),y.return=m,m=y;break e}else{n(m,y);break}else t(m,y);y=y.sibling}y=_f(x,m.mode,w),y.return=m,m=y}return a(m);case yo:return C=x._init,g(m,y,C(x._payload),w)}if(Rs(x))return v(m,y,x,w);if(fs(x))return p(m,y,x,w);ol(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(m,y.sibling),y=o(y,x),y.return=m,m=y):(n(m,y),y=Sf(x,m.mode,w),y.return=m,m=y),a(m)):n(m,y)}return g}var Va=jx(!0),Hx=jx(!1),sc=Jo(null),uc=null,da=null,wv=null;function bv(){wv=da=uc=null}function Cv(e){var t=sc.current;qe(sc),e._currentValue=t}function zh(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ya(e,t){uc=e,wv=da=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tn=!0),e.firstContext=null)}function zn(e){var t=e._currentValue;if(wv!==e)if(e={context:e,memoizedValue:t,next:null},da===null){if(uc===null)throw Error(Q(308));da=e,uc.dependencies={lanes:0,firstContext:e}}else da=da.next=e;return t}var pi=null;function Ev(e){pi===null?pi=[e]:pi.push(e)}function Gx(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,Ev(t)):(n.next=o.next,o.next=n),t.interleaved=n,Yr(e,r)}function Yr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var xo=!1;function Sv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Kr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Lo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,De&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Yr(e,n)}return o=r.interleaved,o===null?(t.next=t,Ev(r)):(t.next=o.next,o.next=t),r.interleaved=t,Yr(e,n)}function Ll(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lv(e,n)}}function ay(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=t:i=i.next=t}else o=i=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function lc(e,t,n,r){var o=e.updateQueue;xo=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var d=o.baseState;a=0,c=l=u=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=e,p=s;switch(f=t,h=n,p.tag){case 1:if(v=p.payload,typeof v=="function"){d=v.call(h,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=p.payload,f=typeof v=="function"?v.call(h,d,f):v,f==null)break e;d=et({},d,f);break e;case 2:xo=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(c===null&&(u=d),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else i===null&&(o.shared.lanes=0);Ti|=a,e.lanes=a,e.memoizedState=d}}function sy(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Q(191,o));o.call(r)}}}var Ru={},kr=Jo(Ru),eu=Jo(Ru),tu=Jo(Ru);function vi(e){if(e===Ru)throw Error(Q(174));return e}function _v(e,t){switch(Ue(tu,t),Ue(eu,e),Ue(kr,Ru),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:wh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=wh(t,e)}qe(kr),Ue(kr,t)}function ja(){qe(kr),qe(eu),qe(tu)}function qx(e){vi(tu.current);var t=vi(kr.current),n=wh(t,e.type);t!==n&&(Ue(eu,e),Ue(kr,n))}function kv(e){eu.current===e&&(qe(kr),qe(eu))}var Ye=Jo(0);function cc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var yf=[];function Rv(){for(var e=0;e<yf.length;e++)yf[e]._workInProgressVersionPrimary=null;yf.length=0}var Bl=to.ReactCurrentDispatcher,xf=to.ReactCurrentBatchConfig,Ii=0,Ze=null,ft=null,Ct=null,dc=!1,Os=!1,nu=0,Fk=0;function Dt(){throw Error(Q(321))}function Iv(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rr(e[n],t[n]))return!1;return!0}function Tv(e,t,n,r,o,i){if(Ii=i,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bl.current=e===null||e.memoizedState===null?Wk:zk,e=n(r,o),Os){i=0;do{if(Os=!1,nu=0,25<=i)throw Error(Q(301));i+=1,Ct=ft=null,t.updateQueue=null,Bl.current=$k,e=n(r,o)}while(Os)}if(Bl.current=fc,t=ft!==null&&ft.next!==null,Ii=0,Ct=ft=Ze=null,dc=!1,t)throw Error(Q(300));return e}function Pv(){var e=nu!==0;return nu=0,e}function pr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?Ze.memoizedState=Ct=e:Ct=Ct.next=e,Ct}function $n(){if(ft===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=ft.next;var t=Ct===null?Ze.memoizedState:Ct.next;if(t!==null)Ct=t,ft=e;else{if(e===null)throw Error(Q(310));ft=e,e={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},Ct===null?Ze.memoizedState=Ct=e:Ct=Ct.next=e}return Ct}function ru(e,t){return typeof t=="function"?t(e):t}function wf(e){var t=$n(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=ft,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((Ii&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,Ze.lanes|=c,Ti|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,rr(r,t.memoizedState)||(tn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do i=o.lane,Ze.lanes|=i,Ti|=i,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function bf(e){var t=$n(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o);rr(i,t.memoizedState)||(tn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Xx(){}function Yx(e,t){var n=Ze,r=$n(),o=t(),i=!rr(r.memoizedState,o);if(i&&(r.memoizedState=o,tn=!0),r=r.queue,Av(Zx.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Ct!==null&&Ct.memoizedState.tag&1){if(n.flags|=2048,ou(9,Jx.bind(null,n,r,o,t),void 0,null),Et===null)throw Error(Q(349));Ii&30||Qx(n,t,o)}return o}function Qx(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Jx(e,t,n,r){t.value=n,t.getSnapshot=r,ew(t)&&tw(e)}function Zx(e,t,n){return n(function(){ew(t)&&tw(e)})}function ew(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rr(e,n)}catch{return!0}}function tw(e){var t=Yr(e,1);t!==null&&tr(t,e,1,-1)}function uy(e){var t=pr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ru,lastRenderedState:e},t.queue=e,e=e.dispatch=Bk.bind(null,Ze,e),[t.memoizedState,e]}function ou(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function nw(){return $n().memoizedState}function Wl(e,t,n,r){var o=pr();Ze.flags|=e,o.memoizedState=ou(1|t,n,void 0,r===void 0?null:r)}function id(e,t,n,r){var o=$n();r=r===void 0?null:r;var i=void 0;if(ft!==null){var a=ft.memoizedState;if(i=a.destroy,r!==null&&Iv(r,a.deps)){o.memoizedState=ou(t,n,i,r);return}}Ze.flags|=e,o.memoizedState=ou(1|t,n,i,r)}function ly(e,t){return Wl(8390656,8,e,t)}function Av(e,t){return id(2048,8,e,t)}function rw(e,t){return id(4,2,e,t)}function ow(e,t){return id(4,4,e,t)}function iw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function aw(e,t,n){return n=n!=null?n.concat([e]):null,id(4,4,iw.bind(null,t,e),n)}function Nv(){}function sw(e,t){var n=$n();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Iv(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function uw(e,t){var n=$n();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Iv(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function lw(e,t,n){return Ii&21?(rr(n,t)||(n=px(),Ze.lanes|=n,Ti|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tn=!0),e.memoizedState=n)}function Ok(e,t){var n=ze;ze=n!==0&&4>n?n:4,e(!0);var r=xf.transition;xf.transition={};try{e(!1),t()}finally{ze=n,xf.transition=r}}function cw(){return $n().memoizedState}function Lk(e,t,n){var r=Wo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},dw(e))fw(t,n);else if(n=Gx(e,t,n,r),n!==null){var o=Kt();tr(n,e,r,o),hw(n,t,r)}}function Bk(e,t,n){var r=Wo(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(dw(e))fw(t,o);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,rr(s,a)){var u=t.interleaved;u===null?(o.next=o,Ev(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Gx(e,t,o,r),n!==null&&(o=Kt(),tr(n,e,r,o),hw(n,t,r))}}function dw(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function fw(e,t){Os=dc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hw(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lv(e,n)}}var fc={readContext:zn,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},Wk={readContext:zn,useCallback:function(e,t){return pr().memoizedState=[e,t===void 0?null:t],e},useContext:zn,useEffect:ly,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Wl(4194308,4,iw.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wl(4,2,e,t)},useMemo:function(e,t){var n=pr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=pr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Lk.bind(null,Ze,e),[r.memoizedState,e]},useRef:function(e){var t=pr();return e={current:e},t.memoizedState=e},useState:uy,useDebugValue:Nv,useDeferredValue:function(e){return pr().memoizedState=e},useTransition:function(){var e=uy(!1),t=e[0];return e=Ok.bind(null,e[1]),pr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ze,o=pr();if(Xe){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=t(),Et===null)throw Error(Q(349));Ii&30||Qx(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,ly(Zx.bind(null,r,i,e),[e]),r.flags|=2048,ou(9,Jx.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=pr(),t=Et.identifierPrefix;if(Xe){var n=Gr,r=Hr;n=(r&~(1<<32-er(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=nu++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Fk++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},zk={readContext:zn,useCallback:sw,useContext:zn,useEffect:Av,useImperativeHandle:aw,useInsertionEffect:rw,useLayoutEffect:ow,useMemo:uw,useReducer:wf,useRef:nw,useState:function(){return wf(ru)},useDebugValue:Nv,useDeferredValue:function(e){var t=$n();return lw(t,ft.memoizedState,e)},useTransition:function(){var e=wf(ru)[0],t=$n().memoizedState;return[e,t]},useMutableSource:Xx,useSyncExternalStore:Yx,useId:cw,unstable_isNewReconciler:!1},$k={readContext:zn,useCallback:sw,useContext:zn,useEffect:Av,useImperativeHandle:aw,useInsertionEffect:rw,useLayoutEffect:ow,useMemo:uw,useReducer:bf,useRef:nw,useState:function(){return bf(ru)},useDebugValue:Nv,useDeferredValue:function(e){var t=$n();return ft===null?t.memoizedState=e:lw(t,ft.memoizedState,e)},useTransition:function(){var e=bf(ru)[0],t=$n().memoizedState;return[e,t]},useMutableSource:Xx,useSyncExternalStore:Yx,useId:cw,unstable_isNewReconciler:!1};function Kn(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function $h(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:et({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ad={isMounted:function(e){return(e=e._reactInternals)?Fi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Kt(),o=Wo(e),i=Kr(r,o);i.payload=t,n!=null&&(i.callback=n),t=Lo(e,i,o),t!==null&&(tr(t,e,o,r),Ll(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Kt(),o=Wo(e),i=Kr(r,o);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Lo(e,i,o),t!==null&&(tr(t,e,o,r),Ll(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kt(),r=Wo(e),o=Kr(n,r);o.tag=2,t!=null&&(o.callback=t),t=Lo(e,o,r),t!==null&&(tr(t,e,r,n),Ll(t,e,r))}};function cy(e,t,n,r,o,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!Ys(n,r)||!Ys(o,i):!0}function pw(e,t,n){var r=!1,o=Ho,i=t.contextType;return typeof i=="object"&&i!==null?i=zn(i):(o=rn(t)?ki:Ut.current,r=t.contextTypes,i=(r=r!=null)?$a(e,o):Ho),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ad,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function dy(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ad.enqueueReplaceState(t,t.state,null)}function Uh(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Sv(e);var i=t.contextType;typeof i=="object"&&i!==null?o.context=zn(i):(i=rn(t)?ki:Ut.current,o.context=$a(e,i)),o.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&($h(e,t,i,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&ad.enqueueReplaceState(o,o.state,null),lc(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ha(e,t){try{var n="",r=t;do n+=v_(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:o,digest:null}}function Cf(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Vh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Uk=typeof WeakMap=="function"?WeakMap:Map;function vw(e,t,n){n=Kr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){pc||(pc=!0,Zh=r),Vh(e,t)},n}function mw(e,t,n){n=Kr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Vh(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Vh(e,t),typeof r!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function fy(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Uk;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=nR.bind(null,e,t,n),t.then(e,e))}function hy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function py(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Kr(-1,1),t.tag=2,Lo(n,t,1))),n.lanes|=1),e)}var Vk=to.ReactCurrentOwner,tn=!1;function Ht(e,t,n,r){t.child=e===null?Hx(t,null,n,r):Va(t,e.child,n,r)}function vy(e,t,n,r,o){n=n.render;var i=t.ref;return ya(t,o),r=Tv(e,t,n,r,i,o),n=Pv(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Qr(e,t,o)):(Xe&&n&&gv(t),t.flags|=1,Ht(e,t,r,o),t.child)}function my(e,t,n,r,o){if(e===null){var i=n.type;return typeof i=="function"&&!zv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,gw(e,t,i,r,o)):(e=Vl(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ys,n(a,r)&&e.ref===t.ref)return Qr(e,t,o)}return t.flags|=1,e=zo(i,r),e.ref=t.ref,e.return=t,t.child=e}function gw(e,t,n,r,o){if(e!==null){var i=e.memoizedProps;if(Ys(i,r)&&e.ref===t.ref)if(tn=!1,t.pendingProps=r=i,(e.lanes&o)!==0)e.flags&131072&&(tn=!0);else return t.lanes=e.lanes,Qr(e,t,o)}return jh(e,t,n,r,o)}function yw(e,t,n){var r=t.pendingProps,o=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(ha,vn),vn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ue(ha,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ue(ha,vn),vn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ue(ha,vn),vn|=r;return Ht(e,t,o,n),t.child}function xw(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function jh(e,t,n,r,o){var i=rn(n)?ki:Ut.current;return i=$a(t,i),ya(t,o),n=Tv(e,t,n,r,i,o),r=Pv(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Qr(e,t,o)):(Xe&&r&&gv(t),t.flags|=1,Ht(e,t,n,o),t.child)}function gy(e,t,n,r,o){if(rn(n)){var i=!0;oc(t)}else i=!1;if(ya(t,o),t.stateNode===null)zl(e,t),pw(t,n,r),Uh(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=zn(l):(l=rn(n)?ki:Ut.current,l=$a(t,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&dy(t,a,r,l),xo=!1;var f=t.memoizedState;a.state=f,lc(t,r,a,o),u=t.memoizedState,s!==r||f!==u||nn.current||xo?(typeof c=="function"&&($h(t,n,c,r),u=t.memoizedState),(s=xo||cy(t,n,s,r,f,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Kx(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Kn(t.type,s),a.props=l,d=t.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=zn(u):(u=rn(n)?ki:Ut.current,u=$a(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&dy(t,a,r,u),xo=!1,f=t.memoizedState,a.state=f,lc(t,r,a,o);var v=t.memoizedState;s!==d||f!==v||nn.current||xo?(typeof h=="function"&&($h(t,n,h,r),v=t.memoizedState),(l=xo||cy(t,n,l,r,f,v,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),a.props=r,a.state=v,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Hh(e,t,n,r,i,o)}function Hh(e,t,n,r,o,i){xw(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&ny(t,n,!1),Qr(e,t,i);r=t.stateNode,Vk.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Va(t,e.child,null,i),t.child=Va(t,null,s,i)):Ht(e,t,s,i),t.memoizedState=r.state,o&&ny(t,n,!0),t.child}function ww(e){var t=e.stateNode;t.pendingContext?ty(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ty(e,t.context,!1),_v(e,t.containerInfo)}function yy(e,t,n,r,o){return Ua(),xv(o),t.flags|=256,Ht(e,t,n,r),t.child}var Gh={dehydrated:null,treeContext:null,retryLane:0};function Kh(e){return{baseLanes:e,cachePool:null,transitions:null}}function bw(e,t,n){var r=t.pendingProps,o=Ye.current,i=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ue(Ye,o&1),e===null)return Wh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=ld(a,r,0,null),e=Ei(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Kh(n),t.memoizedState=Gh,e):Dv(t,a));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return jk(e,t,a,r,s,o,n);if(i){i=r.fallback,a=t.mode,o=e.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=zo(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=zo(s,i):(i=Ei(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Kh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Gh,r}return i=e.child,e=i.sibling,r=zo(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Dv(e,t){return t=ld({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function il(e,t,n,r){return r!==null&&xv(r),Va(t,e.child,null,n),e=Dv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function jk(e,t,n,r,o,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Cf(Error(Q(422))),il(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=ld({mode:"visible",children:r.children},o,0,null),i=Ei(i,o,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Va(t,e.child,null,a),t.child.memoizedState=Kh(a),t.memoizedState=Gh,i);if(!(t.mode&1))return il(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(Q(419)),r=Cf(i,r,void 0),il(e,t,a,r)}if(s=(a&e.childLanes)!==0,tn||s){if(r=Et,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Yr(e,o),tr(r,e,o,-1))}return Wv(),r=Cf(Error(Q(421))),il(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=rR.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,xn=Oo(o.nextSibling),En=t,Xe=!0,Qn=null,e!==null&&(Nn[Dn++]=Hr,Nn[Dn++]=Gr,Nn[Dn++]=Ri,Hr=e.id,Gr=e.overflow,Ri=t),t=Dv(t,r.children),t.flags|=4096,t)}function xy(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),zh(e.return,t,n)}function Ef(e,t,n,r,o){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function Cw(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Ht(e,t,r.children,n),r=Ye.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&xy(e,n,t);else if(e.tag===19)xy(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ue(Ye,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&cc(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ef(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&cc(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ef(t,!0,n,null,i);break;case"together":Ef(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ti|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,n=zo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=zo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Hk(e,t,n){switch(t.tag){case 3:ww(t),Ua();break;case 5:qx(t);break;case 1:rn(t.type)&&oc(t);break;case 4:_v(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ue(sc,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ue(Ye,Ye.current&1),t.flags|=128,null):n&t.child.childLanes?bw(e,t,n):(Ue(Ye,Ye.current&1),e=Qr(e,t,n),e!==null?e.sibling:null);Ue(Ye,Ye.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Cw(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ue(Ye,Ye.current),r)break;return null;case 22:case 23:return t.lanes=0,yw(e,t,n)}return Qr(e,t,n)}var Ew,qh,Sw,_w;Ew=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qh=function(){};Sw=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,vi(kr.current);var i=null;switch(n){case"input":o=mh(e,o),r=mh(e,r),i=[];break;case"select":o=et({},o,{value:void 0}),r=et({},r,{value:void 0}),i=[];break;case"textarea":o=xh(e,o),r=xh(e,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=nc)}bh(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Vs.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Vs.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Ge("scroll",e),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};_w=function(e,t,n,r){n!==r&&(t.flags|=4)};function ys(e,t){if(!Xe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gk(e,t,n){var r=t.pendingProps;switch(yv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(t),null;case 1:return rn(t.type)&&rc(),Mt(t),null;case 3:return r=t.stateNode,ja(),qe(nn),qe(Ut),Rv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(rl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Qn!==null&&(np(Qn),Qn=null))),qh(e,t),Mt(t),null;case 5:kv(t);var o=vi(tu.current);if(n=t.type,e!==null&&t.stateNode!=null)Sw(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Q(166));return Mt(t),null}if(e=vi(kr.current),rl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[wr]=t,r[Zs]=i,e=(t.mode&1)!==0,n){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(o=0;o<Ts.length;o++)Ge(Ts[o],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":Ig(r,i),Ge("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ge("invalid",r);break;case"textarea":Pg(r,i),Ge("invalid",r)}bh(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&nl(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&nl(r.textContent,s,e),o=["children",""+s]):Vs.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Ge("scroll",r)}switch(n){case"input":qu(r),Tg(r,i,!0);break;case"textarea":qu(r),Ag(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=nc)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Z1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[wr]=t,e[Zs]=r,Ew(e,t,!1,!1),t.stateNode=e;e:{switch(a=Ch(n,r),n){case"dialog":Ge("cancel",e),Ge("close",e),o=r;break;case"iframe":case"object":case"embed":Ge("load",e),o=r;break;case"video":case"audio":for(o=0;o<Ts.length;o++)Ge(Ts[o],e);o=r;break;case"source":Ge("error",e),o=r;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),o=r;break;case"details":Ge("toggle",e),o=r;break;case"input":Ig(e,r),o=mh(e,r),Ge("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=et({},r,{value:void 0}),Ge("invalid",e);break;case"textarea":Pg(e,r),o=xh(e,r),Ge("invalid",e);break;default:o=r}bh(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?nx(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&ex(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&js(e,u):typeof u=="number"&&js(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Vs.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ge("scroll",e):u!=null&&rv(e,i,u,a))}switch(n){case"input":qu(e),Tg(e,r,!1);break;case"textarea":qu(e),Ag(e);break;case"option":r.value!=null&&e.setAttribute("value",""+jo(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?pa(e,!!r.multiple,i,!1):r.defaultValue!=null&&pa(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=nc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mt(t),null;case 6:if(e&&t.stateNode!=null)_w(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Q(166));if(n=vi(tu.current),vi(kr.current),rl(t)){if(r=t.stateNode,n=t.memoizedProps,r[wr]=t,(i=r.nodeValue!==n)&&(e=En,e!==null))switch(e.tag){case 3:nl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&nl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[wr]=t,t.stateNode=r}return Mt(t),null;case 13:if(qe(Ye),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xe&&xn!==null&&t.mode&1&&!(t.flags&128))Vx(),Ua(),t.flags|=98560,i=!1;else if(i=rl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Q(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Q(317));i[wr]=t}else Ua(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mt(t),i=!1}else Qn!==null&&(np(Qn),Qn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ye.current&1?ht===0&&(ht=3):Wv())),t.updateQueue!==null&&(t.flags|=4),Mt(t),null);case 4:return ja(),qh(e,t),e===null&&Qs(t.stateNode.containerInfo),Mt(t),null;case 10:return Cv(t.type._context),Mt(t),null;case 17:return rn(t.type)&&rc(),Mt(t),null;case 19:if(qe(Ye),i=t.memoizedState,i===null)return Mt(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)ys(i,!1);else{if(ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=cc(e),a!==null){for(t.flags|=128,ys(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ue(Ye,Ye.current&1|2),t.child}e=e.sibling}i.tail!==null&&it()>Ga&&(t.flags|=128,r=!0,ys(i,!1),t.lanes=4194304)}else{if(!r)if(e=cc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ys(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Xe)return Mt(t),null}else 2*it()-i.renderingStartTime>Ga&&n!==1073741824&&(t.flags|=128,r=!0,ys(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=it(),t.sibling=null,n=Ye.current,Ue(Ye,r?n&1|2:n&1),t):(Mt(t),null);case 22:case 23:return Bv(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?vn&1073741824&&(Mt(t),t.subtreeFlags&6&&(t.flags|=8192)):Mt(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function Kk(e,t){switch(yv(t),t.tag){case 1:return rn(t.type)&&rc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ja(),qe(nn),qe(Ut),Rv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return kv(t),null;case 13:if(qe(Ye),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));Ua()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qe(Ye),null;case 4:return ja(),null;case 10:return Cv(t.type._context),null;case 22:case 23:return Bv(),null;case 24:return null;default:return null}}var al=!1,Lt=!1,qk=typeof WeakSet=="function"?WeakSet:Set,ae=null;function fa(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ot(e,t,r)}else n.current=null}function Xh(e,t,n){try{n()}catch(r){ot(e,t,r)}}var wy=!1;function Xk(e,t){if(Nh=Zl,e=Px(),mv(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,d=e,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++l===o&&(s=a),f===i&&++c===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dh={focusedElem:e,selectionRange:n},Zl=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var p=v.memoizedProps,g=v.memoizedState,m=t.stateNode,y=m.getSnapshotBeforeUpdate(t.elementType===t.type?p:Kn(t.type,p),g);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(w){ot(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return v=wy,wy=!1,v}function Ls(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,i!==void 0&&Xh(t,n,i)}o=o.next}while(o!==r)}}function sd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Yh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function kw(e){var t=e.alternate;t!==null&&(e.alternate=null,kw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[wr],delete t[Zs],delete t[Oh],delete t[Ak],delete t[Nk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rw(e){return e.tag===5||e.tag===3||e.tag===4}function by(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rw(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Qh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nc));else if(r!==4&&(e=e.child,e!==null))for(Qh(e,t,n),e=e.sibling;e!==null;)Qh(e,t,n),e=e.sibling}function Jh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Jh(e,t,n),e=e.sibling;e!==null;)Jh(e,t,n),e=e.sibling}var kt=null,Yn=!1;function co(e,t,n){for(n=n.child;n!==null;)Iw(e,t,n),n=n.sibling}function Iw(e,t,n){if(_r&&typeof _r.onCommitFiberUnmount=="function")try{_r.onCommitFiberUnmount(Zc,n)}catch{}switch(n.tag){case 5:Lt||fa(n,t);case 6:var r=kt,o=Yn;kt=null,co(e,t,n),kt=r,Yn=o,kt!==null&&(Yn?(e=kt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):kt.removeChild(n.stateNode));break;case 18:kt!==null&&(Yn?(e=kt,n=n.stateNode,e.nodeType===8?mf(e.parentNode,n):e.nodeType===1&&mf(e,n),qs(e)):mf(kt,n.stateNode));break;case 4:r=kt,o=Yn,kt=n.stateNode.containerInfo,Yn=!0,co(e,t,n),kt=r,Yn=o;break;case 0:case 11:case 14:case 15:if(!Lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Xh(n,t,a),o=o.next}while(o!==r)}co(e,t,n);break;case 1:if(!Lt&&(fa(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ot(n,t,s)}co(e,t,n);break;case 21:co(e,t,n);break;case 22:n.mode&1?(Lt=(r=Lt)||n.memoizedState!==null,co(e,t,n),Lt=r):co(e,t,n);break;default:co(e,t,n)}}function Cy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new qk),t.forEach(function(r){var o=oR.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Hn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:kt=s.stateNode,Yn=!1;break e;case 3:kt=s.stateNode.containerInfo,Yn=!0;break e;case 4:kt=s.stateNode.containerInfo,Yn=!0;break e}s=s.return}if(kt===null)throw Error(Q(160));Iw(i,a,o),kt=null,Yn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){ot(o,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Tw(t,e),t=t.sibling}function Tw(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Hn(t,e),fr(e),r&4){try{Ls(3,e,e.return),sd(3,e)}catch(p){ot(e,e.return,p)}try{Ls(5,e,e.return)}catch(p){ot(e,e.return,p)}}break;case 1:Hn(t,e),fr(e),r&512&&n!==null&&fa(n,n.return);break;case 5:if(Hn(t,e),fr(e),r&512&&n!==null&&fa(n,n.return),e.flags&32){var o=e.stateNode;try{js(o,"")}catch(p){ot(e,e.return,p)}}if(r&4&&(o=e.stateNode,o!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&Q1(o,i),Ch(s,a);var l=Ch(s,i);for(a=0;a<u.length;a+=2){var c=u[a],d=u[a+1];c==="style"?nx(o,d):c==="dangerouslySetInnerHTML"?ex(o,d):c==="children"?js(o,d):rv(o,c,d,l)}switch(s){case"input":gh(o,i);break;case"textarea":J1(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?pa(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?pa(o,!!i.multiple,i.defaultValue,!0):pa(o,!!i.multiple,i.multiple?[]:"",!1))}o[Zs]=i}catch(p){ot(e,e.return,p)}}break;case 6:if(Hn(t,e),fr(e),r&4){if(e.stateNode===null)throw Error(Q(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(p){ot(e,e.return,p)}}break;case 3:if(Hn(t,e),fr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qs(t.containerInfo)}catch(p){ot(e,e.return,p)}break;case 4:Hn(t,e),fr(e);break;case 13:Hn(t,e),fr(e),o=e.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(Ov=it())),r&4&&Cy(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Lt=(l=Lt)||c,Hn(t,e),Lt=l):Hn(t,e),fr(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ae=e,c=e.child;c!==null;){for(d=ae=c;ae!==null;){switch(f=ae,h=f.child,f.tag){case 0:case 11:case 14:case 15:Ls(4,f,f.return);break;case 1:fa(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(p){ot(r,n,p)}}break;case 5:fa(f,f.return);break;case 22:if(f.memoizedState!==null){Sy(d);continue}}h!==null?(h.return=f,ae=h):Sy(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{o=d.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=tx("display",a))}catch(p){ot(e,e.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(p){ot(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Hn(t,e),fr(e),r&4&&Cy(e);break;case 21:break;default:Hn(t,e),fr(e)}}function fr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Rw(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(js(o,""),r.flags&=-33);var i=by(e);Jh(e,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=by(e);Qh(e,s,a);break;default:throw Error(Q(161))}}catch(u){ot(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Yk(e,t,n){ae=e,Pw(e)}function Pw(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var o=ae,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||al;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||Lt;s=al;var l=Lt;if(al=a,(Lt=u)&&!l)for(ae=o;ae!==null;)a=ae,u=a.child,a.tag===22&&a.memoizedState!==null?_y(o):u!==null?(u.return=a,ae=u):_y(o);for(;i!==null;)ae=i,Pw(i),i=i.sibling;ae=o,al=s,Lt=l}Ey(e)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ae=i):Ey(e)}}function Ey(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lt||sd(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Lt)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Kn(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&sy(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}sy(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&qs(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}Lt||t.flags&512&&Yh(t)}catch(f){ot(t,t.return,f)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Sy(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function _y(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sd(4,t)}catch(u){ot(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){ot(t,o,u)}}var i=t.return;try{Yh(t)}catch(u){ot(t,i,u)}break;case 5:var a=t.return;try{Yh(t)}catch(u){ot(t,a,u)}}}catch(u){ot(t,t.return,u)}if(t===e){ae=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ae=s;break}ae=t.return}}var Qk=Math.ceil,hc=to.ReactCurrentDispatcher,Mv=to.ReactCurrentOwner,Wn=to.ReactCurrentBatchConfig,De=0,Et=null,ut=null,Pt=0,vn=0,ha=Jo(0),ht=0,iu=null,Ti=0,ud=0,Fv=0,Bs=null,Jt=null,Ov=0,Ga=1/0,Ur=null,pc=!1,Zh=null,Bo=null,sl=!1,Io=null,vc=0,Ws=0,ep=null,$l=-1,Ul=0;function Kt(){return De&6?it():$l!==-1?$l:$l=it()}function Wo(e){return e.mode&1?De&2&&Pt!==0?Pt&-Pt:Mk.transition!==null?(Ul===0&&(Ul=px()),Ul):(e=ze,e!==0||(e=window.event,e=e===void 0?16:bx(e.type)),e):1}function tr(e,t,n,r){if(50<Ws)throw Ws=0,ep=null,Error(Q(185));Su(e,n,r),(!(De&2)||e!==Et)&&(e===Et&&(!(De&2)&&(ud|=n),ht===4&&bo(e,Pt)),on(e,r),n===1&&De===0&&!(t.mode&1)&&(Ga=it()+500,od&&Zo()))}function on(e,t){var n=e.callbackNode;M_(e,t);var r=Jl(e,e===Et?Pt:0);if(r===0)n!==null&&Mg(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Mg(n),t===1)e.tag===0?Dk(ky.bind(null,e)):zx(ky.bind(null,e)),Tk(function(){!(De&6)&&Zo()}),n=null;else{switch(vx(r)){case 1:n=uv;break;case 4:n=fx;break;case 16:n=Ql;break;case 536870912:n=hx;break;default:n=Ql}n=Bw(n,Aw.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Aw(e,t){if($l=-1,Ul=0,De&6)throw Error(Q(327));var n=e.callbackNode;if(xa()&&e.callbackNode!==n)return null;var r=Jl(e,e===Et?Pt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=mc(e,r);else{t=r;var o=De;De|=2;var i=Dw();(Et!==e||Pt!==t)&&(Ur=null,Ga=it()+500,Ci(e,t));do try{eR();break}catch(s){Nw(e,s)}while(!0);bv(),hc.current=i,De=o,ut!==null?t=0:(Et=null,Pt=0,t=ht)}if(t!==0){if(t===2&&(o=Rh(e),o!==0&&(r=o,t=tp(e,o))),t===1)throw n=iu,Ci(e,0),bo(e,r),on(e,it()),n;if(t===6)bo(e,r);else{if(o=e.current.alternate,!(r&30)&&!Jk(o)&&(t=mc(e,r),t===2&&(i=Rh(e),i!==0&&(r=i,t=tp(e,i))),t===1))throw n=iu,Ci(e,0),bo(e,r),on(e,it()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(Q(345));case 2:li(e,Jt,Ur);break;case 3:if(bo(e,r),(r&130023424)===r&&(t=Ov+500-it(),10<t)){if(Jl(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){Kt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Fh(li.bind(null,e,Jt,Ur),t);break}li(e,Jt,Ur);break;case 4:if(bo(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-er(r);i=1<<a,a=t[a],a>o&&(o=a),r&=~i}if(r=o,r=it()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Qk(r/1960))-r,10<r){e.timeoutHandle=Fh(li.bind(null,e,Jt,Ur),r);break}li(e,Jt,Ur);break;case 5:li(e,Jt,Ur);break;default:throw Error(Q(329))}}}return on(e,it()),e.callbackNode===n?Aw.bind(null,e):null}function tp(e,t){var n=Bs;return e.current.memoizedState.isDehydrated&&(Ci(e,t).flags|=256),e=mc(e,t),e!==2&&(t=Jt,Jt=n,t!==null&&np(t)),e}function np(e){Jt===null?Jt=e:Jt.push.apply(Jt,e)}function Jk(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!rr(i(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bo(e,t){for(t&=~Fv,t&=~ud,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-er(t),r=1<<n;e[n]=-1,t&=~r}}function ky(e){if(De&6)throw Error(Q(327));xa();var t=Jl(e,0);if(!(t&1))return on(e,it()),null;var n=mc(e,t);if(e.tag!==0&&n===2){var r=Rh(e);r!==0&&(t=r,n=tp(e,r))}if(n===1)throw n=iu,Ci(e,0),bo(e,t),on(e,it()),n;if(n===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,li(e,Jt,Ur),on(e,it()),null}function Lv(e,t){var n=De;De|=1;try{return e(t)}finally{De=n,De===0&&(Ga=it()+500,od&&Zo())}}function Pi(e){Io!==null&&Io.tag===0&&!(De&6)&&xa();var t=De;De|=1;var n=Wn.transition,r=ze;try{if(Wn.transition=null,ze=1,e)return e()}finally{ze=r,Wn.transition=n,De=t,!(De&6)&&Zo()}}function Bv(){vn=ha.current,qe(ha)}function Ci(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ik(n)),ut!==null)for(n=ut.return;n!==null;){var r=n;switch(yv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&rc();break;case 3:ja(),qe(nn),qe(Ut),Rv();break;case 5:kv(r);break;case 4:ja();break;case 13:qe(Ye);break;case 19:qe(Ye);break;case 10:Cv(r.type._context);break;case 22:case 23:Bv()}n=n.return}if(Et=e,ut=e=zo(e.current,null),Pt=vn=t,ht=0,iu=null,Fv=ud=Ti=0,Jt=Bs=null,pi!==null){for(t=0;t<pi.length;t++)if(n=pi[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}pi=null}return e}function Nw(e,t){do{var n=ut;try{if(bv(),Bl.current=fc,dc){for(var r=Ze.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}dc=!1}if(Ii=0,Ct=ft=Ze=null,Os=!1,nu=0,Mv.current=null,n===null||n.return===null){ht=1,iu=t,ut=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=Pt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=hy(a);if(h!==null){h.flags&=-257,py(h,a,s,i,t),h.mode&1&&fy(i,l,t),t=h,u=l;var v=t.updateQueue;if(v===null){var p=new Set;p.add(u),t.updateQueue=p}else v.add(u);break e}else{if(!(t&1)){fy(i,l,t),Wv();break e}u=Error(Q(426))}}else if(Xe&&s.mode&1){var g=hy(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),py(g,a,s,i,t),xv(Ha(u,s));break e}}i=u=Ha(u,s),ht!==4&&(ht=2),Bs===null?Bs=[i]:Bs.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=vw(i,u,t);ay(i,m);break e;case 1:s=u;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Bo===null||!Bo.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=mw(i,s,t);ay(i,w);break e}}i=i.return}while(i!==null)}Fw(n)}catch(b){t=b,ut===n&&n!==null&&(ut=n=n.return);continue}break}while(!0)}function Dw(){var e=hc.current;return hc.current=fc,e===null?fc:e}function Wv(){(ht===0||ht===3||ht===2)&&(ht=4),Et===null||!(Ti&268435455)&&!(ud&268435455)||bo(Et,Pt)}function mc(e,t){var n=De;De|=2;var r=Dw();(Et!==e||Pt!==t)&&(Ur=null,Ci(e,t));do try{Zk();break}catch(o){Nw(e,o)}while(!0);if(bv(),De=n,hc.current=r,ut!==null)throw Error(Q(261));return Et=null,Pt=0,ht}function Zk(){for(;ut!==null;)Mw(ut)}function eR(){for(;ut!==null&&!__();)Mw(ut)}function Mw(e){var t=Lw(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?Fw(e):ut=t,Mv.current=null}function Fw(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Kk(n,t),n!==null){n.flags&=32767,ut=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,ut=null;return}}else if(n=Gk(n,t,vn),n!==null){ut=n;return}if(t=t.sibling,t!==null){ut=t;return}ut=t=e}while(t!==null);ht===0&&(ht=5)}function li(e,t,n){var r=ze,o=Wn.transition;try{Wn.transition=null,ze=1,tR(e,t,n,r)}finally{Wn.transition=o,ze=r}return null}function tR(e,t,n,r){do xa();while(Io!==null);if(De&6)throw Error(Q(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(F_(e,i),e===Et&&(ut=Et=null,Pt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||sl||(sl=!0,Bw(Ql,function(){return xa(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Wn.transition,Wn.transition=null;var a=ze;ze=1;var s=De;De|=4,Mv.current=null,Xk(e,n),Tw(n,e),bk(Dh),Zl=!!Nh,Dh=Nh=null,e.current=n,Yk(n),k_(),De=s,ze=a,Wn.transition=i}else e.current=n;if(sl&&(sl=!1,Io=e,vc=o),i=e.pendingLanes,i===0&&(Bo=null),T_(n.stateNode),on(e,it()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(pc)throw pc=!1,e=Zh,Zh=null,e;return vc&1&&e.tag!==0&&xa(),i=e.pendingLanes,i&1?e===ep?Ws++:(Ws=0,ep=e):Ws=0,Zo(),null}function xa(){if(Io!==null){var e=vx(vc),t=Wn.transition,n=ze;try{if(Wn.transition=null,ze=16>e?16:e,Io===null)var r=!1;else{if(e=Io,Io=null,vc=0,De&6)throw Error(Q(331));var o=De;for(De|=4,ae=e.current;ae!==null;){var i=ae,a=i.child;if(ae.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(ae=l;ae!==null;){var c=ae;switch(c.tag){case 0:case 11:case 15:Ls(8,c,i)}var d=c.child;if(d!==null)d.return=c,ae=d;else for(;ae!==null;){c=ae;var f=c.sibling,h=c.return;if(kw(c),c===l){ae=null;break}if(f!==null){f.return=h,ae=f;break}ae=h}}}var v=i.alternate;if(v!==null){var p=v.child;if(p!==null){v.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}ae=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ae=a;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ls(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ae=m;break e}ae=i.return}}var y=e.current;for(ae=y;ae!==null;){a=ae;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ae=x;else e:for(a=y;ae!==null;){if(s=ae,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:sd(9,s)}}catch(b){ot(s,s.return,b)}if(s===a){ae=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ae=w;break e}ae=s.return}}if(De=o,Zo(),_r&&typeof _r.onPostCommitFiberRoot=="function")try{_r.onPostCommitFiberRoot(Zc,e)}catch{}r=!0}return r}finally{ze=n,Wn.transition=t}}return!1}function Ry(e,t,n){t=Ha(n,t),t=vw(e,t,1),e=Lo(e,t,1),t=Kt(),e!==null&&(Su(e,1,t),on(e,t))}function ot(e,t,n){if(e.tag===3)Ry(e,e,n);else for(;t!==null;){if(t.tag===3){Ry(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bo===null||!Bo.has(r))){e=Ha(n,e),e=mw(t,e,1),t=Lo(t,e,1),e=Kt(),t!==null&&(Su(t,1,e),on(t,e));break}}t=t.return}}function nR(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Kt(),e.pingedLanes|=e.suspendedLanes&n,Et===e&&(Pt&n)===n&&(ht===4||ht===3&&(Pt&130023424)===Pt&&500>it()-Ov?Ci(e,0):Fv|=n),on(e,t)}function Ow(e,t){t===0&&(e.mode&1?(t=Qu,Qu<<=1,!(Qu&130023424)&&(Qu=4194304)):t=1);var n=Kt();e=Yr(e,t),e!==null&&(Su(e,t,n),on(e,n))}function rR(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ow(e,n)}function oR(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(t),Ow(e,n)}var Lw;Lw=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||nn.current)tn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return tn=!1,Hk(e,t,n);tn=!!(e.flags&131072)}else tn=!1,Xe&&t.flags&1048576&&$x(t,ac,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zl(e,t),e=t.pendingProps;var o=$a(t,Ut.current);ya(t,n),o=Tv(null,t,r,e,o,n);var i=Pv();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rn(r)?(i=!0,oc(t)):i=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Sv(t),o.updater=ad,t.stateNode=o,o._reactInternals=t,Uh(t,r,e,n),t=Hh(null,t,r,!0,i,n)):(t.tag=0,Xe&&i&&gv(t),Ht(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zl(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=aR(r),e=Kn(r,e),o){case 0:t=jh(null,t,r,e,n);break e;case 1:t=gy(null,t,r,e,n);break e;case 11:t=vy(null,t,r,e,n);break e;case 14:t=my(null,t,r,Kn(r.type,e),n);break e}throw Error(Q(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kn(r,o),jh(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kn(r,o),gy(e,t,r,o,n);case 3:e:{if(ww(t),e===null)throw Error(Q(387));r=t.pendingProps,i=t.memoizedState,o=i.element,Kx(e,t),lc(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){o=Ha(Error(Q(423)),t),t=yy(e,t,r,n,o);break e}else if(r!==o){o=Ha(Error(Q(424)),t),t=yy(e,t,r,n,o);break e}else for(xn=Oo(t.stateNode.containerInfo.firstChild),En=t,Xe=!0,Qn=null,n=Hx(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ua(),r===o){t=Qr(e,t,n);break e}Ht(e,t,r,n)}t=t.child}return t;case 5:return qx(t),e===null&&Wh(t),r=t.type,o=t.pendingProps,i=e!==null?e.memoizedProps:null,a=o.children,Mh(r,o)?a=null:i!==null&&Mh(r,i)&&(t.flags|=32),xw(e,t),Ht(e,t,a,n),t.child;case 6:return e===null&&Wh(t),null;case 13:return bw(e,t,n);case 4:return _v(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Va(t,null,r,n):Ht(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kn(r,o),vy(e,t,r,o,n);case 7:return Ht(e,t,t.pendingProps,n),t.child;case 8:return Ht(e,t,t.pendingProps.children,n),t.child;case 12:return Ht(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Ue(sc,r._currentValue),r._currentValue=a,i!==null)if(rr(i.value,a)){if(i.children===o.children&&!nn.current){t=Qr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Kr(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),zh(i.return,n,t),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Q(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),zh(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Ht(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,ya(t,n),o=zn(o),r=r(o),t.flags|=1,Ht(e,t,r,n),t.child;case 14:return r=t.type,o=Kn(r,t.pendingProps),o=Kn(r.type,o),my(e,t,r,o,n);case 15:return gw(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kn(r,o),zl(e,t),t.tag=1,rn(r)?(e=!0,oc(t)):e=!1,ya(t,n),pw(t,r,o),Uh(t,r,o,n),Hh(null,t,r,!0,e,n);case 19:return Cw(e,t,n);case 22:return yw(e,t,n)}throw Error(Q(156,t.tag))};function Bw(e,t){return dx(e,t)}function iR(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(e,t,n,r){return new iR(e,t,n,r)}function zv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function aR(e){if(typeof e=="function")return zv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===iv)return 11;if(e===av)return 14}return 2}function zo(e,t){var n=e.alternate;return n===null?(n=On(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Vl(e,t,n,r,o,i){var a=2;if(r=e,typeof e=="function")zv(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case ra:return Ei(n.children,o,i,t);case ov:a=8,o|=8;break;case fh:return e=On(12,n,t,o|2),e.elementType=fh,e.lanes=i,e;case hh:return e=On(13,n,t,o),e.elementType=hh,e.lanes=i,e;case ph:return e=On(19,n,t,o),e.elementType=ph,e.lanes=i,e;case q1:return ld(n,o,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case G1:a=10;break e;case K1:a=9;break e;case iv:a=11;break e;case av:a=14;break e;case yo:a=16,r=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=On(a,n,t,o),t.elementType=e,t.type=r,t.lanes=i,t}function Ei(e,t,n,r){return e=On(7,e,r,t),e.lanes=n,e}function ld(e,t,n,r){return e=On(22,e,r,t),e.elementType=q1,e.lanes=n,e.stateNode={isHidden:!1},e}function Sf(e,t,n){return e=On(6,e,null,t),e.lanes=n,e}function _f(e,t,n){return t=On(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sR(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=of(0),this.expirationTimes=of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=of(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function $v(e,t,n,r,o,i,a,s,u){return e=new sR(e,t,n,s,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=On(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sv(i),e}function uR(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:na,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Ww(e){if(!e)return Ho;e=e._reactInternals;e:{if(Fi(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var n=e.type;if(rn(n))return Wx(e,n,t)}return t}function zw(e,t,n,r,o,i,a,s,u){return e=$v(n,r,!0,e,o,i,a,s,u),e.context=Ww(null),n=e.current,r=Kt(),o=Wo(n),i=Kr(r,o),i.callback=t??null,Lo(n,i,o),e.current.lanes=o,Su(e,o,r),on(e,r),e}function cd(e,t,n,r){var o=t.current,i=Kt(),a=Wo(o);return n=Ww(n),t.context===null?t.context=n:t.pendingContext=n,t=Kr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Lo(o,t,a),e!==null&&(tr(e,o,a,i),Ll(e,o,a)),a}function gc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Iy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Uv(e,t){Iy(e,t),(e=e.alternate)&&Iy(e,t)}function lR(){return null}var $w=typeof reportError=="function"?reportError:function(e){console.error(e)};function Vv(e){this._internalRoot=e}dd.prototype.render=Vv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));cd(e,t,null,null)};dd.prototype.unmount=Vv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Pi(function(){cd(null,e,null,null)}),t[Xr]=null}};function dd(e){this._internalRoot=e}dd.prototype.unstable_scheduleHydration=function(e){if(e){var t=yx();e={blockedOn:null,target:e,priority:t};for(var n=0;n<wo.length&&t!==0&&t<wo[n].priority;n++);wo.splice(n,0,e),n===0&&wx(e)}};function jv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ty(){}function cR(e,t,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=gc(a);i.call(l)}}var a=zw(t,r,e,0,null,!1,!1,"",Ty);return e._reactRootContainer=a,e[Xr]=a.current,Qs(e.nodeType===8?e.parentNode:e),Pi(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=gc(u);s.call(l)}}var u=$v(e,0,!1,null,null,!1,!1,"",Ty);return e._reactRootContainer=u,e[Xr]=u.current,Qs(e.nodeType===8?e.parentNode:e),Pi(function(){cd(t,u,n,r)}),u}function hd(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=gc(a);s.call(u)}}cd(t,a,e,o)}else a=cR(n,t,e,o,r);return gc(a)}mx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Is(t.pendingLanes);n!==0&&(lv(t,n|1),on(t,it()),!(De&6)&&(Ga=it()+500,Zo()))}break;case 13:Pi(function(){var r=Yr(e,1);if(r!==null){var o=Kt();tr(r,e,1,o)}}),Uv(e,1)}};cv=function(e){if(e.tag===13){var t=Yr(e,134217728);if(t!==null){var n=Kt();tr(t,e,134217728,n)}Uv(e,134217728)}};gx=function(e){if(e.tag===13){var t=Wo(e),n=Yr(e,t);if(n!==null){var r=Kt();tr(n,e,t,r)}Uv(e,t)}};yx=function(){return ze};xx=function(e,t){var n=ze;try{return ze=e,t()}finally{ze=n}};Sh=function(e,t,n){switch(t){case"input":if(gh(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=rd(r);if(!o)throw Error(Q(90));Y1(r),gh(r,o)}}}break;case"textarea":J1(e,n);break;case"select":t=n.value,t!=null&&pa(e,!!n.multiple,t,!1)}};ix=Lv;ax=Pi;var dR={usingClientEntryPoint:!1,Events:[ku,sa,rd,rx,ox,Lv]},xs={findFiberByHostInstance:hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fR={bundleType:xs.bundleType,version:xs.version,rendererPackageName:xs.rendererPackageName,rendererConfig:xs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:to.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=lx(e),e===null?null:e.stateNode},findFiberByHostInstance:xs.findFiberByHostInstance||lR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ul.isDisabled&&ul.supportsFiber)try{Zc=ul.inject(fR),_r=ul}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dR;In.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jv(t))throw Error(Q(200));return uR(e,t,null,n)};In.createRoot=function(e,t){if(!jv(e))throw Error(Q(299));var n=!1,r="",o=$w;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=$v(e,1,!1,null,null,n,!1,r,o),e[Xr]=t.current,Qs(e.nodeType===8?e.parentNode:e),new Vv(t)};In.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=lx(t),e=e===null?null:e.stateNode,e};In.flushSync=function(e){return Pi(e)};In.hydrate=function(e,t,n){if(!fd(t))throw Error(Q(200));return hd(null,e,t,!0,n)};In.hydrateRoot=function(e,t,n){if(!jv(e))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=$w;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=zw(t,null,e,1,n??null,o,!1,i,a),e[Xr]=t.current,Qs(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new dd(t)};In.render=function(e,t,n){if(!fd(t))throw Error(Q(200));return hd(null,e,t,!1,n)};In.unmountComponentAtNode=function(e){if(!fd(e))throw Error(Q(40));return e._reactRootContainer?(Pi(function(){hd(null,null,e,!1,function(){e._reactRootContainer=null,e[Xr]=null})}),!0):!1};In.unstable_batchedUpdates=Lv;In.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!fd(n))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return hd(e,t,n,!1,r)};In.version="18.3.1-next-f1338f8080-20240426";function Uw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Uw)}catch(e){console.error(e)}}Uw(),U1.exports=In;var Oi=U1.exports;const Vw=T1(Oi);var hR,Py=Oi;hR=Py.createRoot,Py.hydrateRoot;function ge(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function pR(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function jw(...e){return t=>e.forEach(n=>pR(n,t))}function Me(...e){return E.useCallback(jw(...e),e)}function vR(e,t=[]){let n=[];function r(i,a){const s=E.createContext(a),u=n.length;n=[...n,a];function l(d){const{scope:f,children:h,...v}=d,p=(f==null?void 0:f[e][u])||s,g=E.useMemo(()=>v,Object.values(v));return $.jsx(p.Provider,{value:g,children:h})}function c(d,f){const h=(f==null?void 0:f[e][u])||s,v=E.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return l.displayName=i+"Provider",[l,c]}const o=()=>{const i=n.map(a=>E.createContext(a));return function(s){const u=(s==null?void 0:s[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,mR(o,...t)]}function mR(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(i)[`__scope${l}`];return{...s,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var au=E.forwardRef((e,t)=>{const{children:n,...r}=e,o=E.Children.toArray(n),i=o.find(gR);if(i){const a=i.props.children,s=o.map(u=>u===i?E.Children.count(a)>1?E.Children.only(null):E.isValidElement(a)?a.props.children:null:u);return $.jsx(rp,{...r,ref:t,children:E.isValidElement(a)?E.cloneElement(a,void 0,s):null})}return $.jsx(rp,{...r,ref:t,children:n})});au.displayName="Slot";var rp=E.forwardRef((e,t)=>{const{children:n,...r}=e;if(E.isValidElement(n)){const o=xR(n);return E.cloneElement(n,{...yR(r,n.props),ref:t?jw(t,o):o})}return E.Children.count(n)>1?E.Children.only(null):null});rp.displayName="SlotClone";var Hw=({children:e})=>$.jsx($.Fragment,{children:e});function gR(e){return E.isValidElement(e)&&e.type===Hw}function yR(e,t){const n={...t};for(const r in t){const o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{i(...s),o(...s)}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}function xR(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Hv(e){const t=e+"CollectionProvider",[n,r]=vR(t),[o,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=h=>{const{scope:v,children:p}=h,g=Z.useRef(null),m=Z.useRef(new Map).current;return $.jsx(o,{scope:v,itemMap:m,collectionRef:g,children:p})};a.displayName=t;const s=e+"CollectionSlot",u=Z.forwardRef((h,v)=>{const{scope:p,children:g}=h,m=i(s,p),y=Me(v,m.collectionRef);return $.jsx(au,{ref:y,children:g})});u.displayName=s;const l=e+"CollectionItemSlot",c="data-radix-collection-item",d=Z.forwardRef((h,v)=>{const{scope:p,children:g,...m}=h,y=Z.useRef(null),x=Me(v,y),w=i(l,p);return Z.useEffect(()=>(w.itemMap.set(y,{ref:y,...m}),()=>void w.itemMap.delete(y))),$.jsx(au,{[c]:"",ref:x,children:g})});d.displayName=l;function f(h){const v=i(e+"CollectionConsumer",h);return Z.useCallback(()=>{const g=v.collectionRef.current;if(!g)return[];const m=Array.from(g.querySelectorAll(`[${c}]`));return Array.from(v.itemMap.values()).sort((w,b)=>m.indexOf(w.ref.current)-m.indexOf(b.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:u,ItemSlot:d},f,r]}function rs(e,t=[]){let n=[];function r(i,a){const s=E.createContext(a),u=n.length;n=[...n,a];const l=d=>{var m;const{scope:f,children:h,...v}=d,p=((m=f==null?void 0:f[e])==null?void 0:m[u])||s,g=E.useMemo(()=>v,Object.values(v));return $.jsx(p.Provider,{value:g,children:h})};l.displayName=i+"Provider";function c(d,f){var p;const h=((p=f==null?void 0:f[e])==null?void 0:p[u])||s,v=E.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[l,c]}const o=()=>{const i=n.map(a=>E.createContext(a));return function(s){const u=(s==null?void 0:s[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,wR(o,...t)]}function wR(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(i)[`__scope${l}`];return{...s,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var bR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ke=bR.reduce((e,t)=>{const n=E.forwardRef((r,o)=>{const{asChild:i,...a}=r,s=i?au:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),$.jsx(s,{...a,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Gw(e,t){e&&Oi.flushSync(()=>e.dispatchEvent(t))}function at(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function CR(e,t=globalThis==null?void 0:globalThis.document){const n=at(e);E.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var ER="DismissableLayer",op="dismissableLayer.update",SR="dismissableLayer.pointerDownOutside",_R="dismissableLayer.focusOutside",Ay,Kw=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),pd=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:s,...u}=e,l=E.useContext(Kw),[c,d]=E.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=E.useState({}),v=Me(t,S=>d(S)),p=Array.from(l.layers),[g]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),m=p.indexOf(g),y=c?p.indexOf(c):-1,x=l.layersWithOutsidePointerEventsDisabled.size>0,w=y>=m,b=RR(S=>{const _=S.target,k=[...l.branches].some(R=>R.contains(_));!w||k||(o==null||o(S),a==null||a(S),S.defaultPrevented||s==null||s())},f),C=IR(S=>{const _=S.target;[...l.branches].some(R=>R.contains(_))||(i==null||i(S),a==null||a(S),S.defaultPrevented||s==null||s())},f);return CR(S=>{y===l.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&s&&(S.preventDefault(),s()))},f),E.useEffect(()=>{if(c)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(Ay=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(c)),l.layers.add(c),Ny(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Ay)}},[c,f,n,l]),E.useEffect(()=>()=>{c&&(l.layers.delete(c),l.layersWithOutsidePointerEventsDisabled.delete(c),Ny())},[c,l]),E.useEffect(()=>{const S=()=>h({});return document.addEventListener(op,S),()=>document.removeEventListener(op,S)},[]),$.jsx(ke.div,{...u,ref:v,style:{pointerEvents:x?w?"auto":"none":void 0,...e.style},onFocusCapture:ge(e.onFocusCapture,C.onFocusCapture),onBlurCapture:ge(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:ge(e.onPointerDownCapture,b.onPointerDownCapture)})});pd.displayName=ER;var kR="DismissableLayerBranch",qw=E.forwardRef((e,t)=>{const n=E.useContext(Kw),r=E.useRef(null),o=Me(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),$.jsx(ke.div,{...e,ref:o})});qw.displayName=kR;function RR(e,t=globalThis==null?void 0:globalThis.document){const n=at(e),r=E.useRef(!1),o=E.useRef(()=>{});return E.useEffect(()=>{const i=s=>{if(s.target&&!r.current){let u=function(){Xw(SR,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=u,t.addEventListener("click",o.current,{once:!0})):u()}else t.removeEventListener("click",o.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function IR(e,t=globalThis==null?void 0:globalThis.document){const n=at(e),r=E.useRef(!1);return E.useEffect(()=>{const o=i=>{i.target&&!r.current&&Xw(_R,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Ny(){const e=new CustomEvent(op);document.dispatchEvent(e)}function Xw(e,t,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Gw(o,i):o.dispatchEvent(i)}var TR=pd,PR=qw,mt=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},AR="Portal",Gv=E.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[o,i]=E.useState(!1);mt(()=>i(!0),[]);const a=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return a?Vw.createPortal($.jsx(ke.div,{...r,ref:t}),a):null});Gv.displayName=AR;function NR(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var Li=e=>{const{present:t,children:n}=e,r=DR(t),o=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),i=Me(r.ref,MR(o));return typeof n=="function"||r.isPresent?E.cloneElement(o,{ref:i}):null};Li.displayName="Presence";function DR(e){const[t,n]=E.useState(),r=E.useRef({}),o=E.useRef(e),i=E.useRef("none"),a=e?"mounted":"unmounted",[s,u]=NR(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const l=ll(r.current);i.current=s==="mounted"?l:"none"},[s]),mt(()=>{const l=r.current,c=o.current;if(c!==e){const f=i.current,h=ll(l);e?u("MOUNT"):h==="none"||(l==null?void 0:l.display)==="none"?u("UNMOUNT"):u(c&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),mt(()=>{if(t){let l;const c=t.ownerDocument.defaultView??window,d=h=>{const p=ll(r.current).includes(h.animationName);if(h.target===t&&p&&(u("ANIMATION_END"),!o.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",l=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},f=h=>{h.target===t&&(i.current=ll(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{c.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:E.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function ll(e){return(e==null?void 0:e.animationName)||"none"}function MR(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function yc({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,o]=FR({defaultProp:t,onChange:n}),i=e!==void 0,a=i?e:r,s=at(n),u=E.useCallback(l=>{if(i){const d=typeof l=="function"?l(e):l;d!==e&&s(d)}else o(l)},[i,e,o,s]);return[a,u]}function FR({defaultProp:e,onChange:t}){const n=E.useState(e),[r]=n,o=E.useRef(r),i=at(t);return E.useEffect(()=>{o.current!==r&&(i(r),o.current=r)},[r,o,i]),n}var OR="VisuallyHidden",Iu=E.forwardRef((e,t)=>$.jsx(ke.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));Iu.displayName=OR;var LR=Iu,Kv="ToastProvider",[qv,BR,WR]=Hv("Toast"),[Yw,ez]=rs("Toast",[WR]),[zR,vd]=Yw(Kv),Qw=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:a}=e,[s,u]=E.useState(null),[l,c]=E.useState(0),d=E.useRef(!1),f=E.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Kv}\`. Expected non-empty \`string\`.`),$.jsx(qv.Provider,{scope:t,children:$.jsx(zR,{scope:t,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:l,viewport:s,onViewportChange:u,onToastAdd:E.useCallback(()=>c(h=>h+1),[]),onToastRemove:E.useCallback(()=>c(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};Qw.displayName=Kv;var Jw="ToastViewport",$R=["F8"],ip="toast.viewportPause",ap="toast.viewportResume",Zw=E.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=$R,label:o="Notifications ({hotkey})",...i}=e,a=vd(Jw,n),s=BR(n),u=E.useRef(null),l=E.useRef(null),c=E.useRef(null),d=E.useRef(null),f=Me(t,d,a.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=a.toastCount>0;E.useEffect(()=>{const g=m=>{var x;r.length!==0&&r.every(w=>m[w]||m.code===w)&&((x=d.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),E.useEffect(()=>{const g=u.current,m=d.current;if(v&&g&&m){const y=()=>{if(!a.isClosePausedRef.current){const C=new CustomEvent(ip);m.dispatchEvent(C),a.isClosePausedRef.current=!0}},x=()=>{if(a.isClosePausedRef.current){const C=new CustomEvent(ap);m.dispatchEvent(C),a.isClosePausedRef.current=!1}},w=C=>{!g.contains(C.relatedTarget)&&x()},b=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",y),g.addEventListener("focusout",w),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",b),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",w),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",b),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[v,a.isClosePausedRef]);const p=E.useCallback(({tabbingDirection:g})=>{const y=s().map(x=>{const w=x.ref.current,b=[w,...eI(w)];return g==="forwards"?b:b.reverse()});return(g==="forwards"?y.reverse():y).flat()},[s]);return E.useEffect(()=>{const g=d.current;if(g){const m=y=>{var b,C,S;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const _=document.activeElement,k=y.shiftKey;if(y.target===g&&k){(b=l.current)==null||b.focus();return}const P=p({tabbingDirection:k?"backwards":"forwards"}),L=P.findIndex(M=>M===_);kf(P.slice(L+1))?y.preventDefault():k?(C=l.current)==null||C.focus():(S=c.current)==null||S.focus()}};return g.addEventListener("keydown",m),()=>g.removeEventListener("keydown",m)}},[s,p]),$.jsxs(PR,{ref:u,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&$.jsx(sp,{ref:l,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"forwards"});kf(g)}}),$.jsx(qv.Slot,{scope:n,children:$.jsx(ke.ol,{tabIndex:-1,...i,ref:f})}),v&&$.jsx(sp,{ref:c,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"backwards"});kf(g)}})]})});Zw.displayName=Jw;var eb="ToastFocusProxy",sp=E.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=e,i=vd(eb,n);return $.jsx(Iu,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:a=>{var l;const s=a.relatedTarget;!((l=i.viewport)!=null&&l.contains(s))&&r()}})});sp.displayName=eb;var md="Toast",UR="toast.swipeStart",VR="toast.swipeMove",jR="toast.swipeCancel",HR="toast.swipeEnd",tb=E.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...a}=e,[s=!0,u]=yc({prop:r,defaultProp:o,onChange:i});return $.jsx(Li,{present:n||s,children:$.jsx(qR,{open:s,...a,ref:t,onClose:()=>u(!1),onPause:at(e.onPause),onResume:at(e.onResume),onSwipeStart:ge(e.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ge(e.onSwipeMove,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ge(e.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ge(e.onSwipeEnd,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),u(!1)})})})});tb.displayName=md;var[GR,KR]=Yw(md,{onClose(){}}),qR=E.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:a,onEscapeKeyDown:s,onPause:u,onResume:l,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...v}=e,p=vd(md,n),[g,m]=E.useState(null),y=Me(t,M=>m(M)),x=E.useRef(null),w=E.useRef(null),b=o||p.duration,C=E.useRef(0),S=E.useRef(b),_=E.useRef(0),{onToastAdd:k,onToastRemove:R}=p,N=at(()=>{var W;(g==null?void 0:g.contains(document.activeElement))&&((W=p.viewport)==null||W.focus()),a()}),P=E.useCallback(M=>{!M||M===1/0||(window.clearTimeout(_.current),C.current=new Date().getTime(),_.current=window.setTimeout(N,M))},[N]);E.useEffect(()=>{const M=p.viewport;if(M){const W=()=>{P(S.current),l==null||l()},B=()=>{const z=new Date().getTime()-C.current;S.current=S.current-z,window.clearTimeout(_.current),u==null||u()};return M.addEventListener(ip,B),M.addEventListener(ap,W),()=>{M.removeEventListener(ip,B),M.removeEventListener(ap,W)}}},[p.viewport,b,u,l,P]),E.useEffect(()=>{i&&!p.isClosePausedRef.current&&P(b)},[i,b,p.isClosePausedRef,P]),E.useEffect(()=>(k(),()=>R()),[k,R]);const L=E.useMemo(()=>g?ub(g):null,[g]);return p.viewport?$.jsxs($.Fragment,{children:[L&&$.jsx(XR,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:L}),$.jsx(GR,{scope:n,onClose:N,children:Oi.createPortal($.jsx(qv.ItemSlot,{scope:n,children:$.jsx(TR,{asChild:!0,onEscapeKeyDown:ge(s,()=>{p.isFocusedToastEscapeKeyDownRef.current||N(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:$.jsx(ke.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":p.swipeDirection,...v,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ge(e.onKeyDown,M=>{M.key==="Escape"&&(s==null||s(M.nativeEvent),M.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,N()))}),onPointerDown:ge(e.onPointerDown,M=>{M.button===0&&(x.current={x:M.clientX,y:M.clientY})}),onPointerMove:ge(e.onPointerMove,M=>{if(!x.current)return;const W=M.clientX-x.current.x,B=M.clientY-x.current.y,z=!!w.current,A=["left","right"].includes(p.swipeDirection),F=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,U=A?F(0,W):0,j=A?0:F(0,B),K=M.pointerType==="touch"?10:2,Y={x:U,y:j},ne={originalEvent:M,delta:Y};z?(w.current=Y,cl(VR,d,ne,{discrete:!1})):Dy(Y,p.swipeDirection,K)?(w.current=Y,cl(UR,c,ne,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(W)>K||Math.abs(B)>K)&&(x.current=null)}),onPointerUp:ge(e.onPointerUp,M=>{const W=w.current,B=M.target;if(B.hasPointerCapture(M.pointerId)&&B.releasePointerCapture(M.pointerId),w.current=null,x.current=null,W){const z=M.currentTarget,A={originalEvent:M,delta:W};Dy(W,p.swipeDirection,p.swipeThreshold)?cl(HR,h,A,{discrete:!0}):cl(jR,f,A,{discrete:!0}),z.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),XR=e=>{const{__scopeToast:t,children:n,...r}=e,o=vd(md,t),[i,a]=E.useState(!1),[s,u]=E.useState(!1);return JR(()=>a(!0)),E.useEffect(()=>{const l=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(l)},[]),s?null:$.jsx(Gv,{asChild:!0,children:$.jsx(Iu,{...r,children:i&&$.jsxs($.Fragment,{children:[o.label," ",n]})})})},YR="ToastTitle",nb=E.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return $.jsx(ke.div,{...r,ref:t})});nb.displayName=YR;var QR="ToastDescription",rb=E.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return $.jsx(ke.div,{...r,ref:t})});rb.displayName=QR;var ob="ToastAction",ib=E.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?$.jsx(sb,{altText:n,asChild:!0,children:$.jsx(Xv,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${ob}\`. Expected non-empty \`string\`.`),null)});ib.displayName=ob;var ab="ToastClose",Xv=E.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,o=KR(ab,n);return $.jsx(sb,{asChild:!0,children:$.jsx(ke.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,o.onClose)})})});Xv.displayName=ab;var sb=E.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...o}=e;return $.jsx(ke.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function ub(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),ZR(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...ub(r))}}),t}function cl(e,t,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Gw(o,i):o.dispatchEvent(i)}var Dy=(e,t,n=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),i=r>o;return t==="left"||t==="right"?i&&r>n:!i&&o>n};function JR(e=()=>{}){const t=at(e);mt(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function ZR(e){return e.nodeType===e.ELEMENT_NODE}function eI(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function kf(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var tz=Qw,nz=Zw,rz=tb,oz=nb,iz=rb,az=ib,sz=Xv;function lb(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=lb(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function tI(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=lb(e))&&(r&&(r+=" "),r+=t);return r}const My=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Fy=tI,uz=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return Fy(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=t,a=Object.keys(o).map(l=>{const c=n==null?void 0:n[l],d=i==null?void 0:i[l];if(c===null)return null;const f=My(c)||My(d);return o[l][f]}),s=n&&Object.entries(n).reduce((l,c)=>{let[d,f]=c;return f===void 0||(l[d]=f),l},{}),u=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((l,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(v=>{let[p,g]=v;return Array.isArray(g)?g.includes({...i,...s}[p]):{...i,...s}[p]===g})?[...l,d,f]:l},[]);return Fy(e,a,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),cb=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:a,...s},u)=>E.createElement("svg",{ref:u,...rI,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:cb("lucide",o),...s},[...a.map(([l,c])=>E.createElement(l,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=(e,t)=>{const n=E.forwardRef(({className:r,...o},i)=>E.createElement(oI,{ref:i,iconNode:t,className:cb(`lucide-${nI(e)}`,r),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=ct("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=ct("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=ct("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=ct("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=ct("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=ct("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=ct("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=ct("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=ct("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=ct("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=ct("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=ct("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=ct("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=ct("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=ct("Volume1",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=ct("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=ct("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=ct("Volume",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=ct("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=ct("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Yv="-",iI=e=>{const t=sI(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const s=a.split(Yv);return s[0]===""&&s.length!==1&&s.shift(),db(s,t)||aI(a)},getConflictingClassGroupIds:(a,s)=>{const u=n[a]||[];return s&&r[a]?[...u,...r[a]]:u}}},db=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?db(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const i=e.join(Yv);return(a=t.validators.find(({validator:s})=>s(i)))==null?void 0:a.classGroupId},Oy=/^\[(.+)\]$/,aI=e=>{if(Oy.test(e)){const t=Oy.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},sI=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return lI(Object.entries(e.classGroups),n).forEach(([i,a])=>{up(a,r,i,t)}),r},up=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const i=o===""?t:Ly(t,o);i.classGroupId=n;return}if(typeof o=="function"){if(uI(o)){up(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,a])=>{up(a,Ly(t,i),n,r)})})},Ly=(e,t)=>{let n=e;return t.split(Yv).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},uI=e=>e.isThemeGetter,lI=(e,t)=>t?e.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,s])=>[t+a,s])):i);return[n,o]}):e,cI=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){n.has(i)?n.set(i,a):o(i,a)}}},fb="!",dI=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,o=t[0],i=t.length,a=s=>{const u=[];let l=0,c=0,d;for(let g=0;g<s.length;g++){let m=s[g];if(l===0){if(m===o&&(r||s.slice(g,g+i)===t)){u.push(s.slice(c,g)),c=g+i;continue}if(m==="/"){d=g;continue}}m==="["?l++:m==="]"&&l--}const f=u.length===0?s:s.substring(c),h=f.startsWith(fb),v=h?f.substring(1):f,p=d&&d>c?d-c:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:p}};return n?s=>n({className:s,parseClassName:a}):a},fI=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},hI=e=>({cache:cI(e.cacheSize),parseClassName:dI(e),...iI(e)}),pI=/\s+/,vI=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=t,i=[],a=e.trim().split(pI);let s="";for(let u=a.length-1;u>=0;u-=1){const l=a[u],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(l);let v=!!h,p=r(v?f.substring(0,h):f);if(!p){if(!v){s=l+(s.length>0?" "+s:s);continue}if(p=r(f),!p){s=l+(s.length>0?" "+s:s);continue}v=!1}const g=fI(c).join(":"),m=d?g+fb:g,y=m+p;if(i.includes(y))continue;i.push(y);const x=o(p,v);for(let w=0;w<x.length;++w){const b=x[w];i.push(m+b)}s=l+(s.length>0?" "+s:s)}return s};function mI(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=hb(t))&&(r&&(r+=" "),r+=n);return r}const hb=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=hb(e[r]))&&(n&&(n+=" "),n+=t);return n};function gI(e,...t){let n,r,o,i=a;function a(u){const l=t.reduce((c,d)=>d(c),e());return n=hI(l),r=n.cache.get,o=n.cache.set,i=s,s(u)}function s(u){const l=r(u);if(l)return l;const c=vI(u,n);return o(u,c),c}return function(){return i(mI.apply(null,arguments))}}const He=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},pb=/^\[(?:([a-z-]+):)?(.+)\]$/i,yI=/^\d+\/\d+$/,xI=new Set(["px","full","screen"]),wI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,bI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,CI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,EI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,SI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Br=e=>wa(e)||xI.has(e)||yI.test(e),fo=e=>os(e,"length",NI),wa=e=>!!e&&!Number.isNaN(Number(e)),Rf=e=>os(e,"number",wa),ws=e=>!!e&&Number.isInteger(Number(e)),_I=e=>e.endsWith("%")&&wa(e.slice(0,-1)),Ee=e=>pb.test(e),ho=e=>wI.test(e),kI=new Set(["length","size","percentage"]),RI=e=>os(e,kI,vb),II=e=>os(e,"position",vb),TI=new Set(["image","url"]),PI=e=>os(e,TI,MI),AI=e=>os(e,"",DI),bs=()=>!0,os=(e,t,n)=>{const r=pb.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},NI=e=>bI.test(e)&&!CI.test(e),vb=()=>!1,DI=e=>EI.test(e),MI=e=>SI.test(e),FI=()=>{const e=He("colors"),t=He("spacing"),n=He("blur"),r=He("brightness"),o=He("borderColor"),i=He("borderRadius"),a=He("borderSpacing"),s=He("borderWidth"),u=He("contrast"),l=He("grayscale"),c=He("hueRotate"),d=He("invert"),f=He("gap"),h=He("gradientColorStops"),v=He("gradientColorStopPositions"),p=He("inset"),g=He("margin"),m=He("opacity"),y=He("padding"),x=He("saturate"),w=He("scale"),b=He("sepia"),C=He("skew"),S=He("space"),_=He("translate"),k=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",Ee,t],P=()=>[Ee,t],L=()=>["",Br,fo],M=()=>["auto",wa,Ee],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],B=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",Ee],U=()=>["auto","avoid","all","avoid-page","page","left","right","column"],j=()=>[wa,Ee];return{cacheSize:500,separator:":",theme:{colors:[bs],spacing:[Br,fo],blur:["none","",ho,Ee],brightness:j(),borderColor:[e],borderRadius:["none","","full",ho,Ee],borderSpacing:P(),borderWidth:L(),contrast:j(),grayscale:F(),hueRotate:j(),invert:F(),gap:P(),gradientColorStops:[e],gradientColorStopPositions:[_I,fo],inset:N(),margin:N(),opacity:j(),padding:P(),saturate:j(),scale:j(),sepia:F(),skew:j(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",Ee]}],container:["container"],columns:[{columns:[ho]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),Ee]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ws,Ee]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ee]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",ws,Ee]}],"grid-cols":[{"grid-cols":[bs]}],"col-start-end":[{col:["auto",{span:["full",ws,Ee]},Ee]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[bs]}],"row-start-end":[{row:["auto",{span:[ws,Ee]},Ee]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ee]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ee]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ee,t]}],"min-w":[{"min-w":[Ee,t,"min","max","fit"]}],"max-w":[{"max-w":[Ee,t,"none","full","min","max","fit","prose",{screen:[ho]},ho]}],h:[{h:[Ee,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ee,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ee,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ee,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ho,fo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Rf]}],"font-family":[{font:[bs]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ee]}],"line-clamp":[{"line-clamp":["none",wa,Rf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Br,Ee]}],"list-image":[{"list-image":["none",Ee]}],"list-style-type":[{list:["none","disc","decimal",Ee]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[m]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[m]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Br,fo]}],"underline-offset":[{"underline-offset":["auto",Br,Ee]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ee]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ee]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[m]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),II]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",RI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},PI]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[m]}],"border-style":[{border:[...B(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[m]}],"divide-style":[{divide:B()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...B()]}],"outline-offset":[{"outline-offset":[Br,Ee]}],"outline-w":[{outline:[Br,fo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[m]}],"ring-offset-w":[{"ring-offset":[Br,fo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ho,AI]}],"shadow-color":[{shadow:[bs]}],opacity:[{opacity:[m]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",ho,Ee]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[m]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ee]}],duration:[{duration:j()}],ease:[{ease:["linear","in","out","in-out",Ee]}],delay:[{delay:j()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ee]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[ws,Ee]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ee]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ee]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ee]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Br,fo,Rf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Tz=gI(FI);var By=["light","dark"],OI="(prefers-color-scheme: dark)",LI=E.createContext(void 0),BI={setTheme:e=>{},themes:[]},Pz=()=>{var e;return(e=E.useContext(LI))!=null?e:BI};E.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:i,value:a,attrs:s,nonce:u})=>{let l=i==="system",c=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?By.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(v,p=!1,g=!0)=>{let m=a?a[v]:v,y=p?v+"|| ''":`'${m}'`,x="";return o&&g&&!p&&By.includes(v)&&(x+=`d.style.colorScheme = '${v}';`),n==="class"?p||m?x+=`c.add(${y})`:x+="null":m&&(x+=`d[s](n,${y})`),x},h=e?`!function(){${c}${f(e)}}()`:r?`!function(){try{${c}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${l})){var t='${OI}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}${l?"":"else{"+f(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${c}var e=localStorage.getItem('${t}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${d}}catch(t){}}();`;return E.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:h}})});var WI=e=>{switch(e){case"success":return UI;case"info":return jI;case"warning":return VI;case"error":return HI;default:return null}},zI=Array(12).fill(0),$I=({visible:e})=>Z.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},Z.createElement("div",{className:"sonner-spinner"},zI.map((t,n)=>Z.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),UI=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),VI=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),jI=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),HI=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),GI=()=>{let[e,t]=Z.useState(document.hidden);return Z.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},lp=1,KI=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:r,...o}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:lp++,a=this.toasts.find(u=>u.id===i),s=t.dismissible===void 0?!0:t.dismissible;return a?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...t,id:i,title:r}),{...u,...t,id:i,dismissible:s,title:r}):u):this.addToast({title:r,...o,dismissible:s,id:i}),i},this.dismiss=t=>(t||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=t instanceof Promise?t:t(),i=r!==void 0;return o.then(async a=>{if(XI(a)&&!a.ok){i=!1;let s=typeof n.error=="function"?await n.error(`HTTP error! status: ${a.status}`):n.error,u=typeof n.description=="function"?await n.description(`HTTP error! status: ${a.status}`):n.description;this.create({id:r,type:"error",message:s,description:u})}else if(n.success!==void 0){i=!1;let s=typeof n.success=="function"?await n.success(a):n.success,u=typeof n.description=="function"?await n.description(a):n.description;this.create({id:r,type:"success",message:s,description:u})}}).catch(async a=>{if(n.error!==void 0){i=!1;let s=typeof n.error=="function"?await n.error(a):n.error,u=typeof n.description=="function"?await n.description(a):n.description;this.create({id:r,type:"error",message:s,description:u})}}).finally(()=>{var a;i&&(this.dismiss(r),r=void 0),(a=n.finally)==null||a.call(n)}),r},this.custom=(t,n)=>{let r=(n==null?void 0:n.id)||lp++;return this.create({jsx:t(r),id:r,...n}),r},this.subscribers=[],this.toasts=[]}},pn=new KI,qI=(e,t)=>{let n=(t==null?void 0:t.id)||lp++;return pn.addToast({title:e,...t,id:n}),n},XI=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",YI=qI,QI=()=>pn.toasts;Object.assign(YI,{success:pn.success,info:pn.info,warning:pn.warning,error:pn.error,custom:pn.custom,message:pn.message,promise:pn.promise,dismiss:pn.dismiss,loading:pn.loading},{getHistory:QI});function JI(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}JI(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function dl(e){return e.label!==void 0}var ZI=3,eT="32px",tT=4e3,nT=356,rT=14,oT=20,iT=200;function aT(...e){return e.filter(Boolean).join(" ")}var sT=e=>{var t,n,r,o,i,a,s,u,l,c;let{invert:d,toast:f,unstyled:h,interacting:v,setHeights:p,visibleToasts:g,heights:m,index:y,toasts:x,expanded:w,removeToast:b,defaultRichColors:C,closeButton:S,style:_,cancelButtonStyle:k,actionButtonStyle:R,className:N="",descriptionClassName:P="",duration:L,position:M,gap:W,loadingIcon:B,expandByDefault:z,classNames:A,icons:F,closeButtonAriaLabel:U="Close toast",pauseWhenPageIsHidden:j,cn:K}=e,[Y,ne]=Z.useState(!1),[pe,te]=Z.useState(!1),[J,oe]=Z.useState(!1),[ve,me]=Z.useState(!1),[ie,le]=Z.useState(0),[ye,Pe]=Z.useState(0),Fe=Z.useRef(null),Ae=Z.useRef(null),wt=y===0,Yt=y+1<=g,Oe=f.type,cn=f.dismissible!==!1,jn=f.className||"",ur=f.descriptionClassName||"",Qt=Z.useMemo(()=>m.findIndex(Ce=>Ce.toastId===f.id)||0,[m,f.id]),uo=Z.useMemo(()=>{var Ce;return(Ce=f.closeButton)!=null?Ce:S},[f.closeButton,S]),Pn=Z.useMemo(()=>f.duration||L||tT,[f.duration,L]),ii=Z.useRef(0),dn=Z.useRef(0),fn=Z.useRef(0),lr=Z.useRef(null),[Uu,Qd]=M.split("-"),Vu=Z.useMemo(()=>m.reduce((Ce,je,$e)=>$e>=Qt?Ce:Ce+je.height,0),[m,Qt]),Vi=GI(),ds=f.invert||d,ai=Oe==="loading";dn.current=Z.useMemo(()=>Qt*W+Vu,[Qt,Vu]),Z.useEffect(()=>{ne(!0)},[]),Z.useLayoutEffect(()=>{if(!Y)return;let Ce=Ae.current,je=Ce.style.height;Ce.style.height="auto";let $e=Ce.getBoundingClientRect().height;Ce.style.height=je,Pe($e),p(cr=>cr.find(dr=>dr.toastId===f.id)?cr.map(dr=>dr.toastId===f.id?{...dr,height:$e}:dr):[{toastId:f.id,height:$e,position:f.position},...cr])},[Y,f.title,f.description,p,f.id]);let lo=Z.useCallback(()=>{te(!0),le(dn.current),p(Ce=>Ce.filter(je=>je.toastId!==f.id)),setTimeout(()=>{b(f)},iT)},[f,b,p,dn]);Z.useEffect(()=>{if(f.promise&&Oe==="loading"||f.duration===1/0||f.type==="loading")return;let Ce,je=Pn;return w||v||j&&Vi?(()=>{if(fn.current<ii.current){let $e=new Date().getTime()-ii.current;je=je-$e}fn.current=new Date().getTime()})():je!==1/0&&(ii.current=new Date().getTime(),Ce=setTimeout(()=>{var $e;($e=f.onAutoClose)==null||$e.call(f,f),lo()},je)),()=>clearTimeout(Ce)},[w,v,z,f,Pn,lo,f.promise,Oe,j,Vi]),Z.useEffect(()=>{let Ce=Ae.current;if(Ce){let je=Ce.getBoundingClientRect().height;return Pe(je),p($e=>[{toastId:f.id,height:je,position:f.position},...$e]),()=>p($e=>$e.filter(cr=>cr.toastId!==f.id))}},[p,f.id]),Z.useEffect(()=>{f.delete&&lo()},[lo,f.delete]);function WS(){return F!=null&&F.loading?Z.createElement("div",{className:"sonner-loader","data-visible":Oe==="loading"},F.loading):B?Z.createElement("div",{className:"sonner-loader","data-visible":Oe==="loading"},B):Z.createElement($I,{visible:Oe==="loading"})}return Z.createElement("li",{"aria-live":f.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Ae,className:K(N,jn,A==null?void 0:A.toast,(t=f==null?void 0:f.classNames)==null?void 0:t.toast,A==null?void 0:A.default,A==null?void 0:A[Oe],(n=f==null?void 0:f.classNames)==null?void 0:n[Oe]),"data-sonner-toast":"","data-rich-colors":(r=f.richColors)!=null?r:C,"data-styled":!(f.jsx||f.unstyled||h),"data-mounted":Y,"data-promise":!!f.promise,"data-removed":pe,"data-visible":Yt,"data-y-position":Uu,"data-x-position":Qd,"data-index":y,"data-front":wt,"data-swiping":J,"data-dismissible":cn,"data-type":Oe,"data-invert":ds,"data-swipe-out":ve,"data-expanded":!!(w||z&&Y),style:{"--index":y,"--toasts-before":y,"--z-index":x.length-y,"--offset":`${pe?ie:dn.current}px`,"--initial-height":z?"auto":`${ye}px`,..._,...f.style},onPointerDown:Ce=>{ai||!cn||(Fe.current=new Date,le(dn.current),Ce.target.setPointerCapture(Ce.pointerId),Ce.target.tagName!=="BUTTON"&&(oe(!0),lr.current={x:Ce.clientX,y:Ce.clientY}))},onPointerUp:()=>{var Ce,je,$e,cr;if(ve||!cn)return;lr.current=null;let dr=Number(((Ce=Ae.current)==null?void 0:Ce.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ju=new Date().getTime()-((je=Fe.current)==null?void 0:je.getTime()),zS=Math.abs(dr)/ju;if(Math.abs(dr)>=oT||zS>.11){le(dn.current),($e=f.onDismiss)==null||$e.call(f,f),lo(),me(!0);return}(cr=Ae.current)==null||cr.style.setProperty("--swipe-amount","0px"),oe(!1)},onPointerMove:Ce=>{var je;if(!lr.current||!cn)return;let $e=Ce.clientY-lr.current.y,cr=Ce.clientX-lr.current.x,dr=(Uu==="top"?Math.min:Math.max)(0,$e),ju=Ce.pointerType==="touch"?10:2;Math.abs(dr)>ju?(je=Ae.current)==null||je.style.setProperty("--swipe-amount",`${$e}px`):Math.abs(cr)>ju&&(lr.current=null)}},uo&&!f.jsx?Z.createElement("button",{"aria-label":U,"data-disabled":ai,"data-close-button":!0,onClick:ai||!cn?()=>{}:()=>{var Ce;lo(),(Ce=f.onDismiss)==null||Ce.call(f,f)},className:K(A==null?void 0:A.closeButton,(o=f==null?void 0:f.classNames)==null?void 0:o.closeButton)},Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Z.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Z.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,f.jsx||Z.isValidElement(f.title)?f.jsx||f.title:Z.createElement(Z.Fragment,null,Oe||f.icon||f.promise?Z.createElement("div",{"data-icon":"",className:K(A==null?void 0:A.icon,(i=f==null?void 0:f.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||WS():null,f.type!=="loading"?f.icon||(F==null?void 0:F[Oe])||WI(Oe):null):null,Z.createElement("div",{"data-content":"",className:K(A==null?void 0:A.content,(a=f==null?void 0:f.classNames)==null?void 0:a.content)},Z.createElement("div",{"data-title":"",className:K(A==null?void 0:A.title,(s=f==null?void 0:f.classNames)==null?void 0:s.title)},f.title),f.description?Z.createElement("div",{"data-description":"",className:K(P,ur,A==null?void 0:A.description,(u=f==null?void 0:f.classNames)==null?void 0:u.description)},f.description):null),Z.isValidElement(f.cancel)?f.cancel:f.cancel&&dl(f.cancel)?Z.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||k,onClick:Ce=>{var je,$e;dl(f.cancel)&&cn&&(($e=(je=f.cancel).onClick)==null||$e.call(je,Ce),lo())},className:K(A==null?void 0:A.cancelButton,(l=f==null?void 0:f.classNames)==null?void 0:l.cancelButton)},f.cancel.label):null,Z.isValidElement(f.action)?f.action:f.action&&dl(f.action)?Z.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||R,onClick:Ce=>{var je,$e;dl(f.action)&&(Ce.defaultPrevented||(($e=(je=f.action).onClick)==null||$e.call(je,Ce),lo()))},className:K(A==null?void 0:A.actionButton,(c=f==null?void 0:f.classNames)==null?void 0:c.actionButton)},f.action.label):null))};function Wy(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var Nz=e=>{let{invert:t,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:i,className:a,offset:s,theme:u="light",richColors:l,duration:c,style:d,visibleToasts:f=ZI,toastOptions:h,dir:v=Wy(),gap:p=rT,loadingIcon:g,icons:m,containerAriaLabel:y="Notifications",pauseWhenPageIsHidden:x,cn:w=aT}=e,[b,C]=Z.useState([]),S=Z.useMemo(()=>Array.from(new Set([n].concat(b.filter(j=>j.position).map(j=>j.position)))),[b,n]),[_,k]=Z.useState([]),[R,N]=Z.useState(!1),[P,L]=Z.useState(!1),[M,W]=Z.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),B=Z.useRef(null),z=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),A=Z.useRef(null),F=Z.useRef(!1),U=Z.useCallback(j=>{var K;(K=b.find(Y=>Y.id===j.id))!=null&&K.delete||pn.dismiss(j.id),C(Y=>Y.filter(({id:ne})=>ne!==j.id))},[b]);return Z.useEffect(()=>pn.subscribe(j=>{if(j.dismiss){C(K=>K.map(Y=>Y.id===j.id?{...Y,delete:!0}:Y));return}setTimeout(()=>{Vw.flushSync(()=>{C(K=>{let Y=K.findIndex(ne=>ne.id===j.id);return Y!==-1?[...K.slice(0,Y),{...K[Y],...j},...K.slice(Y+1)]:[j,...K]})})})}),[]),Z.useEffect(()=>{if(u!=="system"){W(u);return}u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?W("dark"):W("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:j})=>{W(j?"dark":"light")})},[u]),Z.useEffect(()=>{b.length<=1&&N(!1)},[b]),Z.useEffect(()=>{let j=K=>{var Y,ne;r.every(pe=>K[pe]||K.code===pe)&&(N(!0),(Y=B.current)==null||Y.focus()),K.code==="Escape"&&(document.activeElement===B.current||(ne=B.current)!=null&&ne.contains(document.activeElement))&&N(!1)};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[r]),Z.useEffect(()=>{if(B.current)return()=>{A.current&&(A.current.focus({preventScroll:!0}),A.current=null,F.current=!1)}},[B.current]),b.length?Z.createElement("section",{"aria-label":`${y} ${z}`,tabIndex:-1},S.map((j,K)=>{var Y;let[ne,pe]=j.split("-");return Z.createElement("ol",{key:j,dir:v==="auto"?Wy():v,tabIndex:-1,ref:B,className:a,"data-sonner-toaster":!0,"data-theme":M,"data-y-position":ne,"data-x-position":pe,style:{"--front-toast-height":`${((Y=_[0])==null?void 0:Y.height)||0}px`,"--offset":typeof s=="number"?`${s}px`:s||eT,"--width":`${nT}px`,"--gap":`${p}px`,...d},onBlur:te=>{F.current&&!te.currentTarget.contains(te.relatedTarget)&&(F.current=!1,A.current&&(A.current.focus({preventScroll:!0}),A.current=null))},onFocus:te=>{te.target instanceof HTMLElement&&te.target.dataset.dismissible==="false"||F.current||(F.current=!0,A.current=te.relatedTarget)},onMouseEnter:()=>N(!0),onMouseMove:()=>N(!0),onMouseLeave:()=>{P||N(!1)},onPointerDown:te=>{te.target instanceof HTMLElement&&te.target.dataset.dismissible==="false"||L(!0)},onPointerUp:()=>L(!1)},b.filter(te=>!te.position&&K===0||te.position===j).map((te,J)=>{var oe,ve;return Z.createElement(sT,{key:te.id,icons:m,index:J,toast:te,defaultRichColors:l,duration:(oe=h==null?void 0:h.duration)!=null?oe:c,className:h==null?void 0:h.className,descriptionClassName:h==null?void 0:h.descriptionClassName,invert:t,visibleToasts:f,closeButton:(ve=h==null?void 0:h.closeButton)!=null?ve:i,interacting:P,position:j,style:h==null?void 0:h.style,unstyled:h==null?void 0:h.unstyled,classNames:h==null?void 0:h.classNames,cancelButtonStyle:h==null?void 0:h.cancelButtonStyle,actionButtonStyle:h==null?void 0:h.actionButtonStyle,removeToast:U,toasts:b.filter(me=>me.position==te.position),heights:_.filter(me=>me.position==te.position),setHeights:k,expandByDefault:o,gap:p,loadingIcon:g,expanded:R,pauseWhenPageIsHidden:x,cn:w})}))})):null},uT=z1.useId||(()=>{}),lT=0;function Qv(e){const[t,n]=E.useState(uT());return mt(()=>{n(r=>r??String(lT++))},[e]),t?`radix-${t}`:""}const cT=["top","right","bottom","left"],Go=Math.min,gn=Math.max,xc=Math.round,fl=Math.floor,Ko=e=>({x:e,y:e}),dT={left:"right",right:"left",bottom:"top",top:"bottom"},fT={start:"end",end:"start"};function cp(e,t,n){return gn(e,Go(t,n))}function Jr(e,t){return typeof e=="function"?e(t):e}function Zr(e){return e.split("-")[0]}function is(e){return e.split("-")[1]}function Jv(e){return e==="x"?"y":"x"}function Zv(e){return e==="y"?"height":"width"}function qo(e){return["top","bottom"].includes(Zr(e))?"y":"x"}function em(e){return Jv(qo(e))}function hT(e,t,n){n===void 0&&(n=!1);const r=is(e),o=em(e),i=Zv(o);let a=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=wc(a)),[a,wc(a)]}function pT(e){const t=wc(e);return[dp(e),t,dp(t)]}function dp(e){return e.replace(/start|end/g,t=>fT[t])}function vT(e,t,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?i:a;default:return[]}}function mT(e,t,n,r){const o=is(e);let i=vT(Zr(e),n==="start",r);return o&&(i=i.map(a=>a+"-"+o),t&&(i=i.concat(i.map(dp)))),i}function wc(e){return e.replace(/left|right|bottom|top/g,t=>dT[t])}function gT(e){return{top:0,right:0,bottom:0,left:0,...e}}function mb(e){return typeof e!="number"?gT(e):{top:e,right:e,bottom:e,left:e}}function bc(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function zy(e,t,n){let{reference:r,floating:o}=e;const i=qo(t),a=em(t),s=Zv(a),u=Zr(t),l=i==="y",c=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(u){case"top":h={x:c,y:r.y-o.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(is(t)){case"start":h[a]-=f*(n&&l?-1:1);break;case"end":h[a]+=f*(n&&l?-1:1);break}return h}const yT=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(t));let l=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:c,y:d}=zy(l,r,u),f=r,h={},v=0;for(let p=0;p<s.length;p++){const{name:g,fn:m}=s[p],{x:y,y:x,data:w,reset:b}=await m({x:c,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:l,platform:a,elements:{reference:e,floating:t}});c=y??c,d=x??d,h={...h,[g]:{...h[g],...w}},b&&v<=50&&(v++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(l=b.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:o}):b.rects),{x:c,y:d}=zy(l,f,u)),p=-1)}return{x:c,y:d,placement:f,strategy:o,middlewareData:h}};async function su(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:u}=e,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Jr(t,e),v=mb(h),g=s[f?d==="floating"?"reference":"floating":d],m=bc(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(g)))==null||n?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:c,strategy:u})),y=d==="floating"?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),w=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},b=bc(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:x,strategy:u}):y);return{top:(m.top-b.top+v.top)/w.y,bottom:(b.bottom-m.bottom+v.bottom)/w.y,left:(m.left-b.left+v.left)/w.x,right:(b.right-m.right+v.right)/w.x}}const xT=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:a,elements:s,middlewareData:u}=t,{element:l,padding:c=0}=Jr(e,t)||{};if(l==null)return{};const d=mb(c),f={x:n,y:r},h=em(o),v=Zv(h),p=await a.getDimensions(l),g=h==="y",m=g?"top":"left",y=g?"bottom":"right",x=g?"clientHeight":"clientWidth",w=i.reference[v]+i.reference[h]-f[h]-i.floating[v],b=f[h]-i.reference[h],C=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l));let S=C?C[x]:0;(!S||!await(a.isElement==null?void 0:a.isElement(C)))&&(S=s.floating[x]||i.floating[v]);const _=w/2-b/2,k=S/2-p[v]/2-1,R=Go(d[m],k),N=Go(d[y],k),P=R,L=S-p[v]-N,M=S/2-p[v]/2+_,W=cp(P,M,L),B=!u.arrow&&is(o)!=null&&M!==W&&i.reference[v]/2-(M<P?R:N)-p[v]/2<0,z=B?M<P?M-P:M-L:0;return{[h]:f[h]+z,data:{[h]:W,centerOffset:M-W-z,...B&&{alignmentOffset:z}},reset:B}}}),wT=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:u,elements:l}=t,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:p=!0,...g}=Jr(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const m=Zr(o),y=qo(s),x=Zr(s)===s,w=await(u.isRTL==null?void 0:u.isRTL(l.floating)),b=f||(x||!p?[wc(s)]:pT(s)),C=v!=="none";!f&&C&&b.push(...mT(s,p,v,w));const S=[s,...b],_=await su(t,g),k=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&k.push(_[m]),d){const M=hT(o,a,w);k.push(_[M[0]],_[M[1]])}if(R=[...R,{placement:o,overflows:k}],!k.every(M=>M<=0)){var N,P;const M=(((N=i.flip)==null?void 0:N.index)||0)+1,W=S[M];if(W)return{data:{index:M,overflows:R},reset:{placement:W}};let B=(P=R.filter(z=>z.overflows[0]<=0).sort((z,A)=>z.overflows[1]-A.overflows[1])[0])==null?void 0:P.placement;if(!B)switch(h){case"bestFit":{var L;const z=(L=R.filter(A=>{if(C){const F=qo(A.placement);return F===y||F==="y"}return!0}).map(A=>[A.placement,A.overflows.filter(F=>F>0).reduce((F,U)=>F+U,0)]).sort((A,F)=>A[1]-F[1])[0])==null?void 0:L[0];z&&(B=z);break}case"initialPlacement":B=s;break}if(o!==B)return{reset:{placement:B}}}return{}}}};function $y(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Uy(e){return cT.some(t=>e[t]>=0)}const bT=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=Jr(e,t);switch(r){case"referenceHidden":{const i=await su(t,{...o,elementContext:"reference"}),a=$y(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:Uy(a)}}}case"escaped":{const i=await su(t,{...o,altBoundary:!0}),a=$y(i,n.floating);return{data:{escapedOffsets:a,escaped:Uy(a)}}}default:return{}}}}};async function CT(e,t){const{placement:n,platform:r,elements:o}=e,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),a=Zr(n),s=is(n),u=qo(n)==="y",l=["left","top"].includes(a)?-1:1,c=i&&u?-1:1,d=Jr(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof v=="number"&&(h=s==="end"?v*-1:v),u?{x:h*c,y:f*l}:{x:f*l,y:h*c}}const ET=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=t,u=await CT(t,e);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+u.x,y:i+u.y,data:{...u,placement:a}}}}},ST=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:g=>{let{x:m,y}=g;return{x:m,y}}},...u}=Jr(e,t),l={x:n,y:r},c=await su(t,u),d=qo(Zr(o)),f=Jv(d);let h=l[f],v=l[d];if(i){const g=f==="y"?"top":"left",m=f==="y"?"bottom":"right",y=h+c[g],x=h-c[m];h=cp(y,h,x)}if(a){const g=d==="y"?"top":"left",m=d==="y"?"bottom":"right",y=v+c[g],x=v-c[m];v=cp(y,v,x)}const p=s.fn({...t,[f]:h,[d]:v});return{...p,data:{x:p.x-n,y:p.y-r,enabled:{[f]:i,[d]:a}}}}}},_T=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:i,middlewareData:a}=t,{offset:s=0,mainAxis:u=!0,crossAxis:l=!0}=Jr(e,t),c={x:n,y:r},d=qo(o),f=Jv(d);let h=c[f],v=c[d];const p=Jr(s,t),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(u){const x=f==="y"?"height":"width",w=i.reference[f]-i.floating[x]+g.mainAxis,b=i.reference[f]+i.reference[x]-g.mainAxis;h<w?h=w:h>b&&(h=b)}if(l){var m,y;const x=f==="y"?"width":"height",w=["top","left"].includes(Zr(o)),b=i.reference[d]-i.floating[x]+(w&&((m=a.offset)==null?void 0:m[d])||0)+(w?0:g.crossAxis),C=i.reference[d]+i.reference[x]+(w?0:((y=a.offset)==null?void 0:y[d])||0)-(w?g.crossAxis:0);v<b?v=b:v>C&&(v=C)}return{[f]:h,[d]:v}}}},kT=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:i,platform:a,elements:s}=t,{apply:u=()=>{},...l}=Jr(e,t),c=await su(t,l),d=Zr(o),f=is(o),h=qo(o)==="y",{width:v,height:p}=i.floating;let g,m;d==="top"||d==="bottom"?(g=d,m=f===(await(a.isRTL==null?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(m=d,g=f==="end"?"top":"bottom");const y=p-c.top-c.bottom,x=v-c.left-c.right,w=Go(p-c[g],y),b=Go(v-c[m],x),C=!t.middlewareData.shift;let S=w,_=b;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(_=x),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(S=y),C&&!f){const R=gn(c.left,0),N=gn(c.right,0),P=gn(c.top,0),L=gn(c.bottom,0);h?_=v-2*(R!==0||N!==0?R+N:gn(c.left,c.right)):S=p-2*(P!==0||L!==0?P+L:gn(c.top,c.bottom))}await u({...t,availableWidth:_,availableHeight:S});const k=await a.getDimensions(s.floating);return v!==k.width||p!==k.height?{reset:{rects:!0}}:{}}}};function gd(){return typeof window<"u"}function as(e){return gb(e)?(e.nodeName||"").toLowerCase():"#document"}function Sn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Dr(e){var t;return(t=(gb(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function gb(e){return gd()?e instanceof Node||e instanceof Sn(e).Node:!1}function or(e){return gd()?e instanceof Element||e instanceof Sn(e).Element:!1}function Pr(e){return gd()?e instanceof HTMLElement||e instanceof Sn(e).HTMLElement:!1}function Vy(e){return!gd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Sn(e).ShadowRoot}function Tu(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=ir(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function RT(e){return["table","td","th"].includes(as(e))}function yd(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function tm(e){const t=nm(),n=or(e)?ir(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function IT(e){let t=Xo(e);for(;Pr(t)&&!Ka(t);){if(tm(t))return t;if(yd(t))return null;t=Xo(t)}return null}function nm(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ka(e){return["html","body","#document"].includes(as(e))}function ir(e){return Sn(e).getComputedStyle(e)}function xd(e){return or(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Xo(e){if(as(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Vy(e)&&e.host||Dr(e);return Vy(t)?t.host:t}function yb(e){const t=Xo(e);return Ka(t)?e.ownerDocument?e.ownerDocument.body:e.body:Pr(t)&&Tu(t)?t:yb(t)}function uu(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=yb(e),i=o===((r=e.ownerDocument)==null?void 0:r.body),a=Sn(o);if(i){const s=fp(a);return t.concat(a,a.visualViewport||[],Tu(o)?o:[],s&&n?uu(s):[])}return t.concat(o,uu(o,[],n))}function fp(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function xb(e){const t=ir(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Pr(e),i=o?e.offsetWidth:n,a=o?e.offsetHeight:r,s=xc(n)!==i||xc(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function rm(e){return or(e)?e:e.contextElement}function ba(e){const t=rm(e);if(!Pr(t))return Ko(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=xb(t);let a=(i?xc(n.width):n.width)/r,s=(i?xc(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const TT=Ko(0);function wb(e){const t=Sn(e);return!nm()||!t.visualViewport?TT:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function PT(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Sn(e)?!1:t}function Ai(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),i=rm(e);let a=Ko(1);t&&(r?or(r)&&(a=ba(r)):a=ba(e));const s=PT(i,n,r)?wb(i):Ko(0);let u=(o.left+s.x)/a.x,l=(o.top+s.y)/a.y,c=o.width/a.x,d=o.height/a.y;if(i){const f=Sn(i),h=r&&or(r)?Sn(r):r;let v=f,p=fp(v);for(;p&&r&&h!==v;){const g=ba(p),m=p.getBoundingClientRect(),y=ir(p),x=m.left+(p.clientLeft+parseFloat(y.paddingLeft))*g.x,w=m.top+(p.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,l*=g.y,c*=g.x,d*=g.y,u+=x,l+=w,v=Sn(p),p=fp(v)}}return bc({width:c,height:d,x:u,y:l})}function AT(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const i=o==="fixed",a=Dr(r),s=t?yd(t.floating):!1;if(r===a||s&&i)return n;let u={scrollLeft:0,scrollTop:0},l=Ko(1);const c=Ko(0),d=Pr(r);if((d||!d&&!i)&&((as(r)!=="body"||Tu(a))&&(u=xd(r)),Pr(r))){const f=Ai(r);l=ba(r),c.x=f.x+r.clientLeft,c.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-u.scrollLeft*l.x+c.x,y:n.y*l.y-u.scrollTop*l.y+c.y}}function NT(e){return Array.from(e.getClientRects())}function hp(e,t){const n=xd(e).scrollLeft;return t?t.left+n:Ai(Dr(e)).left+n}function DT(e){const t=Dr(e),n=xd(e),r=e.ownerDocument.body,o=gn(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=gn(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+hp(e);const s=-n.scrollTop;return ir(r).direction==="rtl"&&(a+=gn(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}function MT(e,t){const n=Sn(e),r=Dr(e),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,u=0;if(o){i=o.width,a=o.height;const l=nm();(!l||l&&t==="fixed")&&(s=o.offsetLeft,u=o.offsetTop)}return{width:i,height:a,x:s,y:u}}function FT(e,t){const n=Ai(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=Pr(e)?ba(e):Ko(1),a=e.clientWidth*i.x,s=e.clientHeight*i.y,u=o*i.x,l=r*i.y;return{width:a,height:s,x:u,y:l}}function jy(e,t,n){let r;if(t==="viewport")r=MT(e,n);else if(t==="document")r=DT(Dr(e));else if(or(t))r=FT(t,n);else{const o=wb(e);r={...t,x:t.x-o.x,y:t.y-o.y}}return bc(r)}function bb(e,t){const n=Xo(e);return n===t||!or(n)||Ka(n)?!1:ir(n).position==="fixed"||bb(n,t)}function OT(e,t){const n=t.get(e);if(n)return n;let r=uu(e,[],!1).filter(s=>or(s)&&as(s)!=="body"),o=null;const i=ir(e).position==="fixed";let a=i?Xo(e):e;for(;or(a)&&!Ka(a);){const s=ir(a),u=tm(a);!u&&s.position==="fixed"&&(o=null),(i?!u&&!o:!u&&s.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Tu(a)&&!u&&bb(e,a))?r=r.filter(c=>c!==a):o=s,a=Xo(a)}return t.set(e,r),r}function LT(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const a=[...n==="clippingAncestors"?yd(t)?[]:OT(t,this._c):[].concat(n),r],s=a[0],u=a.reduce((l,c)=>{const d=jy(t,c,o);return l.top=gn(d.top,l.top),l.right=Go(d.right,l.right),l.bottom=Go(d.bottom,l.bottom),l.left=gn(d.left,l.left),l},jy(t,s,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function BT(e){const{width:t,height:n}=xb(e);return{width:t,height:n}}function WT(e,t,n){const r=Pr(t),o=Dr(t),i=n==="fixed",a=Ai(e,!0,i,t);let s={scrollLeft:0,scrollTop:0};const u=Ko(0);if(r||!r&&!i)if((as(t)!=="body"||Tu(o))&&(s=xd(t)),r){const h=Ai(t,!0,i,t);u.x=h.x+t.clientLeft,u.y=h.y+t.clientTop}else o&&(u.x=hp(o));let l=0,c=0;if(o&&!r&&!i){const h=o.getBoundingClientRect();c=h.top+s.scrollTop,l=h.left+s.scrollLeft-hp(o,h)}const d=a.left+s.scrollLeft-u.x-l,f=a.top+s.scrollTop-u.y-c;return{x:d,y:f,width:a.width,height:a.height}}function If(e){return ir(e).position==="static"}function Hy(e,t){if(!Pr(e)||ir(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Dr(e)===n&&(n=n.ownerDocument.body),n}function Cb(e,t){const n=Sn(e);if(yd(e))return n;if(!Pr(e)){let o=Xo(e);for(;o&&!Ka(o);){if(or(o)&&!If(o))return o;o=Xo(o)}return n}let r=Hy(e,t);for(;r&&RT(r)&&If(r);)r=Hy(r,t);return r&&Ka(r)&&If(r)&&!tm(r)?n:r||IT(e)||n}const zT=async function(e){const t=this.getOffsetParent||Cb,n=this.getDimensions,r=await n(e.floating);return{reference:WT(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function $T(e){return ir(e).direction==="rtl"}const UT={convertOffsetParentRelativeRectToViewportRelativeRect:AT,getDocumentElement:Dr,getClippingRect:LT,getOffsetParent:Cb,getElementRects:zT,getClientRects:NT,getDimensions:BT,getScale:ba,isElement:or,isRTL:$T};function VT(e,t){let n=null,r;const o=Dr(e);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),i();const{left:l,top:c,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const h=fl(c),v=fl(o.clientWidth-(l+d)),p=fl(o.clientHeight-(c+f)),g=fl(l),y={rootMargin:-h+"px "+-v+"px "+-p+"px "+-g+"px",threshold:gn(0,Go(1,u))||1};let x=!0;function w(b){const C=b[0].intersectionRatio;if(C!==u){if(!x)return a();C?a(!1,C):r=setTimeout(()=>{a(!1,1e-7)},1e3)}x=!1}try{n=new IntersectionObserver(w,{...y,root:o.ownerDocument})}catch{n=new IntersectionObserver(w,y)}n.observe(e)}return a(!0),i}function jT(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,l=rm(e),c=o||i?[...l?uu(l):[],...uu(t)]:[];c.forEach(m=>{o&&m.addEventListener("scroll",n,{passive:!0}),i&&m.addEventListener("resize",n)});const d=l&&s?VT(l,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(m=>{let[y]=m;y&&y.target===l&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(t)})),n()}),l&&!u&&h.observe(l),h.observe(t));let v,p=u?Ai(e):null;u&&g();function g(){const m=Ai(e);p&&(m.x!==p.x||m.y!==p.y||m.width!==p.width||m.height!==p.height)&&n(),p=m,v=requestAnimationFrame(g)}return n(),()=>{var m;c.forEach(y=>{o&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),d==null||d(),(m=h)==null||m.disconnect(),h=null,u&&cancelAnimationFrame(v)}}const HT=ET,GT=ST,KT=wT,qT=kT,XT=bT,Gy=xT,YT=_T,QT=(e,t,n)=>{const r=new Map,o={platform:UT,...n},i={...o.platform,_c:r};return yT(e,t,{...o,platform:i})};var jl=typeof document<"u"?E.useLayoutEffect:E.useEffect;function Cc(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Cc(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&e.$$typeof)&&!Cc(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Eb(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Ky(e,t){const n=Eb(e);return Math.round(t*n)/n}function Tf(e){const t=E.useRef(e);return jl(()=>{t.current=e}),t}function JT(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:a}={},transform:s=!0,whileElementsMounted:u,open:l}=e,[c,d]=E.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=E.useState(r);Cc(f,r)||h(r);const[v,p]=E.useState(null),[g,m]=E.useState(null),y=E.useCallback(A=>{A!==C.current&&(C.current=A,p(A))},[]),x=E.useCallback(A=>{A!==S.current&&(S.current=A,m(A))},[]),w=i||v,b=a||g,C=E.useRef(null),S=E.useRef(null),_=E.useRef(c),k=u!=null,R=Tf(u),N=Tf(o),P=Tf(l),L=E.useCallback(()=>{if(!C.current||!S.current)return;const A={placement:t,strategy:n,middleware:f};N.current&&(A.platform=N.current),QT(C.current,S.current,A).then(F=>{const U={...F,isPositioned:P.current!==!1};M.current&&!Cc(_.current,U)&&(_.current=U,Oi.flushSync(()=>{d(U)}))})},[f,t,n,N,P]);jl(()=>{l===!1&&_.current.isPositioned&&(_.current.isPositioned=!1,d(A=>({...A,isPositioned:!1})))},[l]);const M=E.useRef(!1);jl(()=>(M.current=!0,()=>{M.current=!1}),[]),jl(()=>{if(w&&(C.current=w),b&&(S.current=b),w&&b){if(R.current)return R.current(w,b,L);L()}},[w,b,L,R,k]);const W=E.useMemo(()=>({reference:C,floating:S,setReference:y,setFloating:x}),[y,x]),B=E.useMemo(()=>({reference:w,floating:b}),[w,b]),z=E.useMemo(()=>{const A={position:n,left:0,top:0};if(!B.floating)return A;const F=Ky(B.floating,c.x),U=Ky(B.floating,c.y);return s?{...A,transform:"translate("+F+"px, "+U+"px)",...Eb(B.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:F,top:U}},[n,s,B.floating,c.x,c.y]);return E.useMemo(()=>({...c,update:L,refs:W,elements:B,floatingStyles:z}),[c,L,W,B,z])}const ZT=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Gy({element:r.current,padding:o}).fn(n):{}:r?Gy({element:r,padding:o}).fn(n):{}}}},eP=(e,t)=>({...HT(e),options:[e,t]}),tP=(e,t)=>({...GT(e),options:[e,t]}),nP=(e,t)=>({...YT(e),options:[e,t]}),rP=(e,t)=>({...KT(e),options:[e,t]}),oP=(e,t)=>({...qT(e),options:[e,t]}),iP=(e,t)=>({...XT(e),options:[e,t]}),aP=(e,t)=>({...ZT(e),options:[e,t]});var sP="Arrow",Sb=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...i}=e;return $.jsx(ke.svg,{...i,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:$.jsx("polygon",{points:"0,0 30,0 15,10"})})});Sb.displayName=sP;var uP=Sb;function lP(e,t=[]){let n=[];function r(i,a){const s=E.createContext(a),u=n.length;n=[...n,a];function l(d){const{scope:f,children:h,...v}=d,p=(f==null?void 0:f[e][u])||s,g=E.useMemo(()=>v,Object.values(v));return $.jsx(p.Provider,{value:g,children:h})}function c(d,f){const h=(f==null?void 0:f[e][u])||s,v=E.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return l.displayName=i+"Provider",[l,c]}const o=()=>{const i=n.map(a=>E.createContext(a));return function(s){const u=(s==null?void 0:s[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,cP(o,...t)]}function cP(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(i)[`__scope${l}`];return{...s,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function _b(e){const[t,n]=E.useState(void 0);return mt(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let a,s;if("borderBoxSize"in i){const u=i.borderBoxSize,l=Array.isArray(u)?u[0]:u;a=l.inlineSize,s=l.blockSize}else a=e.offsetWidth,s=e.offsetHeight;n({width:a,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var om="Popper",[kb,wd]=lP(om),[dP,Rb]=kb(om),Ib=e=>{const{__scopePopper:t,children:n}=e,[r,o]=E.useState(null);return $.jsx(dP,{scope:t,anchor:r,onAnchorChange:o,children:n})};Ib.displayName=om;var Tb="PopperAnchor",Pb=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,i=Rb(Tb,n),a=E.useRef(null),s=Me(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:$.jsx(ke.div,{...o,ref:s})});Pb.displayName=Tb;var im="PopperContent",[fP,hP]=kb(im),Ab=E.forwardRef((e,t)=>{var J,oe,ve,me,ie,le;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:a=0,arrowPadding:s=0,avoidCollisions:u=!0,collisionBoundary:l=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...p}=e,g=Rb(im,n),[m,y]=E.useState(null),x=Me(t,ye=>y(ye)),[w,b]=E.useState(null),C=_b(w),S=(C==null?void 0:C.width)??0,_=(C==null?void 0:C.height)??0,k=r+(i!=="center"?"-"+i:""),R=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},N=Array.isArray(l)?l:[l],P=N.length>0,L={padding:R,boundary:N.filter(vP),altBoundary:P},{refs:M,floatingStyles:W,placement:B,isPositioned:z,middlewareData:A}=JT({strategy:"fixed",placement:k,whileElementsMounted:(...ye)=>jT(...ye,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[eP({mainAxis:o+_,alignmentAxis:a}),u&&tP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?nP():void 0,...L}),u&&rP({...L}),oP({...L,apply:({elements:ye,rects:Pe,availableWidth:Fe,availableHeight:Ae})=>{const{width:wt,height:Yt}=Pe.reference,Oe=ye.floating.style;Oe.setProperty("--radix-popper-available-width",`${Fe}px`),Oe.setProperty("--radix-popper-available-height",`${Ae}px`),Oe.setProperty("--radix-popper-anchor-width",`${wt}px`),Oe.setProperty("--radix-popper-anchor-height",`${Yt}px`)}}),w&&aP({element:w,padding:s}),mP({arrowWidth:S,arrowHeight:_}),f&&iP({strategy:"referenceHidden",...L})]}),[F,U]=Mb(B),j=at(v);mt(()=>{z&&(j==null||j())},[z,j]);const K=(J=A.arrow)==null?void 0:J.x,Y=(oe=A.arrow)==null?void 0:oe.y,ne=((ve=A.arrow)==null?void 0:ve.centerOffset)!==0,[pe,te]=E.useState();return mt(()=>{m&&te(window.getComputedStyle(m).zIndex)},[m]),$.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:z?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:pe,"--radix-popper-transform-origin":[(me=A.transformOrigin)==null?void 0:me.x,(ie=A.transformOrigin)==null?void 0:ie.y].join(" "),...((le=A.hide)==null?void 0:le.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:$.jsx(fP,{scope:n,placedSide:F,onArrowChange:b,arrowX:K,arrowY:Y,shouldHideArrow:ne,children:$.jsx(ke.div,{"data-side":F,"data-align":U,...p,ref:x,style:{...p.style,animation:z?void 0:"none"}})})})});Ab.displayName=im;var Nb="PopperArrow",pP={top:"bottom",right:"left",bottom:"top",left:"right"},Db=E.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,i=hP(Nb,r),a=pP[i.placedSide];return $.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:$.jsx(uP,{...o,ref:n,style:{...o.style,display:"block"}})})});Db.displayName=Nb;function vP(e){return e!==null}var mP=e=>({name:"transformOrigin",options:e,fn(t){var g,m,y;const{placement:n,rects:r,middlewareData:o}=t,a=((g=o.arrow)==null?void 0:g.centerOffset)!==0,s=a?0:e.arrowWidth,u=a?0:e.arrowHeight,[l,c]=Mb(n),d={start:"0%",center:"50%",end:"100%"}[c],f=(((m=o.arrow)==null?void 0:m.x)??0)+s/2,h=(((y=o.arrow)==null?void 0:y.y)??0)+u/2;let v="",p="";return l==="bottom"?(v=a?d:`${f}px`,p=`${-u}px`):l==="top"?(v=a?d:`${f}px`,p=`${r.floating.height+u}px`):l==="right"?(v=`${-u}px`,p=a?d:`${h}px`):l==="left"&&(v=`${r.floating.width+u}px`,p=a?d:`${h}px`),{data:{x:v,y:p}}}});function Mb(e){const[t,n="center"]=e.split("-");return[t,n]}var gP=Ib,Fb=Pb,Ob=Ab,Lb=Db,[bd,Dz]=rs("Tooltip",[wd]),am=wd(),Bb="TooltipProvider",yP=700,qy="tooltip.open",[xP,Wb]=bd(Bb),zb=e=>{const{__scopeTooltip:t,delayDuration:n=yP,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=e,[a,s]=E.useState(!0),u=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),$.jsx(xP,{scope:t,isOpenDelayed:a,delayDuration:n,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:E.useCallback(c=>{u.current=c},[]),disableHoverableContent:o,children:i})};zb.displayName=Bb;var $b="Tooltip",[Mz,Cd]=bd($b),pp="TooltipTrigger",wP=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=Cd(pp,n),i=Wb(pp,n),a=am(n),s=E.useRef(null),u=Me(t,s,o.onTriggerChange),l=E.useRef(!1),c=E.useRef(!1),d=E.useCallback(()=>l.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),$.jsx(Fb,{asChild:!0,...a,children:$.jsx(ke.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:ge(e.onPointerMove,f=>{f.pointerType!=="touch"&&!c.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),c.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{o.onTriggerLeave(),c.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||o.onOpen()}),onBlur:ge(e.onBlur,o.onClose),onClick:ge(e.onClick,o.onClose)})})});wP.displayName=pp;var bP="TooltipPortal",[Fz,CP]=bd(bP,{forceMount:void 0}),qa="TooltipContent",Ub=E.forwardRef((e,t)=>{const n=CP(qa,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=e,a=Cd(qa,e.__scopeTooltip);return $.jsx(Li,{present:r||a.open,children:a.disableHoverableContent?$.jsx(Vb,{side:o,...i,ref:t}):$.jsx(EP,{side:o,...i,ref:t})})}),EP=E.forwardRef((e,t)=>{const n=Cd(qa,e.__scopeTooltip),r=Wb(qa,e.__scopeTooltip),o=E.useRef(null),i=Me(t,o),[a,s]=E.useState(null),{trigger:u,onClose:l}=n,c=o.current,{onPointerInTransitChange:d}=r,f=E.useCallback(()=>{s(null),d(!1)},[d]),h=E.useCallback((v,p)=>{const g=v.currentTarget,m={x:v.clientX,y:v.clientY},y=RP(m,g.getBoundingClientRect()),x=IP(m,y),w=TP(p.getBoundingClientRect()),b=AP([...x,...w]);s(b),d(!0)},[d]);return E.useEffect(()=>()=>f(),[f]),E.useEffect(()=>{if(u&&c){const v=g=>h(g,c),p=g=>h(g,u);return u.addEventListener("pointerleave",v),c.addEventListener("pointerleave",p),()=>{u.removeEventListener("pointerleave",v),c.removeEventListener("pointerleave",p)}}},[u,c,h,f]),E.useEffect(()=>{if(a){const v=p=>{const g=p.target,m={x:p.clientX,y:p.clientY},y=(u==null?void 0:u.contains(g))||(c==null?void 0:c.contains(g)),x=!PP(m,a);y?f():x&&(f(),l())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[u,c,a,l,f]),$.jsx(Vb,{...e,ref:i})}),[SP,_P]=bd($b,{isInside:!1}),Vb=E.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:a,...s}=e,u=Cd(qa,n),l=am(n),{onClose:c}=u;return E.useEffect(()=>(document.addEventListener(qy,c),()=>document.removeEventListener(qy,c)),[c]),E.useEffect(()=>{if(u.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(u.trigger)&&c()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,c]),$.jsx(pd,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:c,children:$.jsxs(Ob,{"data-state":u.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[$.jsx(Hw,{children:r}),$.jsx(SP,{scope:n,isInside:!0,children:$.jsx(LR,{id:u.contentId,role:"tooltip",children:o||r})})]})})});Ub.displayName=qa;var jb="TooltipArrow",kP=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=am(n);return _P(jb,n).isInside?null:$.jsx(Lb,{...o,...r,ref:t})});kP.displayName=jb;function RP(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function IP(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function TP(e){const{top:t,right:n,bottom:r,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:r},{x:o,y:r}]}function PP(e,t){const{x:n,y:r}=e;let o=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const s=t[i].x,u=t[i].y,l=t[a].x,c=t[a].y;u>r!=c>r&&n<(l-s)*(r-u)/(c-u)+s&&(o=!o)}return o}function AP(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),NP(t)}function NP(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var Oz=zb,Lz=Ub,Ed=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Sd=typeof window>"u"||"Deno"in globalThis;function qn(){}function DP(e,t){return typeof e=="function"?e(t):e}function MP(e){return typeof e=="number"&&e>=0&&e!==1/0}function FP(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Xy(e,t){return typeof e=="function"?e(t):e}function OP(e,t){return typeof e=="function"?e(t):e}function Yy(e,t){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:s}=e;if(a){if(r){if(t.queryHash!==sm(a,t.options))return!1}else if(!cu(t.queryKey,a))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof s=="boolean"&&t.isStale()!==s||o&&o!==t.state.fetchStatus||i&&!i(t))}function Qy(e,t){const{exact:n,status:r,predicate:o,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(lu(t.options.mutationKey)!==lu(i))return!1}else if(!cu(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||o&&!o(t))}function sm(e,t){return((t==null?void 0:t.queryKeyHashFn)||lu)(e)}function lu(e){return JSON.stringify(e,(t,n)=>vp(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function cu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!cu(e[n],t[n])):!1}function Hb(e,t){if(e===t)return e;const n=Jy(e)&&Jy(t);if(n||vp(e)&&vp(t)){const r=n?e:Object.keys(e),o=r.length,i=n?t:Object.keys(t),a=i.length,s=n?[]:{};let u=0;for(let l=0;l<a;l++){const c=n?l:i[l];(!n&&r.includes(c)||n)&&e[c]===void 0&&t[c]===void 0?(s[c]=void 0,u++):(s[c]=Hb(e[c],t[c]),s[c]===e[c]&&e[c]!==void 0&&u++)}return o===a&&u===o?e:s}return t}function Jy(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function vp(e){if(!Zy(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Zy(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Zy(e){return Object.prototype.toString.call(e)==="[object Object]"}function LP(e){return new Promise(t=>{setTimeout(t,e)})}function BP(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Hb(e,t):t}function WP(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function zP(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var um=Symbol();function Gb(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===um?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var yi,Co,Aa,b1,$P=(b1=class extends Ed{constructor(){super();Be(this,yi);Be(this,Co);Be(this,Aa);_e(this,Aa,t=>{if(!Sd&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){q(this,Co)||this.setEventListener(q(this,Aa))}onUnsubscribe(){var t;this.hasListeners()||((t=q(this,Co))==null||t.call(this),_e(this,Co,void 0))}setEventListener(t){var n;_e(this,Aa,t),(n=q(this,Co))==null||n.call(this),_e(this,Co,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){q(this,yi)!==t&&(_e(this,yi,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof q(this,yi)=="boolean"?q(this,yi):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},yi=new WeakMap,Co=new WeakMap,Aa=new WeakMap,b1),Kb=new $P,Na,Eo,Da,C1,UP=(C1=class extends Ed{constructor(){super();Be(this,Na,!0);Be(this,Eo);Be(this,Da);_e(this,Da,t=>{if(!Sd&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){q(this,Eo)||this.setEventListener(q(this,Da))}onUnsubscribe(){var t;this.hasListeners()||((t=q(this,Eo))==null||t.call(this),_e(this,Eo,void 0))}setEventListener(t){var n;_e(this,Da,t),(n=q(this,Eo))==null||n.call(this),_e(this,Eo,t(this.setOnline.bind(this)))}setOnline(t){q(this,Na)!==t&&(_e(this,Na,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return q(this,Na)}},Na=new WeakMap,Eo=new WeakMap,Da=new WeakMap,C1),Ec=new UP;function VP(){let e,t;const n=new Promise((o,i)=>{e=o,t=i});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),e(o)},n.reject=o=>{r({status:"rejected",reason:o}),t(o)},n}function jP(e){return Math.min(1e3*2**e,3e4)}function qb(e){return(e??"online")==="online"?Ec.isOnline():!0}var Xb=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Pf(e){return e instanceof Xb}function Yb(e){let t=!1,n=0,r=!1,o;const i=VP(),a=p=>{var g;r||(f(new Xb(p)),(g=e.abort)==null||g.call(e))},s=()=>{t=!0},u=()=>{t=!1},l=()=>Kb.isFocused()&&(e.networkMode==="always"||Ec.isOnline())&&e.canRun(),c=()=>qb(e.networkMode)&&e.canRun(),d=p=>{var g;r||(r=!0,(g=e.onSuccess)==null||g.call(e,p),o==null||o(),i.resolve(p))},f=p=>{var g;r||(r=!0,(g=e.onError)==null||g.call(e,p),o==null||o(),i.reject(p))},h=()=>new Promise(p=>{var g;o=m=>{(r||l())&&p(m)},(g=e.onPause)==null||g.call(e)}).then(()=>{var p;o=void 0,r||(p=e.onContinue)==null||p.call(e)}),v=()=>{if(r)return;let p;const g=n===0?e.initialPromise:void 0;try{p=g??e.fn()}catch(m){p=Promise.reject(m)}Promise.resolve(p).then(d).catch(m=>{var C;if(r)return;const y=e.retry??(Sd?0:3),x=e.retryDelay??jP,w=typeof x=="function"?x(n,m):x,b=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,m);if(t||!b){f(m);return}n++,(C=e.onFail)==null||C.call(e,n,m),LP(w).then(()=>l()?void 0:h()).then(()=>{t?f(m):v()})})};return{promise:i,cancel:a,continue:()=>(o==null||o(),i),cancelRetry:s,continueRetry:u,canStart:c,start:()=>(c()?v():h().then(v),i)}}function HP(){let e=[],t=0,n=s=>{s()},r=s=>{s()},o=s=>setTimeout(s,0);const i=s=>{t?e.push(s):o(()=>{n(s)})},a=()=>{const s=e;e=[],s.length&&o(()=>{r(()=>{s.forEach(u=>{n(u)})})})};return{batch:s=>{let u;t++;try{u=s()}finally{t--,t||a()}return u},batchCalls:s=>(...u)=>{i(()=>{s(...u)})},schedule:i,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var Gt=HP(),xi,E1,Qb=(E1=class{constructor(){Be(this,xi)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),MP(this.gcTime)&&_e(this,xi,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Sd?1/0:5*60*1e3))}clearGcTimeout(){q(this,xi)&&(clearTimeout(q(this,xi)),_e(this,xi,void 0))}},xi=new WeakMap,E1),Ma,Fa,An,Ft,bu,wi,Xn,zr,S1,GP=(S1=class extends Qb{constructor(t){super();Be(this,Xn);Be(this,Ma);Be(this,Fa);Be(this,An);Be(this,Ft);Be(this,bu);Be(this,wi);_e(this,wi,!1),_e(this,bu,t.defaultOptions),this.setOptions(t.options),this.observers=[],_e(this,An,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,_e(this,Ma,qP(this.options)),this.state=t.state??q(this,Ma),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=q(this,Ft))==null?void 0:t.promise}setOptions(t){this.options={...q(this,bu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&q(this,An).remove(this)}setData(t,n){const r=BP(this.state.data,t,this.options);return Nt(this,Xn,zr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Nt(this,Xn,zr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,o;const n=(r=q(this,Ft))==null?void 0:r.promise;return(o=q(this,Ft))==null||o.cancel(t),n?n.then(qn).catch(qn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(q(this,Ma))}isActive(){return this.observers.some(t=>OP(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===um||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!FP(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=q(this,Ft))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=q(this,Ft))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),q(this,An).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(q(this,Ft)&&(q(this,wi)?q(this,Ft).cancel({revert:!0}):q(this,Ft).cancelRetry()),this.scheduleGc()),q(this,An).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nt(this,Xn,zr).call(this,{type:"invalidate"})}fetch(t,n){var u,l,c;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(q(this,Ft))return q(this,Ft).continueRetry(),q(this,Ft).promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(f=>f.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,o=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(_e(this,wi,!0),r.signal)})},i=()=>{const d=Gb(this.options,n),f={queryKey:this.queryKey,meta:this.meta};return o(f),_e(this,wi,!1),this.options.persister?this.options.persister(d,f,this):d(f)},a={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};o(a),(u=this.options.behavior)==null||u.onFetch(a,this),_e(this,Fa,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((l=a.fetchOptions)==null?void 0:l.meta))&&Nt(this,Xn,zr).call(this,{type:"fetch",meta:(c=a.fetchOptions)==null?void 0:c.meta});const s=d=>{var f,h,v,p;Pf(d)&&d.silent||Nt(this,Xn,zr).call(this,{type:"error",error:d}),Pf(d)||((h=(f=q(this,An).config).onError)==null||h.call(f,d,this),(p=(v=q(this,An).config).onSettled)==null||p.call(v,this.state.data,d,this)),this.scheduleGc()};return _e(this,Ft,Yb({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var f,h,v,p;if(d===void 0){s(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(g){s(g);return}(h=(f=q(this,An).config).onSuccess)==null||h.call(f,d,this),(p=(v=q(this,An).config).onSettled)==null||p.call(v,d,this.state.error,this),this.scheduleGc()},onError:s,onFail:(d,f)=>{Nt(this,Xn,zr).call(this,{type:"failed",failureCount:d,error:f})},onPause:()=>{Nt(this,Xn,zr).call(this,{type:"pause"})},onContinue:()=>{Nt(this,Xn,zr).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),q(this,Ft).start()}},Ma=new WeakMap,Fa=new WeakMap,An=new WeakMap,Ft=new WeakMap,bu=new WeakMap,wi=new WeakMap,Xn=new WeakSet,zr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...KP(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return Pf(o)&&o.revert&&q(this,Fa)?{...q(this,Fa),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Gt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),q(this,An).notify({query:this,type:"updated",action:t})})},S1);function KP(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:qb(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function qP(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var mr,_1,XP=(_1=class extends Ed{constructor(t={}){super();Be(this,mr);this.config=t,_e(this,mr,new Map)}build(t,n,r){const o=n.queryKey,i=n.queryHash??sm(o,n);let a=this.get(i);return a||(a=new GP({cache:this,queryKey:o,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(o)}),this.add(a)),a}add(t){q(this,mr).has(t.queryHash)||(q(this,mr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=q(this,mr).get(t.queryHash);n&&(t.destroy(),n===t&&q(this,mr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Gt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return q(this,mr).get(t)}getAll(){return[...q(this,mr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Yy(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Yy(t,r)):n}notify(t){Gt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Gt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Gt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},mr=new WeakMap,_1),gr,jt,bi,yr,mo,k1,YP=(k1=class extends Qb{constructor(t){super();Be(this,yr);Be(this,gr);Be(this,jt);Be(this,bi);this.mutationId=t.mutationId,_e(this,jt,t.mutationCache),_e(this,gr,[]),this.state=t.state||QP(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){q(this,gr).includes(t)||(q(this,gr).push(t),this.clearGcTimeout(),q(this,jt).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){_e(this,gr,q(this,gr).filter(n=>n!==t)),this.scheduleGc(),q(this,jt).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){q(this,gr).length||(this.state.status==="pending"?this.scheduleGc():q(this,jt).remove(this))}continue(){var t;return((t=q(this,bi))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,i,a,s,u,l,c,d,f,h,v,p,g,m,y,x,w,b,C,S;_e(this,bi,Yb({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(_,k)=>{Nt(this,yr,mo).call(this,{type:"failed",failureCount:_,error:k})},onPause:()=>{Nt(this,yr,mo).call(this,{type:"pause"})},onContinue:()=>{Nt(this,yr,mo).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>q(this,jt).canRun(this)}));const n=this.state.status==="pending",r=!q(this,bi).canStart();try{if(!n){Nt(this,yr,mo).call(this,{type:"pending",variables:t,isPaused:r}),await((i=(o=q(this,jt).config).onMutate)==null?void 0:i.call(o,t,this));const k=await((s=(a=this.options).onMutate)==null?void 0:s.call(a,t));k!==this.state.context&&Nt(this,yr,mo).call(this,{type:"pending",context:k,variables:t,isPaused:r})}const _=await q(this,bi).start();return await((l=(u=q(this,jt).config).onSuccess)==null?void 0:l.call(u,_,t,this.state.context,this)),await((d=(c=this.options).onSuccess)==null?void 0:d.call(c,_,t,this.state.context)),await((h=(f=q(this,jt).config).onSettled)==null?void 0:h.call(f,_,null,this.state.variables,this.state.context,this)),await((p=(v=this.options).onSettled)==null?void 0:p.call(v,_,null,t,this.state.context)),Nt(this,yr,mo).call(this,{type:"success",data:_}),_}catch(_){try{throw await((m=(g=q(this,jt).config).onError)==null?void 0:m.call(g,_,t,this.state.context,this)),await((x=(y=this.options).onError)==null?void 0:x.call(y,_,t,this.state.context)),await((b=(w=q(this,jt).config).onSettled)==null?void 0:b.call(w,void 0,_,this.state.variables,this.state.context,this)),await((S=(C=this.options).onSettled)==null?void 0:S.call(C,void 0,_,t,this.state.context)),_}finally{Nt(this,yr,mo).call(this,{type:"error",error:_})}}finally{q(this,jt).runNext(this)}}},gr=new WeakMap,jt=new WeakMap,bi=new WeakMap,yr=new WeakSet,mo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Gt.batch(()=>{q(this,gr).forEach(r=>{r.onMutationUpdate(t)}),q(this,jt).notify({mutation:this,type:"updated",action:t})})},k1);function QP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var hn,Cu,R1,JP=(R1=class extends Ed{constructor(t={}){super();Be(this,hn);Be(this,Cu);this.config=t,_e(this,hn,new Map),_e(this,Cu,Date.now())}build(t,n,r){const o=new YP({mutationCache:this,mutationId:++Hu(this,Cu)._,options:t.defaultMutationOptions(n),state:r});return this.add(o),o}add(t){const n=hl(t),r=q(this,hn).get(n)??[];r.push(t),q(this,hn).set(n,r),this.notify({type:"added",mutation:t})}remove(t){var r;const n=hl(t);if(q(this,hn).has(n)){const o=(r=q(this,hn).get(n))==null?void 0:r.filter(i=>i!==t);o&&(o.length===0?q(this,hn).delete(n):q(this,hn).set(n,o))}this.notify({type:"removed",mutation:t})}canRun(t){var r;const n=(r=q(this,hn).get(hl(t)))==null?void 0:r.find(o=>o.state.status==="pending");return!n||n===t}runNext(t){var r;const n=(r=q(this,hn).get(hl(t)))==null?void 0:r.find(o=>o!==t&&o.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Gt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...q(this,hn).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Qy(n,r))}findAll(t={}){return this.getAll().filter(n=>Qy(t,n))}notify(t){Gt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Gt.batch(()=>Promise.all(t.map(n=>n.continue().catch(qn))))}},hn=new WeakMap,Cu=new WeakMap,R1);function hl(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function e0(e){return{onFetch:(t,n)=>{var c,d,f,h,v;const r=t.options,o=(f=(d=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=t.state.data)==null?void 0:h.pages)||[],a=((v=t.state.data)==null?void 0:v.pageParams)||[];let s={pages:[],pageParams:[]},u=0;const l=async()=>{let p=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},m=Gb(t.options,t.fetchOptions),y=async(x,w,b)=>{if(p)return Promise.reject();if(w==null&&x.pages.length)return Promise.resolve(x);const C={queryKey:t.queryKey,pageParam:w,direction:b?"backward":"forward",meta:t.options.meta};g(C);const S=await m(C),{maxPages:_}=t.options,k=b?zP:WP;return{pages:k(x.pages,S,_),pageParams:k(x.pageParams,w,_)}};if(o&&i.length){const x=o==="backward",w=x?ZP:t0,b={pages:i,pageParams:a},C=w(r,b);s=await y(b,C,x)}else{const x=e??i.length;do{const w=u===0?a[0]??r.initialPageParam:t0(r,s);if(u>0&&w==null)break;s=await y(s,w),u++}while(u<x)}return s};t.options.persister?t.fetchFn=()=>{var p,g;return(g=(p=t.options).persister)==null?void 0:g.call(p,l,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=l}}}function t0(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function ZP(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var rt,So,_o,Oa,La,ko,Ba,Wa,I1,Bz=(I1=class{constructor(e={}){Be(this,rt);Be(this,So);Be(this,_o);Be(this,Oa);Be(this,La);Be(this,ko);Be(this,Ba);Be(this,Wa);_e(this,rt,e.queryCache||new XP),_e(this,So,e.mutationCache||new JP),_e(this,_o,e.defaultOptions||{}),_e(this,Oa,new Map),_e(this,La,new Map),_e(this,ko,0)}mount(){Hu(this,ko)._++,q(this,ko)===1&&(_e(this,Ba,Kb.subscribe(async e=>{e&&(await this.resumePausedMutations(),q(this,rt).onFocus())})),_e(this,Wa,Ec.subscribe(async e=>{e&&(await this.resumePausedMutations(),q(this,rt).onOnline())})))}unmount(){var e,t;Hu(this,ko)._--,q(this,ko)===0&&((e=q(this,Ba))==null||e.call(this),_e(this,Ba,void 0),(t=q(this,Wa))==null||t.call(this),_e(this,Wa,void 0))}isFetching(e){return q(this,rt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return q(this,So).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=q(this,rt).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),r=q(this,rt).build(this,n);return e.revalidateIfStale&&r.isStaleByTime(Xy(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return q(this,rt).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),o=q(this,rt).get(r.queryHash),i=o==null?void 0:o.state.data,a=DP(t,i);if(a!==void 0)return q(this,rt).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(e,t,n){return Gt.batch(()=>q(this,rt).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=q(this,rt).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=q(this,rt);Gt.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=q(this,rt),r={type:"active",...e};return Gt.batch(()=>(n.findAll(e).forEach(o=>{o.reset()}),this.refetchQueries(r,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},r=Gt.batch(()=>q(this,rt).findAll(e).map(o=>o.cancel(n)));return Promise.all(r).then(qn).catch(qn)}invalidateQueries(e={},t={}){return Gt.batch(()=>{if(q(this,rt).findAll(e).forEach(r=>{r.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},r=Gt.batch(()=>q(this,rt).findAll(e).filter(o=>!o.isDisabled()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(qn)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(qn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=q(this,rt).build(this,t);return n.isStaleByTime(Xy(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(qn).catch(qn)}fetchInfiniteQuery(e){return e.behavior=e0(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(qn).catch(qn)}ensureInfiniteQueryData(e){return e.behavior=e0(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ec.isOnline()?q(this,So).resumePausedMutations():Promise.resolve()}getQueryCache(){return q(this,rt)}getMutationCache(){return q(this,So)}getDefaultOptions(){return q(this,_o)}setDefaultOptions(e){_e(this,_o,e)}setQueryDefaults(e,t){q(this,Oa).set(lu(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...q(this,Oa).values()];let n={};return t.forEach(r=>{cu(e,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(e,t){q(this,La).set(lu(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...q(this,La).values()];let n={};return t.forEach(r=>{cu(e,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...q(this,_o).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=sm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===um&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...q(this,_o).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){q(this,rt).clear(),q(this,So).clear()}},rt=new WeakMap,So=new WeakMap,_o=new WeakMap,Oa=new WeakMap,La=new WeakMap,ko=new WeakMap,Ba=new WeakMap,Wa=new WeakMap,I1),eA=E.createContext(void 0),Wz=({client:e,children:t})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),$.jsx(eA.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sc(){return Sc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sc.apply(this,arguments)}var To;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(To||(To={}));const n0="popstate";function tA(e){e===void 0&&(e={});function t(o,i){let{pathname:a="/",search:s="",hash:u=""}=Pu(o.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),mp("",{pathname:a,search:s,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(o,i){let a=o.document.querySelector("base"),s="";if(a&&a.getAttribute("href")){let u=o.location.href,l=u.indexOf("#");s=l===-1?u:u.slice(0,l)}return s+"#"+(typeof i=="string"?i:Jb(i))}function r(o,i){lm(o.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return rA(t,n,r,e)}function sn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function lm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function nA(){return Math.random().toString(36).substr(2,8)}function r0(e,t){return{usr:e.state,key:e.key,idx:t}}function mp(e,t,n,r){return n===void 0&&(n=null),Sc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Pu(t):t,{state:n,key:t&&t.key||r||nA()})}function Jb(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Pu(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function rA(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=To.Pop,u=null,l=c();l==null&&(l=0,a.replaceState(Sc({},a.state,{idx:l}),""));function c(){return(a.state||{idx:null}).idx}function d(){s=To.Pop;let g=c(),m=g==null?null:g-l;l=g,u&&u({action:s,location:p.location,delta:m})}function f(g,m){s=To.Push;let y=mp(p.location,g,m);n&&n(y,g),l=c()+1;let x=r0(y,l),w=p.createHref(y);try{a.pushState(x,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;o.location.assign(w)}i&&u&&u({action:s,location:p.location,delta:1})}function h(g,m){s=To.Replace;let y=mp(p.location,g,m);n&&n(y,g),l=c();let x=r0(y,l),w=p.createHref(y);a.replaceState(x,"",w),i&&u&&u({action:s,location:p.location,delta:0})}function v(g){let m=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:Jb(g);return y=y.replace(/ $/,"%20"),sn(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let p={get action(){return s},get location(){return e(o,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(n0,d),u=g,()=>{o.removeEventListener(n0,d),u=null}},createHref(g){return t(o,g)},createURL:v,encodeLocation(g){let m=v(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:h,go(g){return a.go(g)}};return p}var o0;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(o0||(o0={}));function oA(e,t,n){return n===void 0&&(n="/"),iA(e,t,n,!1)}function iA(e,t,n,r){let o=typeof t=="string"?Pu(t):t,i=t2(o.pathname||"/",n);if(i==null)return null;let a=Zb(e);aA(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let l=gA(i);s=vA(a[u],l,r)}return s}function Zb(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(sn(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=Ca([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(sn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),Zb(i.children,t,c,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:hA(l,i.index),routesMeta:c})};return e.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of e2(i.path))o(i,a,u)}),t}function e2(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=e2(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>e.startsWith("/")&&u===""?"/":u)}function aA(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:pA(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const sA=/^:[\w-]+$/,uA=3,lA=2,cA=1,dA=10,fA=-2,i0=e=>e==="*";function hA(e,t){let n=e.split("/"),r=n.length;return n.some(i0)&&(r+=fA),t&&(r+=lA),n.filter(o=>!i0(o)).reduce((o,i)=>o+(sA.test(i)?uA:i===""?cA:dA),r)}function pA(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function vA(e,t,n){let{routesMeta:r}=e,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",d=a0({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=a0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:Ca([i,d.pathname]),pathnameBase:yA(Ca([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=Ca([i,d.pathnameBase]))}return a}function a0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=mA(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let p=s[d]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const v=s[d];return h&&!v?l[f]=void 0:l[f]=(v||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:e}}function mA(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),lm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function gA(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return lm(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function t2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const Ca=e=>e.join("/").replace(/\/\/+/g,"/"),yA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function xA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const n2=["post","put","patch","delete"];new Set(n2);const wA=["get",...n2];new Set(wA);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _c(){return _c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_c.apply(this,arguments)}const bA=E.createContext(null),CA=E.createContext(null),r2=E.createContext(null),_d=E.createContext(null),kd=E.createContext({outlet:null,matches:[],isDataRoute:!1}),o2=E.createContext(null);function cm(){return E.useContext(_d)!=null}function EA(){return cm()||sn(!1),E.useContext(_d).location}function SA(e,t){return _A(e,t)}function _A(e,t,n,r){cm()||sn(!1);let{navigator:o}=E.useContext(r2),{matches:i}=E.useContext(kd),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let l=EA(),c;if(t){var d;let g=typeof t=="string"?Pu(t):t;u==="/"||(d=g.pathname)!=null&&d.startsWith(u)||sn(!1),c=g}else c=l;let f=c.pathname||"/",h=f;if(u!=="/"){let g=u.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let v=oA(e,{pathname:h}),p=PA(v&&v.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:Ca([u,o.encodeLocation?o.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:Ca([u,o.encodeLocation?o.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r);return t&&p?E.createElement(_d.Provider,{value:{location:_c({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:To.Pop}},p):p}function kA(){let e=MA(),t=xA(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),n?E.createElement("pre",{style:o},n):null,null)}const RA=E.createElement(kA,null);class IA extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?E.createElement(kd.Provider,{value:this.props.routeContext},E.createElement(o2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function TA(e){let{routeContext:t,match:n,children:r}=e,o=E.useContext(bA);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),E.createElement(kd.Provider,{value:t},r)}function PA(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);c>=0||sn(!1),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:f,errors:h}=n,v=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||v){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,d,f)=>{let h,v=!1,p=null,g=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,p=d.route.errorElement||RA,u&&(l<0&&f===0?(v=!0,g=null):l===f&&(v=!0,g=d.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,f+1)),y=()=>{let x;return h?x=p:v?x=g:d.route.Component?x=E.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=c,E.createElement(TA,{match:d,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:x})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?E.createElement(IA,{location:n.location,revalidation:n.revalidation,component:p,error:h,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):y()},null)}var gp=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(gp||{});function AA(e){let t=E.useContext(CA);return t||sn(!1),t}function NA(e){let t=E.useContext(kd);return t||sn(!1),t}function DA(e){let t=NA(),n=t.matches[t.matches.length-1];return n.route.id||sn(!1),n.route.id}function MA(){var e;let t=E.useContext(o2),n=AA(gp.UseRouteError),r=DA(gp.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function FA(e){sn(!1)}function OA(e){let{basename:t="/",children:n=null,location:r,navigationType:o=To.Pop,navigator:i,static:a=!1,future:s}=e;cm()&&sn(!1);let u=t.replace(/^\/*/,"/"),l=E.useMemo(()=>({basename:u,navigator:i,static:a,future:_c({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=Pu(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:v="default"}=r,p=E.useMemo(()=>{let g=t2(c,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:v},navigationType:o}},[u,c,d,f,h,v,o]);return p==null?null:E.createElement(r2.Provider,{value:l},E.createElement(_d.Provider,{children:n,value:p}))}function zz(e){let{children:t,location:n}=e;return SA(yp(t),n)}new Promise(()=>{});function yp(e,t){t===void 0&&(t=[]);let n=[];return E.Children.forEach(e,(r,o)=>{if(!E.isValidElement(r))return;let i=[...t,o];if(r.type===E.Fragment){n.push.apply(n,yp(r.props.children,i));return}r.type!==FA&&sn(!1),!r.props.index||!r.props.children||sn(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=yp(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const LA="6";try{window.__reactRouterVersion=LA}catch{}const BA="startTransition",s0=z1[BA];function $z(e){let{basename:t,children:n,future:r,window:o}=e,i=E.useRef();i.current==null&&(i.current=tA({window:o,v5Compat:!0}));let a=i.current,[s,u]=E.useState({action:a.action,location:a.location}),{v7_startTransition:l}=r||{},c=E.useCallback(d=>{l&&s0?s0(()=>u(d)):u(d)},[u,l]);return E.useLayoutEffect(()=>a.listen(c),[a,c]),E.createElement(OA,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}var u0;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(u0||(u0={}));var l0;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(l0||(l0={}));function du(e,[t,n]){return Math.min(n,Math.max(t,e))}var WA=E.createContext(void 0);function dm(e){const t=E.useContext(WA);return e||t||"ltr"}var Af=0;function zA(){E.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??c0()),document.body.insertAdjacentElement("beforeend",e[1]??c0()),Af++,()=>{Af===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Af--}},[])}function c0(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Nf="focusScope.autoFocusOnMount",Df="focusScope.autoFocusOnUnmount",d0={bubbles:!1,cancelable:!0},$A="FocusScope",i2=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...a}=e,[s,u]=E.useState(null),l=at(o),c=at(i),d=E.useRef(null),f=Me(t,p=>u(p)),h=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let p=function(x){if(h.paused||!s)return;const w=x.target;s.contains(w)?d.current=w:go(d.current,{select:!0})},g=function(x){if(h.paused||!s)return;const w=x.relatedTarget;w!==null&&(s.contains(w)||go(d.current,{select:!0}))},m=function(x){if(document.activeElement===document.body)for(const b of x)b.removedNodes.length>0&&go(s)};document.addEventListener("focusin",p),document.addEventListener("focusout",g);const y=new MutationObserver(m);return s&&y.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",g),y.disconnect()}}},[r,s,h.paused]),E.useEffect(()=>{if(s){h0.add(h);const p=document.activeElement;if(!s.contains(p)){const m=new CustomEvent(Nf,d0);s.addEventListener(Nf,l),s.dispatchEvent(m),m.defaultPrevented||(UA(KA(a2(s)),{select:!0}),document.activeElement===p&&go(s))}return()=>{s.removeEventListener(Nf,l),setTimeout(()=>{const m=new CustomEvent(Df,d0);s.addEventListener(Df,c),s.dispatchEvent(m),m.defaultPrevented||go(p??document.body,{select:!0}),s.removeEventListener(Df,c),h0.remove(h)},0)}}},[s,l,c,h]);const v=E.useCallback(p=>{if(!n&&!r||h.paused)return;const g=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,m=document.activeElement;if(g&&m){const y=p.currentTarget,[x,w]=VA(y);x&&w?!p.shiftKey&&m===w?(p.preventDefault(),n&&go(x,{select:!0})):p.shiftKey&&m===x&&(p.preventDefault(),n&&go(w,{select:!0})):m===y&&p.preventDefault()}},[n,r,h.paused]);return $.jsx(ke.div,{tabIndex:-1,...a,ref:f,onKeyDown:v})});i2.displayName=$A;function UA(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(go(r,{select:t}),document.activeElement!==n)return}function VA(e){const t=a2(e),n=f0(t,e),r=f0(t.reverse(),e);return[n,r]}function a2(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function f0(e,t){for(const n of e)if(!jA(n,{upTo:t}))return n}function jA(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function HA(e){return e instanceof HTMLInputElement&&"select"in e}function go(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&HA(e)&&t&&e.select()}}var h0=GA();function GA(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=p0(e,t),e.unshift(t)},remove(t){var n;e=p0(e,t),(n=e[0])==null||n.resume()}}}function p0(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function KA(e){return e.filter(t=>t.tagName!=="A")}function s2(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var qA=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Hi=new WeakMap,pl=new WeakMap,vl={},Mf=0,u2=function(e){return e&&(e.host||u2(e.parentNode))},XA=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=u2(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},YA=function(e,t,n,r){var o=XA(t,Array.isArray(e)?e:[e]);vl[n]||(vl[n]=new WeakMap);var i=vl[n],a=[],s=new Set,u=new Set(o),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};o.forEach(l);var c=function(d){!d||u.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))c(f);else try{var h=f.getAttribute(r),v=h!==null&&h!=="false",p=(Hi.get(f)||0)+1,g=(i.get(f)||0)+1;Hi.set(f,p),i.set(f,g),a.push(f),p===1&&v&&pl.set(f,!0),g===1&&f.setAttribute(n,"true"),v||f.setAttribute(r,"true")}catch(m){console.error("aria-hidden: cannot operate on ",f,m)}})};return c(t),s.clear(),Mf++,function(){a.forEach(function(d){var f=Hi.get(d)-1,h=i.get(d)-1;Hi.set(d,f),i.set(d,h),f||(pl.has(d)||d.removeAttribute(r),pl.delete(d)),h||d.removeAttribute(n)}),Mf--,Mf||(Hi=new WeakMap,Hi=new WeakMap,pl=new WeakMap,vl={})}},QA=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=qA(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),YA(r,o,n,"aria-hidden")):function(){return null}},br=function(){return br=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},br.apply(this,arguments)};function l2(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function JA(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Hl="right-scroll-bar-position",Gl="width-before-scroll-bar",ZA="with-scroll-bars-hidden",eN="--removed-body-scroll-bar-size";function Ff(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function tN(e,t){var n=E.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}var nN=typeof window<"u"?E.useLayoutEffect:E.useEffect,v0=new WeakMap;function rN(e,t){var n=tN(null,function(r){return e.forEach(function(o){return Ff(o,r)})});return nN(function(){var r=v0.get(n);if(r){var o=new Set(r),i=new Set(e),a=n.current;o.forEach(function(s){i.has(s)||Ff(s,null)}),i.forEach(function(s){o.has(s)||Ff(s,a)})}v0.set(n,e)},[e]),n}function oN(e){return e}function iN(e,t){t===void 0&&(t=oN);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(s){return s!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(s){return i(s)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var s=n;n=[],s.forEach(i),a=n}var u=function(){var c=a;a=[],c.forEach(i)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){a.push(c),l()},filter:function(c){return a=a.filter(c),n}}}};return o}function aN(e){e===void 0&&(e={});var t=iN(null);return t.options=br({async:!0,ssr:!1},e),t}var c2=function(e){var t=e.sideCar,n=l2(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,br({},n))};c2.isSideCarExport=!0;function sN(e,t){return e.useMedium(t),c2}var d2=aN(),Of=function(){},Rd=E.forwardRef(function(e,t){var n=E.useRef(null),r=E.useState({onScrollCapture:Of,onWheelCapture:Of,onTouchMoveCapture:Of}),o=r[0],i=r[1],a=e.forwardProps,s=e.children,u=e.className,l=e.removeScrollBar,c=e.enabled,d=e.shards,f=e.sideCar,h=e.noIsolation,v=e.inert,p=e.allowPinchZoom,g=e.as,m=g===void 0?"div":g,y=e.gapMode,x=l2(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=f,b=rN([n,t]),C=br(br({},x),o);return E.createElement(E.Fragment,null,c&&E.createElement(w,{sideCar:d2,removeScrollBar:l,shards:d,noIsolation:h,inert:v,setCallbacks:i,allowPinchZoom:!!p,lockRef:n,gapMode:y}),a?E.cloneElement(E.Children.only(s),br(br({},C),{ref:b})):E.createElement(m,br({},C,{className:u,ref:b}),s))});Rd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Rd.classNames={fullWidth:Gl,zeroRight:Hl};var uN=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function lN(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=uN();return t&&e.setAttribute("nonce",t),e}function cN(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function dN(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var fN=function(){var e=0,t=null;return{add:function(n){e==0&&(t=lN())&&(cN(t,n),dN(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},hN=function(){var e=fN();return function(t,n){E.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},f2=function(){var e=hN(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},pN={left:0,top:0,right:0,gap:0},Lf=function(e){return parseInt(e||"",10)||0},vN=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[Lf(n),Lf(r),Lf(o)]},mN=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return pN;var t=vN(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},gN=f2(),Ea="data-scroll-locked",yN=function(e,t,n,r){var o=e.left,i=e.top,a=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(ZA,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Ea,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Hl,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Gl,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Hl," .").concat(Hl,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Gl," .").concat(Gl,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ea,`] {
    `).concat(eN,": ").concat(s,`px;
  }
`)},m0=function(){var e=parseInt(document.body.getAttribute(Ea)||"0",10);return isFinite(e)?e:0},xN=function(){E.useEffect(function(){return document.body.setAttribute(Ea,(m0()+1).toString()),function(){var e=m0()-1;e<=0?document.body.removeAttribute(Ea):document.body.setAttribute(Ea,e.toString())}},[])},wN=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;xN();var i=E.useMemo(function(){return mN(o)},[o]);return E.createElement(gN,{styles:yN(i,!t,o,n?"":"!important")})},xp=!1;if(typeof window<"u")try{var ml=Object.defineProperty({},"passive",{get:function(){return xp=!0,!0}});window.addEventListener("test",ml,ml),window.removeEventListener("test",ml,ml)}catch{xp=!1}var Gi=xp?{passive:!1}:!1,bN=function(e){return e.tagName==="TEXTAREA"},h2=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!bN(e)&&n[t]==="visible")},CN=function(e){return h2(e,"overflowY")},EN=function(e){return h2(e,"overflowX")},g0=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=p2(e,r);if(o){var i=v2(e,r),a=i[1],s=i[2];if(a>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},SN=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},_N=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},p2=function(e,t){return e==="v"?CN(t):EN(t)},v2=function(e,t){return e==="v"?SN(t):_N(t)},kN=function(e,t){return e==="h"&&t==="rtl"?-1:1},RN=function(e,t,n,r,o){var i=kN(e,window.getComputedStyle(t).direction),a=i*r,s=n.target,u=t.contains(s),l=!1,c=a>0,d=0,f=0;do{var h=v2(e,s),v=h[0],p=h[1],g=h[2],m=p-g-i*v;(v||m)&&p2(e,s)&&(d+=m,f+=v),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!u&&s!==document.body||u&&(t.contains(s)||t===s));return(c&&(Math.abs(d)<1||!o)||!c&&(Math.abs(f)<1||!o))&&(l=!0),l},gl=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},y0=function(e){return[e.deltaX,e.deltaY]},x0=function(e){return e&&"current"in e?e.current:e},IN=function(e,t){return e[0]===t[0]&&e[1]===t[1]},TN=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},PN=0,Ki=[];function AN(e){var t=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),o=E.useState(PN++)[0],i=E.useState(f2)[0],a=E.useRef(e);E.useEffect(function(){a.current=e},[e]),E.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var p=JA([e.lockRef.current],(e.shards||[]).map(x0),!0).filter(Boolean);return p.forEach(function(g){return g.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),p.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var s=E.useCallback(function(p,g){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!a.current.allowPinchZoom;var m=gl(p),y=n.current,x="deltaX"in p?p.deltaX:y[0]-m[0],w="deltaY"in p?p.deltaY:y[1]-m[1],b,C=p.target,S=Math.abs(x)>Math.abs(w)?"h":"v";if("touches"in p&&S==="h"&&C.type==="range")return!1;var _=g0(S,C);if(!_)return!0;if(_?b=S:(b=S==="v"?"h":"v",_=g0(S,C)),!_)return!1;if(!r.current&&"changedTouches"in p&&(x||w)&&(r.current=b),!b)return!0;var k=r.current||b;return RN(k,g,p,k==="h"?x:w,!0)},[]),u=E.useCallback(function(p){var g=p;if(!(!Ki.length||Ki[Ki.length-1]!==i)){var m="deltaY"in g?y0(g):gl(g),y=t.current.filter(function(b){return b.name===g.type&&(b.target===g.target||g.target===b.shadowParent)&&IN(b.delta,m)})[0];if(y&&y.should){g.cancelable&&g.preventDefault();return}if(!y){var x=(a.current.shards||[]).map(x0).filter(Boolean).filter(function(b){return b.contains(g.target)}),w=x.length>0?s(g,x[0]):!a.current.noIsolation;w&&g.cancelable&&g.preventDefault()}}},[]),l=E.useCallback(function(p,g,m,y){var x={name:p,delta:g,target:m,should:y,shadowParent:NN(m)};t.current.push(x),setTimeout(function(){t.current=t.current.filter(function(w){return w!==x})},1)},[]),c=E.useCallback(function(p){n.current=gl(p),r.current=void 0},[]),d=E.useCallback(function(p){l(p.type,y0(p),p.target,s(p,e.lockRef.current))},[]),f=E.useCallback(function(p){l(p.type,gl(p),p.target,s(p,e.lockRef.current))},[]);E.useEffect(function(){return Ki.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",u,Gi),document.addEventListener("touchmove",u,Gi),document.addEventListener("touchstart",c,Gi),function(){Ki=Ki.filter(function(p){return p!==i}),document.removeEventListener("wheel",u,Gi),document.removeEventListener("touchmove",u,Gi),document.removeEventListener("touchstart",c,Gi)}},[]);var h=e.removeScrollBar,v=e.inert;return E.createElement(E.Fragment,null,v?E.createElement(i,{styles:TN(o)}):null,h?E.createElement(wN,{gapMode:e.gapMode}):null)}function NN(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const DN=sN(d2,AN);var m2=E.forwardRef(function(e,t){return E.createElement(Rd,br({},e,{ref:t,sideCar:DN}))});m2.classNames=Rd.classNames;var MN=[" ","Enter","ArrowUp","ArrowDown"],FN=[" ","Enter"],Au="Select",[Id,Td,ON]=Hv(Au),[ss,Uz]=rs(Au,[ON,wd]),Pd=wd(),[LN,ei]=ss(Au),[BN,WN]=ss(Au),g2=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:o,onOpenChange:i,value:a,defaultValue:s,onValueChange:u,dir:l,name:c,autoComplete:d,disabled:f,required:h,form:v}=e,p=Pd(t),[g,m]=E.useState(null),[y,x]=E.useState(null),[w,b]=E.useState(!1),C=dm(l),[S=!1,_]=yc({prop:r,defaultProp:o,onChange:i}),[k,R]=yc({prop:a,defaultProp:s,onChange:u}),N=E.useRef(null),P=g?v||!!g.closest("form"):!0,[L,M]=E.useState(new Set),W=Array.from(L).map(B=>B.props.value).join(";");return $.jsx(gP,{...p,children:$.jsxs(LN,{required:h,scope:t,trigger:g,onTriggerChange:m,valueNode:y,onValueNodeChange:x,valueNodeHasChildren:w,onValueNodeHasChildrenChange:b,contentId:Qv(),value:k,onValueChange:R,open:S,onOpenChange:_,dir:C,triggerPointerDownPosRef:N,disabled:f,children:[$.jsx(Id.Provider,{scope:t,children:$.jsx(BN,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(B=>{M(z=>new Set(z).add(B))},[]),onNativeOptionRemove:E.useCallback(B=>{M(z=>{const A=new Set(z);return A.delete(B),A})},[]),children:n})}),P?$.jsxs(U2,{"aria-hidden":!0,required:h,tabIndex:-1,name:c,autoComplete:d,value:k,onChange:B=>R(B.target.value),disabled:f,form:v,children:[k===void 0?$.jsx("option",{value:""}):null,Array.from(L)]},W):null]})})};g2.displayName=Au;var y2="SelectTrigger",x2=E.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...o}=e,i=Pd(n),a=ei(y2,n),s=a.disabled||r,u=Me(t,a.onTriggerChange),l=Td(n),c=E.useRef("touch"),[d,f,h]=V2(p=>{const g=l().filter(x=>!x.disabled),m=g.find(x=>x.value===a.value),y=j2(g,p,m);y!==void 0&&a.onValueChange(y.value)}),v=p=>{s||(a.onOpenChange(!0),h()),p&&(a.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)})};return $.jsx(Fb,{asChild:!0,...i,children:$.jsx(ke.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":$2(a.value)?"":void 0,...o,ref:u,onClick:ge(o.onClick,p=>{p.currentTarget.focus(),c.current!=="mouse"&&v(p)}),onPointerDown:ge(o.onPointerDown,p=>{c.current=p.pointerType;const g=p.target;g.hasPointerCapture(p.pointerId)&&g.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&p.pointerType==="mouse"&&(v(p),p.preventDefault())}),onKeyDown:ge(o.onKeyDown,p=>{const g=d.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&f(p.key),!(g&&p.key===" ")&&MN.includes(p.key)&&(v(),p.preventDefault())})})})});x2.displayName=y2;var w2="SelectValue",b2=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,children:i,placeholder:a="",...s}=e,u=ei(w2,n),{onValueNodeHasChildrenChange:l}=u,c=i!==void 0,d=Me(t,u.onValueNodeChange);return mt(()=>{l(c)},[l,c]),$.jsx(ke.span,{...s,ref:d,style:{pointerEvents:"none"},children:$2(u.value)?$.jsx($.Fragment,{children:a}):i})});b2.displayName=w2;var zN="SelectIcon",C2=E.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...o}=e;return $.jsx(ke.span,{"aria-hidden":!0,...o,ref:t,children:r||"▼"})});C2.displayName=zN;var $N="SelectPortal",E2=e=>$.jsx(Gv,{asChild:!0,...e});E2.displayName=$N;var Ni="SelectContent",S2=E.forwardRef((e,t)=>{const n=ei(Ni,e.__scopeSelect),[r,o]=E.useState();if(mt(()=>{o(new DocumentFragment)},[]),!n.open){const i=r;return i?Oi.createPortal($.jsx(_2,{scope:e.__scopeSelect,children:$.jsx(Id.Slot,{scope:e.__scopeSelect,children:$.jsx("div",{children:e.children})})}),i):null}return $.jsx(k2,{...e,ref:t})});S2.displayName=Ni;var Gn=10,[_2,ti]=ss(Ni),UN="SelectContentImpl",k2=E.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:i,onPointerDownOutside:a,side:s,sideOffset:u,align:l,alignOffset:c,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:v,hideWhenDetached:p,avoidCollisions:g,...m}=e,y=ei(Ni,n),[x,w]=E.useState(null),[b,C]=E.useState(null),S=Me(t,J=>w(J)),[_,k]=E.useState(null),[R,N]=E.useState(null),P=Td(n),[L,M]=E.useState(!1),W=E.useRef(!1);E.useEffect(()=>{if(x)return QA(x)},[x]),zA();const B=E.useCallback(J=>{const[oe,...ve]=P().map(le=>le.ref.current),[me]=ve.slice(-1),ie=document.activeElement;for(const le of J)if(le===ie||(le==null||le.scrollIntoView({block:"nearest"}),le===oe&&b&&(b.scrollTop=0),le===me&&b&&(b.scrollTop=b.scrollHeight),le==null||le.focus(),document.activeElement!==ie))return},[P,b]),z=E.useCallback(()=>B([_,x]),[B,_,x]);E.useEffect(()=>{L&&z()},[L,z]);const{onOpenChange:A,triggerPointerDownPosRef:F}=y;E.useEffect(()=>{if(x){let J={x:0,y:0};const oe=me=>{var ie,le;J={x:Math.abs(Math.round(me.pageX)-(((ie=F.current)==null?void 0:ie.x)??0)),y:Math.abs(Math.round(me.pageY)-(((le=F.current)==null?void 0:le.y)??0))}},ve=me=>{J.x<=10&&J.y<=10?me.preventDefault():x.contains(me.target)||A(!1),document.removeEventListener("pointermove",oe),F.current=null};return F.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",ve,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",ve,{capture:!0})}}},[x,A,F]),E.useEffect(()=>{const J=()=>A(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[A]);const[U,j]=V2(J=>{const oe=P().filter(ie=>!ie.disabled),ve=oe.find(ie=>ie.ref.current===document.activeElement),me=j2(oe,J,ve);me&&setTimeout(()=>me.ref.current.focus())}),K=E.useCallback((J,oe,ve)=>{const me=!W.current&&!ve;(y.value!==void 0&&y.value===oe||me)&&(k(J),me&&(W.current=!0))},[y.value]),Y=E.useCallback(()=>x==null?void 0:x.focus(),[x]),ne=E.useCallback((J,oe,ve)=>{const me=!W.current&&!ve;(y.value!==void 0&&y.value===oe||me)&&N(J)},[y.value]),pe=r==="popper"?wp:R2,te=pe===wp?{side:s,sideOffset:u,align:l,alignOffset:c,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:v,hideWhenDetached:p,avoidCollisions:g}:{};return $.jsx(_2,{scope:n,content:x,viewport:b,onViewportChange:C,itemRefCallback:K,selectedItem:_,onItemLeave:Y,itemTextRefCallback:ne,focusSelectedItem:z,selectedItemText:R,position:r,isPositioned:L,searchRef:U,children:$.jsx(m2,{as:au,allowPinchZoom:!0,children:$.jsx(i2,{asChild:!0,trapped:y.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:ge(o,J=>{var oe;(oe=y.trigger)==null||oe.focus({preventScroll:!0}),J.preventDefault()}),children:$.jsx(pd,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:$.jsx(pe,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:J=>J.preventDefault(),...m,...te,onPlaced:()=>M(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...m.style},onKeyDown:ge(m.onKeyDown,J=>{const oe=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!oe&&J.key.length===1&&j(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let me=P().filter(ie=>!ie.disabled).map(ie=>ie.ref.current);if(["ArrowUp","End"].includes(J.key)&&(me=me.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const ie=J.target,le=me.indexOf(ie);me=me.slice(le+1)}setTimeout(()=>B(me)),J.preventDefault()}})})})})})})});k2.displayName=UN;var VN="SelectItemAlignedPosition",R2=E.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...o}=e,i=ei(Ni,n),a=ti(Ni,n),[s,u]=E.useState(null),[l,c]=E.useState(null),d=Me(t,S=>c(S)),f=Td(n),h=E.useRef(!1),v=E.useRef(!0),{viewport:p,selectedItem:g,selectedItemText:m,focusSelectedItem:y}=a,x=E.useCallback(()=>{if(i.trigger&&i.valueNode&&s&&l&&p&&g&&m){const S=i.trigger.getBoundingClientRect(),_=l.getBoundingClientRect(),k=i.valueNode.getBoundingClientRect(),R=m.getBoundingClientRect();if(i.dir!=="rtl"){const ie=R.left-_.left,le=k.left-ie,ye=S.left-le,Pe=S.width+ye,Fe=Math.max(Pe,_.width),Ae=window.innerWidth-Gn,wt=du(le,[Gn,Math.max(Gn,Ae-Fe)]);s.style.minWidth=Pe+"px",s.style.left=wt+"px"}else{const ie=_.right-R.right,le=window.innerWidth-k.right-ie,ye=window.innerWidth-S.right-le,Pe=S.width+ye,Fe=Math.max(Pe,_.width),Ae=window.innerWidth-Gn,wt=du(le,[Gn,Math.max(Gn,Ae-Fe)]);s.style.minWidth=Pe+"px",s.style.right=wt+"px"}const N=f(),P=window.innerHeight-Gn*2,L=p.scrollHeight,M=window.getComputedStyle(l),W=parseInt(M.borderTopWidth,10),B=parseInt(M.paddingTop,10),z=parseInt(M.borderBottomWidth,10),A=parseInt(M.paddingBottom,10),F=W+B+L+A+z,U=Math.min(g.offsetHeight*5,F),j=window.getComputedStyle(p),K=parseInt(j.paddingTop,10),Y=parseInt(j.paddingBottom,10),ne=S.top+S.height/2-Gn,pe=P-ne,te=g.offsetHeight/2,J=g.offsetTop+te,oe=W+B+J,ve=F-oe;if(oe<=ne){const ie=N.length>0&&g===N[N.length-1].ref.current;s.style.bottom="0px";const le=l.clientHeight-p.offsetTop-p.offsetHeight,ye=Math.max(pe,te+(ie?Y:0)+le+z),Pe=oe+ye;s.style.height=Pe+"px"}else{const ie=N.length>0&&g===N[0].ref.current;s.style.top="0px";const ye=Math.max(ne,W+p.offsetTop+(ie?K:0)+te)+ve;s.style.height=ye+"px",p.scrollTop=oe-ne+p.offsetTop}s.style.margin=`${Gn}px 0`,s.style.minHeight=U+"px",s.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>h.current=!0)}},[f,i.trigger,i.valueNode,s,l,p,g,m,i.dir,r]);mt(()=>x(),[x]);const[w,b]=E.useState();mt(()=>{l&&b(window.getComputedStyle(l).zIndex)},[l]);const C=E.useCallback(S=>{S&&v.current===!0&&(x(),y==null||y(),v.current=!1)},[x,y]);return $.jsx(HN,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:h,onScrollButtonChange:C,children:$.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:$.jsx(ke.div,{...o,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});R2.displayName=VN;var jN="SelectPopperPosition",wp=E.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:o=Gn,...i}=e,a=Pd(n);return $.jsx(Ob,{...a,...i,ref:t,align:r,collisionPadding:o,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});wp.displayName=jN;var[HN,fm]=ss(Ni,{}),bp="SelectViewport",I2=E.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...o}=e,i=ti(bp,n),a=fm(bp,n),s=Me(t,i.onViewportChange),u=E.useRef(0);return $.jsxs($.Fragment,{children:[$.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),$.jsx(Id.Slot,{scope:n,children:$.jsx(ke.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:ge(o.onScroll,l=>{const c=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=a;if(f!=null&&f.current&&d){const h=Math.abs(u.current-c.scrollTop);if(h>0){const v=window.innerHeight-Gn*2,p=parseFloat(d.style.minHeight),g=parseFloat(d.style.height),m=Math.max(p,g);if(m<v){const y=m+h,x=Math.min(v,y),w=y-x;d.style.height=x+"px",d.style.bottom==="0px"&&(c.scrollTop=w>0?w:0,d.style.justifyContent="flex-end")}}}u.current=c.scrollTop})})})]})});I2.displayName=bp;var T2="SelectGroup",[GN,KN]=ss(T2),qN=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=Qv();return $.jsx(GN,{scope:n,id:o,children:$.jsx(ke.div,{role:"group","aria-labelledby":o,...r,ref:t})})});qN.displayName=T2;var P2="SelectLabel",A2=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=KN(P2,n);return $.jsx(ke.div,{id:o.id,...r,ref:t})});A2.displayName=P2;var kc="SelectItem",[XN,N2]=ss(kc),D2=E.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:o=!1,textValue:i,...a}=e,s=ei(kc,n),u=ti(kc,n),l=s.value===r,[c,d]=E.useState(i??""),[f,h]=E.useState(!1),v=Me(t,y=>{var x;return(x=u.itemRefCallback)==null?void 0:x.call(u,y,r,o)}),p=Qv(),g=E.useRef("touch"),m=()=>{o||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return $.jsx(XN,{scope:n,value:r,disabled:o,textId:p,isSelected:l,onItemTextChange:E.useCallback(y=>{d(x=>x||((y==null?void 0:y.textContent)??"").trim())},[]),children:$.jsx(Id.ItemSlot,{scope:n,value:r,disabled:o,textValue:c,children:$.jsx(ke.div,{role:"option","aria-labelledby":p,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...a,ref:v,onFocus:ge(a.onFocus,()=>h(!0)),onBlur:ge(a.onBlur,()=>h(!1)),onClick:ge(a.onClick,()=>{g.current!=="mouse"&&m()}),onPointerUp:ge(a.onPointerUp,()=>{g.current==="mouse"&&m()}),onPointerDown:ge(a.onPointerDown,y=>{g.current=y.pointerType}),onPointerMove:ge(a.onPointerMove,y=>{var x;g.current=y.pointerType,o?(x=u.onItemLeave)==null||x.call(u):g.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(a.onPointerLeave,y=>{var x;y.currentTarget===document.activeElement&&((x=u.onItemLeave)==null||x.call(u))}),onKeyDown:ge(a.onKeyDown,y=>{var w;((w=u.searchRef)==null?void 0:w.current)!==""&&y.key===" "||(FN.includes(y.key)&&m(),y.key===" "&&y.preventDefault())})})})})});D2.displayName=kc;var Ps="SelectItemText",M2=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,...i}=e,a=ei(Ps,n),s=ti(Ps,n),u=N2(Ps,n),l=WN(Ps,n),[c,d]=E.useState(null),f=Me(t,m=>d(m),u.onItemTextChange,m=>{var y;return(y=s.itemTextRefCallback)==null?void 0:y.call(s,m,u.value,u.disabled)}),h=c==null?void 0:c.textContent,v=E.useMemo(()=>$.jsx("option",{value:u.value,disabled:u.disabled,children:h},u.value),[u.disabled,u.value,h]),{onNativeOptionAdd:p,onNativeOptionRemove:g}=l;return mt(()=>(p(v),()=>g(v)),[p,g,v]),$.jsxs($.Fragment,{children:[$.jsx(ke.span,{id:u.textId,...i,ref:f}),u.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Oi.createPortal(i.children,a.valueNode):null]})});M2.displayName=Ps;var F2="SelectItemIndicator",O2=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return N2(F2,n).isSelected?$.jsx(ke.span,{"aria-hidden":!0,...r,ref:t}):null});O2.displayName=F2;var Cp="SelectScrollUpButton",L2=E.forwardRef((e,t)=>{const n=ti(Cp,e.__scopeSelect),r=fm(Cp,e.__scopeSelect),[o,i]=E.useState(!1),a=Me(t,r.onScrollButtonChange);return mt(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=u.scrollTop>0;i(l)};const u=n.viewport;return s(),u.addEventListener("scroll",s),()=>u.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),o?$.jsx(W2,{...e,ref:a,onAutoScroll:()=>{const{viewport:s,selectedItem:u}=n;s&&u&&(s.scrollTop=s.scrollTop-u.offsetHeight)}}):null});L2.displayName=Cp;var Ep="SelectScrollDownButton",B2=E.forwardRef((e,t)=>{const n=ti(Ep,e.__scopeSelect),r=fm(Ep,e.__scopeSelect),[o,i]=E.useState(!1),a=Me(t,r.onScrollButtonChange);return mt(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=u.scrollHeight-u.clientHeight,c=Math.ceil(u.scrollTop)<l;i(c)};const u=n.viewport;return s(),u.addEventListener("scroll",s),()=>u.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),o?$.jsx(W2,{...e,ref:a,onAutoScroll:()=>{const{viewport:s,selectedItem:u}=n;s&&u&&(s.scrollTop=s.scrollTop+u.offsetHeight)}}):null});B2.displayName=Ep;var W2=E.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...o}=e,i=ti("SelectScrollButton",n),a=E.useRef(null),s=Td(n),u=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>u(),[u]),mt(()=>{var c;const l=s().find(d=>d.ref.current===document.activeElement);(c=l==null?void 0:l.ref.current)==null||c.scrollIntoView({block:"nearest"})},[s]),$.jsx(ke.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:ge(o.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:ge(o.onPointerMove,()=>{var l;(l=i.onItemLeave)==null||l.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:ge(o.onPointerLeave,()=>{u()})})}),YN="SelectSeparator",z2=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return $.jsx(ke.div,{"aria-hidden":!0,...r,ref:t})});z2.displayName=YN;var Sp="SelectArrow",QN=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=Pd(n),i=ei(Sp,n),a=ti(Sp,n);return i.open&&a.position==="popper"?$.jsx(Lb,{...o,...r,ref:t}):null});QN.displayName=Sp;function $2(e){return e===""||e===void 0}var U2=E.forwardRef((e,t)=>{const{value:n,...r}=e,o=E.useRef(null),i=Me(t,o),a=s2(n);return E.useEffect(()=>{const s=o.current,u=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(u,"value").set;if(a!==n&&c){const d=new Event("change",{bubbles:!0});c.call(s,n),s.dispatchEvent(d)}},[a,n]),$.jsx(Iu,{asChild:!0,children:$.jsx("select",{...r,ref:i,defaultValue:n})})});U2.displayName="BubbleSelect";function V2(e){const t=at(e),n=E.useRef(""),r=E.useRef(0),o=E.useCallback(a=>{const s=n.current+a;t(s),function u(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>u(""),1e3))}(s)},[t]),i=E.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,o,i]}function j2(e,t,n){const o=t.length>1&&Array.from(t).every(l=>l===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=JN(e,Math.max(i,0));o.length===1&&(a=a.filter(l=>l!==n));const u=a.find(l=>l.textValue.toLowerCase().startsWith(o.toLowerCase()));return u!==n?u:void 0}function JN(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Vz=g2,jz=x2,Hz=b2,Gz=C2,Kz=E2,qz=S2,Xz=I2,Yz=A2,Qz=D2,Jz=M2,Zz=O2,e5=L2,t5=B2,n5=z2,hm="Avatar",[ZN,r5]=rs(hm),[eD,H2]=ZN(hm),G2=E.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[o,i]=E.useState("idle");return $.jsx(eD,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:i,children:$.jsx(ke.span,{...r,ref:t})})});G2.displayName=hm;var K2="AvatarImage",q2=E.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:o=()=>{},...i}=e,a=H2(K2,n),s=tD(r,i.referrerPolicy),u=at(l=>{o(l),a.onImageLoadingStatusChange(l)});return mt(()=>{s!=="idle"&&u(s)},[s,u]),s==="loaded"?$.jsx(ke.img,{...i,ref:t,src:r}):null});q2.displayName=K2;var X2="AvatarFallback",Y2=E.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...o}=e,i=H2(X2,n),[a,s]=E.useState(r===void 0);return E.useEffect(()=>{if(r!==void 0){const u=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(u)}},[r]),a&&i.imageLoadingStatus!=="loaded"?$.jsx(ke.span,{...o,ref:t}):null});Y2.displayName=X2;function tD(e,t){const[n,r]=E.useState("idle");return mt(()=>{if(!e){r("error");return}let o=!0;const i=new window.Image,a=s=>()=>{o&&r(s)};return r("loading"),i.onload=a("loaded"),i.onerror=a("error"),i.src=e,t&&(i.referrerPolicy=t),()=>{o=!1}},[e,t]),n}var o5=G2,i5=q2,a5=Y2,Q2=["PageUp","PageDown"],J2=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Z2={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},us="Slider",[_p,nD,rD]=Hv(us),[eC,s5]=rs(us,[rD]),[oD,Ad]=eC(us),tC=E.forwardRef((e,t)=>{const{name:n,min:r=0,max:o=100,step:i=1,orientation:a="horizontal",disabled:s=!1,minStepsBetweenThumbs:u=0,defaultValue:l=[r],value:c,onValueChange:d=()=>{},onValueCommit:f=()=>{},inverted:h=!1,form:v,...p}=e,g=E.useRef(new Set),m=E.useRef(0),x=a==="horizontal"?iD:aD,[w=[],b]=yc({prop:c,defaultProp:l,onChange:N=>{var L;(L=[...g.current][m.current])==null||L.focus(),d(N)}}),C=E.useRef(w);function S(N){const P=dD(w,N);R(N,P)}function _(N){R(N,m.current)}function k(){const N=C.current[m.current];w[m.current]!==N&&f(w)}function R(N,P,{commit:L}={commit:!1}){const M=vD(i),W=mD(Math.round((N-r)/i)*i+r,M),B=du(W,[r,o]);b((z=[])=>{const A=lD(z,B,P);if(pD(A,u*i)){m.current=A.indexOf(B);const F=String(A)!==String(z);return F&&L&&f(A),F?A:z}else return z})}return $.jsx(oD,{scope:e.__scopeSlider,name:n,disabled:s,min:r,max:o,valueIndexToChangeRef:m,thumbs:g.current,values:w,orientation:a,form:v,children:$.jsx(_p.Provider,{scope:e.__scopeSlider,children:$.jsx(_p.Slot,{scope:e.__scopeSlider,children:$.jsx(x,{"aria-disabled":s,"data-disabled":s?"":void 0,...p,ref:t,onPointerDown:ge(p.onPointerDown,()=>{s||(C.current=w)}),min:r,max:o,inverted:h,onSlideStart:s?void 0:S,onSlideMove:s?void 0:_,onSlideEnd:s?void 0:k,onHomeKeyDown:()=>!s&&R(r,0,{commit:!0}),onEndKeyDown:()=>!s&&R(o,w.length-1,{commit:!0}),onStepKeyDown:({event:N,direction:P})=>{if(!s){const W=Q2.includes(N.key)||N.shiftKey&&J2.includes(N.key)?10:1,B=m.current,z=w[B],A=i*W*P;R(z+A,B,{commit:!0})}}})})})})});tC.displayName=us;var[nC,rC]=eC(us,{startEdge:"left",endEdge:"right",size:"width",direction:1}),iD=E.forwardRef((e,t)=>{const{min:n,max:r,dir:o,inverted:i,onSlideStart:a,onSlideMove:s,onSlideEnd:u,onStepKeyDown:l,...c}=e,[d,f]=E.useState(null),h=Me(t,x=>f(x)),v=E.useRef(),p=dm(o),g=p==="ltr",m=g&&!i||!g&&i;function y(x){const w=v.current||d.getBoundingClientRect(),b=[0,w.width],S=pm(b,m?[n,r]:[r,n]);return v.current=w,S(x-w.left)}return $.jsx(nC,{scope:e.__scopeSlider,startEdge:m?"left":"right",endEdge:m?"right":"left",direction:m?1:-1,size:"width",children:$.jsx(oC,{dir:p,"data-orientation":"horizontal",...c,ref:h,style:{...c.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:x=>{const w=y(x.clientX);a==null||a(w)},onSlideMove:x=>{const w=y(x.clientX);s==null||s(w)},onSlideEnd:()=>{v.current=void 0,u==null||u()},onStepKeyDown:x=>{const b=Z2[m?"from-left":"from-right"].includes(x.key);l==null||l({event:x,direction:b?-1:1})}})})}),aD=E.forwardRef((e,t)=>{const{min:n,max:r,inverted:o,onSlideStart:i,onSlideMove:a,onSlideEnd:s,onStepKeyDown:u,...l}=e,c=E.useRef(null),d=Me(t,c),f=E.useRef(),h=!o;function v(p){const g=f.current||c.current.getBoundingClientRect(),m=[0,g.height],x=pm(m,h?[r,n]:[n,r]);return f.current=g,x(p-g.top)}return $.jsx(nC,{scope:e.__scopeSlider,startEdge:h?"bottom":"top",endEdge:h?"top":"bottom",size:"height",direction:h?1:-1,children:$.jsx(oC,{"data-orientation":"vertical",...l,ref:d,style:{...l.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:p=>{const g=v(p.clientY);i==null||i(g)},onSlideMove:p=>{const g=v(p.clientY);a==null||a(g)},onSlideEnd:()=>{f.current=void 0,s==null||s()},onStepKeyDown:p=>{const m=Z2[h?"from-bottom":"from-top"].includes(p.key);u==null||u({event:p,direction:m?-1:1})}})})}),oC=E.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:o,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:s,onStepKeyDown:u,...l}=e,c=Ad(us,n);return $.jsx(ke.span,{...l,ref:t,onKeyDown:ge(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(s(d),d.preventDefault()):Q2.concat(J2).includes(d.key)&&(u(d),d.preventDefault())}),onPointerDown:ge(e.onPointerDown,d=>{const f=d.target;f.setPointerCapture(d.pointerId),d.preventDefault(),c.thumbs.has(f)?f.focus():r(d)}),onPointerMove:ge(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&o(d)}),onPointerUp:ge(e.onPointerUp,d=>{const f=d.target;f.hasPointerCapture(d.pointerId)&&(f.releasePointerCapture(d.pointerId),i(d))})})}),iC="SliderTrack",aC=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,o=Ad(iC,n);return $.jsx(ke.span,{"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation,...r,ref:t})});aC.displayName=iC;var kp="SliderRange",sC=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,o=Ad(kp,n),i=rC(kp,n),a=E.useRef(null),s=Me(t,a),u=o.values.length,l=o.values.map(f=>lC(f,o.min,o.max)),c=u>1?Math.min(...l):0,d=100-Math.max(...l);return $.jsx(ke.span,{"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,...r,ref:s,style:{...e.style,[i.startEdge]:c+"%",[i.endEdge]:d+"%"}})});sC.displayName=kp;var Rp="SliderThumb",uC=E.forwardRef((e,t)=>{const n=nD(e.__scopeSlider),[r,o]=E.useState(null),i=Me(t,s=>o(s)),a=E.useMemo(()=>r?n().findIndex(s=>s.ref.current===r):-1,[n,r]);return $.jsx(sD,{...e,ref:i,index:a})}),sD=E.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:o,...i}=e,a=Ad(Rp,n),s=rC(Rp,n),[u,l]=E.useState(null),c=Me(t,y=>l(y)),d=u?a.form||!!u.closest("form"):!0,f=_b(u),h=a.values[r],v=h===void 0?0:lC(h,a.min,a.max),p=cD(r,a.values.length),g=f==null?void 0:f[s.size],m=g?fD(g,v,s.direction):0;return E.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),$.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[s.startEdge]:`calc(${v}% + ${m}px)`},children:[$.jsx(_p.ItemSlot,{scope:e.__scopeSlider,children:$.jsx(ke.span,{role:"slider","aria-label":e["aria-label"]||p,"aria-valuemin":a.min,"aria-valuenow":h,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:c,style:h===void 0?{display:"none"}:e.style,onFocus:ge(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&$.jsx(uD,{name:o??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:h},r)]})});uC.displayName=Rp;var uD=e=>{const{value:t,...n}=e,r=E.useRef(null),o=s2(t);return E.useEffect(()=>{const i=r.current,a=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(o!==t&&u){const l=new Event("input",{bubbles:!0});u.call(i,t),i.dispatchEvent(l)}},[o,t]),$.jsx("input",{style:{display:"none"},...n,ref:r,defaultValue:t})};function lD(e=[],t,n){const r=[...e];return r[n]=t,r.sort((o,i)=>o-i)}function lC(e,t,n){const i=100/(n-t)*(e-t);return du(i,[0,100])}function cD(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function dD(e,t){if(e.length===1)return 0;const n=e.map(o=>Math.abs(o-t)),r=Math.min(...n);return n.indexOf(r)}function fD(e,t,n){const r=e/2,i=pm([0,50],[0,r]);return(r-i(t)*n)*n}function hD(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function pD(e,t){if(t>0){const n=hD(e);return Math.min(...n)>=t}return!0}function pm(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function vD(e){return(String(e).split(".")[1]||"").length}function mD(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var u5=tC,l5=aC,c5=sC,d5=uC;function gD(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var vm="ScrollArea",[cC,f5]=rs(vm),[yD,Un]=cC(vm),dC=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:o,scrollHideDelay:i=600,...a}=e,[s,u]=E.useState(null),[l,c]=E.useState(null),[d,f]=E.useState(null),[h,v]=E.useState(null),[p,g]=E.useState(null),[m,y]=E.useState(0),[x,w]=E.useState(0),[b,C]=E.useState(!1),[S,_]=E.useState(!1),k=Me(t,N=>u(N)),R=dm(o);return $.jsx(yD,{scope:n,type:r,dir:R,scrollHideDelay:i,scrollArea:s,viewport:l,onViewportChange:c,content:d,onContentChange:f,scrollbarX:h,onScrollbarXChange:v,scrollbarXEnabled:b,onScrollbarXEnabledChange:C,scrollbarY:p,onScrollbarYChange:g,scrollbarYEnabled:S,onScrollbarYEnabledChange:_,onCornerWidthChange:y,onCornerHeightChange:w,children:$.jsx(ke.div,{dir:R,...a,ref:k,style:{position:"relative","--radix-scroll-area-corner-width":m+"px","--radix-scroll-area-corner-height":x+"px",...e.style}})})});dC.displayName=vm;var fC="ScrollAreaViewport",hC=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,asChild:o,nonce:i,...a}=e,s=Un(fC,n),u=E.useRef(null),l=Me(t,u,s.onViewportChange);return $.jsxs($.Fragment,{children:[$.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),$.jsx(ke.div,{"data-radix-scroll-area-viewport":"",...a,asChild:o,ref:l,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e.style},children:PD({asChild:o,children:r},c=>$.jsx("div",{"data-radix-scroll-area-content":"",ref:s.onContentChange,style:{minWidth:s.scrollbarXEnabled?"fit-content":void 0},children:c}))})]})});hC.displayName=fC;var Mr="ScrollAreaScrollbar",xD=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,o=Un(Mr,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=o,s=e.orientation==="horizontal";return E.useEffect(()=>(s?i(!0):a(!0),()=>{s?i(!1):a(!1)}),[s,i,a]),o.type==="hover"?$.jsx(wD,{...r,ref:t,forceMount:n}):o.type==="scroll"?$.jsx(bD,{...r,ref:t,forceMount:n}):o.type==="auto"?$.jsx(pC,{...r,ref:t,forceMount:n}):o.type==="always"?$.jsx(mm,{...r,ref:t}):null});xD.displayName=Mr;var wD=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,o=Un(Mr,e.__scopeScrollArea),[i,a]=E.useState(!1);return E.useEffect(()=>{const s=o.scrollArea;let u=0;if(s){const l=()=>{window.clearTimeout(u),a(!0)},c=()=>{u=window.setTimeout(()=>a(!1),o.scrollHideDelay)};return s.addEventListener("pointerenter",l),s.addEventListener("pointerleave",c),()=>{window.clearTimeout(u),s.removeEventListener("pointerenter",l),s.removeEventListener("pointerleave",c)}}},[o.scrollArea,o.scrollHideDelay]),$.jsx(Li,{present:n||i,children:$.jsx(pC,{"data-state":i?"visible":"hidden",...r,ref:t})})}),bD=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,o=Un(Mr,e.__scopeScrollArea),i=e.orientation==="horizontal",a=Dd(()=>u("SCROLL_END"),100),[s,u]=gD("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(s==="idle"){const l=window.setTimeout(()=>u("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(l)}},[s,o.scrollHideDelay,u]),E.useEffect(()=>{const l=o.viewport,c=i?"scrollLeft":"scrollTop";if(l){let d=l[c];const f=()=>{const h=l[c];d!==h&&(u("SCROLL"),a()),d=h};return l.addEventListener("scroll",f),()=>l.removeEventListener("scroll",f)}},[o.viewport,i,u,a]),$.jsx(Li,{present:n||s!=="hidden",children:$.jsx(mm,{"data-state":s==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:ge(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:ge(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),pC=E.forwardRef((e,t)=>{const n=Un(Mr,e.__scopeScrollArea),{forceMount:r,...o}=e,[i,a]=E.useState(!1),s=e.orientation==="horizontal",u=Dd(()=>{if(n.viewport){const l=n.viewport.offsetWidth<n.viewport.scrollWidth,c=n.viewport.offsetHeight<n.viewport.scrollHeight;a(s?l:c)}},10);return Xa(n.viewport,u),Xa(n.content,u),$.jsx(Li,{present:r||i,children:$.jsx(mm,{"data-state":i?"visible":"hidden",...o,ref:t})})}),mm=E.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,o=Un(Mr,e.__scopeScrollArea),i=E.useRef(null),a=E.useRef(0),[s,u]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),l=yC(s.viewport,s.content),c={...r,sizes:s,onSizesChange:u,hasThumb:l>0&&l<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:f=>a.current=f};function d(f,h){return ID(f,a.current,s,h)}return n==="horizontal"?$.jsx(CD,{...c,ref:t,onThumbPositionChange:()=>{if(o.viewport&&i.current){const f=o.viewport.scrollLeft,h=w0(f,s,o.dir);i.current.style.transform=`translate3d(${h}px, 0, 0)`}},onWheelScroll:f=>{o.viewport&&(o.viewport.scrollLeft=f)},onDragScroll:f=>{o.viewport&&(o.viewport.scrollLeft=d(f,o.dir))}}):n==="vertical"?$.jsx(ED,{...c,ref:t,onThumbPositionChange:()=>{if(o.viewport&&i.current){const f=o.viewport.scrollTop,h=w0(f,s);i.current.style.transform=`translate3d(0, ${h}px, 0)`}},onWheelScroll:f=>{o.viewport&&(o.viewport.scrollTop=f)},onDragScroll:f=>{o.viewport&&(o.viewport.scrollTop=d(f))}}):null}),CD=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...o}=e,i=Un(Mr,e.__scopeScrollArea),[a,s]=E.useState(),u=E.useRef(null),l=Me(t,u,i.onScrollbarXChange);return E.useEffect(()=>{u.current&&s(getComputedStyle(u.current))},[u]),$.jsx(mC,{"data-orientation":"horizontal",...o,ref:l,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Nd(n)+"px",...e.style},onThumbPointerDown:c=>e.onThumbPointerDown(c.x),onDragScroll:c=>e.onDragScroll(c.x),onWheelScroll:(c,d)=>{if(i.viewport){const f=i.viewport.scrollLeft+c.deltaX;e.onWheelScroll(f),wC(f,d)&&c.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:Ic(a.paddingLeft),paddingEnd:Ic(a.paddingRight)}})}})}),ED=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...o}=e,i=Un(Mr,e.__scopeScrollArea),[a,s]=E.useState(),u=E.useRef(null),l=Me(t,u,i.onScrollbarYChange);return E.useEffect(()=>{u.current&&s(getComputedStyle(u.current))},[u]),$.jsx(mC,{"data-orientation":"vertical",...o,ref:l,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Nd(n)+"px",...e.style},onThumbPointerDown:c=>e.onThumbPointerDown(c.y),onDragScroll:c=>e.onDragScroll(c.y),onWheelScroll:(c,d)=>{if(i.viewport){const f=i.viewport.scrollTop+c.deltaY;e.onWheelScroll(f),wC(f,d)&&c.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:Ic(a.paddingTop),paddingEnd:Ic(a.paddingBottom)}})}})}),[SD,vC]=cC(Mr),mC=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:o,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:s,onThumbPositionChange:u,onDragScroll:l,onWheelScroll:c,onResize:d,...f}=e,h=Un(Mr,n),[v,p]=E.useState(null),g=Me(t,k=>p(k)),m=E.useRef(null),y=E.useRef(""),x=h.viewport,w=r.content-r.viewport,b=at(c),C=at(u),S=Dd(d,10);function _(k){if(m.current){const R=k.clientX-m.current.left,N=k.clientY-m.current.top;l({x:R,y:N})}}return E.useEffect(()=>{const k=R=>{const N=R.target;(v==null?void 0:v.contains(N))&&b(R,w)};return document.addEventListener("wheel",k,{passive:!1}),()=>document.removeEventListener("wheel",k,{passive:!1})},[x,v,w,b]),E.useEffect(C,[r,C]),Xa(v,S),Xa(h.content,S),$.jsx(SD,{scope:n,scrollbar:v,hasThumb:o,onThumbChange:at(i),onThumbPointerUp:at(a),onThumbPositionChange:C,onThumbPointerDown:at(s),children:$.jsx(ke.div,{...f,ref:g,style:{position:"absolute",...f.style},onPointerDown:ge(e.onPointerDown,k=>{k.button===0&&(k.target.setPointerCapture(k.pointerId),m.current=v.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",h.viewport&&(h.viewport.style.scrollBehavior="auto"),_(k))}),onPointerMove:ge(e.onPointerMove,_),onPointerUp:ge(e.onPointerUp,k=>{const R=k.target;R.hasPointerCapture(k.pointerId)&&R.releasePointerCapture(k.pointerId),document.body.style.webkitUserSelect=y.current,h.viewport&&(h.viewport.style.scrollBehavior=""),m.current=null})})})}),Rc="ScrollAreaThumb",_D=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,o=vC(Rc,e.__scopeScrollArea);return $.jsx(Li,{present:n||o.hasThumb,children:$.jsx(kD,{ref:t,...r})})}),kD=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...o}=e,i=Un(Rc,n),a=vC(Rc,n),{onThumbPositionChange:s}=a,u=Me(t,d=>a.onThumbChange(d)),l=E.useRef(),c=Dd(()=>{l.current&&(l.current(),l.current=void 0)},100);return E.useEffect(()=>{const d=i.viewport;if(d){const f=()=>{if(c(),!l.current){const h=TD(d,s);l.current=h,s()}};return s(),d.addEventListener("scroll",f),()=>d.removeEventListener("scroll",f)}},[i.viewport,c,s]),$.jsx(ke.div,{"data-state":a.hasThumb?"visible":"hidden",...o,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:ge(e.onPointerDownCapture,d=>{const h=d.target.getBoundingClientRect(),v=d.clientX-h.left,p=d.clientY-h.top;a.onThumbPointerDown({x:v,y:p})}),onPointerUp:ge(e.onPointerUp,a.onThumbPointerUp)})});_D.displayName=Rc;var gm="ScrollAreaCorner",gC=E.forwardRef((e,t)=>{const n=Un(gm,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?$.jsx(RD,{...e,ref:t}):null});gC.displayName=gm;var RD=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,o=Un(gm,n),[i,a]=E.useState(0),[s,u]=E.useState(0),l=!!(i&&s);return Xa(o.scrollbarX,()=>{var d;const c=((d=o.scrollbarX)==null?void 0:d.offsetHeight)||0;o.onCornerHeightChange(c),u(c)}),Xa(o.scrollbarY,()=>{var d;const c=((d=o.scrollbarY)==null?void 0:d.offsetWidth)||0;o.onCornerWidthChange(c),a(c)}),l?$.jsx(ke.div,{...r,ref:t,style:{width:i,height:s,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Ic(e){return e?parseInt(e,10):0}function yC(e,t){const n=e/t;return isNaN(n)?0:n}function Nd(e){const t=yC(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function ID(e,t,n,r="ltr"){const o=Nd(n),i=o/2,a=t||i,s=o-a,u=n.scrollbar.paddingStart+a,l=n.scrollbar.size-n.scrollbar.paddingEnd-s,c=n.content-n.viewport,d=r==="ltr"?[0,c]:[c*-1,0];return xC([u,l],d)(e)}function w0(e,t,n="ltr"){const r=Nd(t),o=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-o,a=t.content-t.viewport,s=i-r,u=n==="ltr"?[0,a]:[a*-1,0],l=du(e,u);return xC([0,a],[0,s])(l)}function xC(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function wC(e,t){return e>0&&e<t}var TD=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function o(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,s=n.top!==i.top;(a||s)&&t(),n=i,r=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(r)};function Dd(e,t){const n=at(e),r=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),E.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Xa(e,t){const n=at(t);mt(()=>{let r=0;if(e){const o=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return o.observe(e),()=>{window.cancelAnimationFrame(r),o.unobserve(e)}}},[e,n])}function PD(e,t){const{asChild:n,children:r}=e;if(!n)return typeof t=="function"?t(r):t;const o=E.Children.only(r);return E.cloneElement(o,{children:typeof t=="function"?t(o.props.children):t})}var h5=dC,p5=hC,v5=gC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bC=function(e,t){return(bC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function ar(e,t){function n(){this.constructor=e}bC(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function se(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(e,[])).next())})}function ue(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(d){c=[6,d],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var AD=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return ND(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function ND(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function G(){return CC}var CC=null,Tc=new Map,Ip=new Map;function EC(e,t){var n=_C(e,t);return Tc.get(n)}function DD(e){return Ip.get(e)}function b0(e){for(var t=Tc.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function SC(e){var t=e.kernelName,n=e.backendName,r=_C(t,n);if(Tc.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Tc.set(r,e)}function MD(e){var t=e.kernelName;Ip.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Ip.set(t,e)}function _C(e,t){return t+"_"+e}function Tp(e,t,n){return Math.max(e,Math.min(t,n))}function kC(e){return e%2==0?e:e+1}function FD(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function T(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function We(e,t,n){n===void 0&&(n=""),T(St(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function ls(e){T(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Ya(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Rr(e)&&!n)for(var r=0;r<e.length;++r)Ya(e[r],t,n);else t.push(e);return t}function ce(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function St(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function st(e){return e%1==0}function OD(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Pp(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Sa(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function C0(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function LD(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function xt(e,t){var n=t.length;return T((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),T(e.every(function(r){return st(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function fi(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||o?null:xt(t,e).sort(),a=0,s=0;s<e.length;++s){if(i!=null){if(i[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(i[a]==null||i[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function fu(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Pc(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function BD(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function WD(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function zD(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Rr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function RC(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function $D(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function ym(e){return typeof e=="string"||e instanceof String}function UD(e){return typeof e=="boolean"}function VD(e){return typeof e=="number"}function Nu(e){return Array.isArray(e)?Nu(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":VD(e)?"float32":ym(e)?"string":UD(e)?"bool":"float32"}function Ap(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Np(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Ir(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function IC(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ya(e)),n&&BD(e,t),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function E0(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),d=c.reduce(function(f,h){return f*h});for(l=0;l<u;l++)s[l]=r(o+l*d,c,a)}return s}(0,e,t)}function TC(e,t){for(var n=Du(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Du(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function xr(){return G().platform.now()}function PC(e){e.forEach(function(t){T(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function jD(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",G().platform.encode(e,t)}function Ac(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",G().platform.decode(e,t)}function S0(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function HD(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var GD=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new KD)}return e.prototype.profileKernel=function(t,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,d){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var h=l[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,t),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),o},e}(),KD=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,i,a){var s=typeof o=="number"?Sa(o+"ms",9):o.error,u=Sa(t,25),l=n.rank,c=n.size,d=Sa(n.shape.toString(),14),f="";for(var h in i){var v=i[h].shape||n.shape,p=v.length;f+=h+": "+p+"D "+(p>0?v:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),_0=20,Cs=3,Bf=7;function qD(e,t,n,r){var o=Ir(t),i=function(l,c,d,f){var h=ce(c),v=f[f.length-1],p=new Array(v).fill(0),g=c.length,m=d==="complex64"?Ss(l):l;if(g>1)for(var y=0;y<h/v;y++)for(var x=y*v,w=0;w<v;w++)p[w]=Math.max(p[w],Es(m[x+w],0,d).length);return p}(e,t,n,o),a=t.length,s=function l(c,d,f,h,v,p){p===void 0&&(p=!0);var g=f==="complex64"?2:1,m=d[0],y=d.length;if(y===0)return f==="complex64"?[Es(Ss(c)[0],0,f)]:f==="bool"?[AC(c[0])]:[c[0].toString()];if(y===1){if(m>_0){var x=Cs*g,w=Array.from(c.slice(0,x)),b=Array.from(c.slice((m-Cs)*g,m*g));return f==="complex64"&&(w=Ss(w),b=Ss(b)),["["+w.map(function(W,B){return Es(W,v[B],f)}).join(", ")+", ..., "+b.map(function(W,B){return Es(W,v[m-Cs+B],f)}).join(", ")+"]"]}return["["+(f==="complex64"?Ss(c):Array.from(c)).map(function(W,B){return Es(W,v[B],f)}).join(", ")+"]"]}var C=d.slice(1),S=h.slice(1),_=h[0]*g,k=[];if(m>_0){for(var R=0;R<Cs;R++){var N=(P=R*_)+_;k.push.apply(k,l(c.slice(P,N),C,f,S,v,!1))}for(k.push("..."),R=m-Cs;R<m;R++)N=(P=R*_)+_,k.push.apply(k,l(c.slice(P,N),C,f,S,v,R===m-1))}else for(R=0;R<m;R++){var P;N=(P=R*_)+_,k.push.apply(k,l(c.slice(P,N),C,f,S,v,R===m-1))}var L=y===2?",":"";for(k[0]="["+k[0]+L,R=1;R<k.length-1;R++)k[R]=" "+k[R]+L;var M=`,
`;for(R=2;R<y;R++)M+=`
`;return k[k.length-1]=" "+k[k.length-1]+"]"+(p?"":M),k}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Es(e,t,n){return Sa(Array.isArray(e)?parseFloat(e[0].toFixed(Bf))+" + "+parseFloat(e[1].toFixed(Bf))+"j":ym(e)?"'"+e+"'":n==="bool"?AC(e):parseFloat(e.toFixed(Bf)).toString(),t)}function AC(e){return e===0?"false":"true"}function Ss(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var hu=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=ce(t),r!=null){var i=r.length;T(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Pc(n,this.size),this.strides=Ir(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),T(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Cr().makeTensor(this.values,this.shape,this.dtype)},e}(),Cr=null,H=null,NC=null,Qe=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ce(t),this.strides=Ir(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,i){return this.throwIfDisposed(),this.reshape([t,n,r,o,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),H.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,H.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return H.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,E0(this.shape,t)]}})})},e.prototype.arraySync=function(){return E0(this.shape,this.dataSync())},e.prototype.data=function(){return se(this,void 0,void 0,function(){var t,n;return ue(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Cr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return Ac(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Cr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Ac(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Cr().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Cr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),H.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),H.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),H.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),H.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),H.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),H.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),H.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),qD(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),H.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),H.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),H.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),H.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),H.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),H.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),H.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),H.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),H.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),H.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),H.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),H.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,i){return r===void 0&&(r=.001),NC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,o,r)},e.prototype.batchNorm=function(t,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),H.batchNorm(this,t,n,r,o,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),H.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),H.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),H.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),H.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),H.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),H.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),H.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),H.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),H.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),H.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),H.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),H.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),H.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),H.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),H.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),H.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),H.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),H.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),H.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),H.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),H.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),H.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),H.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),H.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),H.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),H.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),H.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),H.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),H.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),H.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),H.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),H.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),H.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),H.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),H.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),H.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),H.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),H.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),H.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),H.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),H.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),H.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),H.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),H.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),H.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),H.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),H.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),H.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),H.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),H.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),H.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),H.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),H.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),H.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),H.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),H.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),H.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),H.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),H.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),H.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),H.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),H.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),H.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),H.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),H.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),H.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),H.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),H.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),H.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),H.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),H.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),H.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),H.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),H.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),H.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),H.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),H.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),H.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),H.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),H.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),H.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),H.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),H.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),H.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),H.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),H.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),H.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),H.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),H.conv1d(this,t,n,r,o,i,a)},e.prototype.conv2d=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),H.conv2d(this,t,n,r,o,i,a)},e.prototype.conv2dTranspose=function(t,n,r,o,i){return this.throwIfDisposed(),H.conv2dTranspose(this,t,n,r,o,i)},e.prototype.depthwiseConv2D=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),H.depthwiseConv2d(this,t,n,r,o,i,a)},e.prototype.separableConv2d=function(t,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),H.separableConv2d(this,t,n,r,o,i,a)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),H.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),H.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),H.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,i){return this.throwIfDisposed(),H.pool(this,t,n,r,o,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Cr().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),H.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),H.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),H.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),H.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),H.stridedSlice(this,t,n,r,o,i,a,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),H.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),H.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),H.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),H.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),H.spectral.irfft(this)},e}();Object.defineProperty(Qe,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var k0,Dp,Mp,Fp,Op,Qa=function(e){function t(n,r,o,i){var a=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return ar(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!St(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Cr().disposeTensor(this),this.dataId=n.dataId,Cr().incRef(this,null)},t.prototype.dispose=function(){Cr().disposeVariable(this),this.isDisposedInternal=!0},t}(Qe);Object.defineProperty(Qa,Symbol.hasInstance,{value:function(e){return e instanceof Qe&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(k0||(k0={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Dp||(Dp={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Mp||(Mp={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Fp||(Fp={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Op||(Op={}));var XD={float32:Fp,int32:Dp,bool:Mp,complex64:Op};function It(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return XD[e][t]}function Wf(e){return It(e,"int32")}function tt(e,t){if(e.dtype===t.dtype)return[e,t];var n=It(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function YD(e,t){T(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function DC(e){var t=[];return function n(r,o,i){if(r!=null){if(r instanceof Qe)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(e,t,new Set),t}var zf,R0=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),QD=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new R0}return e.prototype.ready=function(){return se(this,void 0,void 0,function(){var t,n,r;return ue(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return se(this,void 0,void 0,function(){var n,r,o;return ue(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new GD(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;b0(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;b0(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,i){return this.runKernelFunc(null,n,null,t,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(c=y.map(function(x){return l.keep(l.clone(x))}))},v=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=EC(o,this.backendName);return f=m!=null?function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:i,backend:l.backend});var x=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x);var w=x.map(function(C){var S=C.dataId,_=C.shape,k=C.dtype;return l.makeTensorFromDataId(S,_,k)}),b=w.filter(function(C,S){return s[S]});return h((a||[]).slice().concat(b)),w}:function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,h)});var x=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x),x},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=t;r==="string"&&ym(t[0])&&(i=t.map(function(c){return jD(c)}));var a=o.write(i,n,r),s=new Qe(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=$D(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var i=new Qe(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var i=new Qa(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*RC(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Qa||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return se(this,void 0,void 0,function(){var n,r;return ue(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},u=DD(t);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,d){if(c==null){var f=r[d],h=Du(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=DC(t),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,o){var i=this;if(o===void 0&&(o=!1),T(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});T(a instanceof Qe,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var d={},f={},h=0;h<l.length;h++)d[l[h].id]=!0;for(h=0;h<u.length;h++){var v=(C=u[h]).inputs;for(var p in v){for(var g=v[p],m=!1,y=0;y<l.length;y++)if(d[g.id]){C.outputs.forEach(function(R){return d[R.id]=!0}),m=!0,f[C.id]=!0;break}if(m)break}}var x={};x[c.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(v=(C=u[h]).inputs,y=0;y<C.outputs.length;y++)if(x[C.outputs[y].id]){for(var p in v)x[v[p].id]=!0,w[C.id]=!0;break}var b=[];for(h=0;h<u.length;h++){var C;if(f[(C=u[h]).id]&&w[C.id]){var S={};for(var p in C.inputs){var _=C.inputs[p];d[_.id]&&(S[p]=_)}var k=Object.assign({},C);k.inputs=S,k.outputs=C.outputs,b.push(k)}}return b}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=TC(ce(u),"float32"),O.makeTensor(l,u,"float32")),function(f,h,v){for(var p=function(m){var y=h[m],x=[];if(y.outputs.forEach(function(S){var _=f[S.id];_!=null?x.push(_):x.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(x),b=function(S){if(!(S in w))throw new Error("Cannot backprop through input "+S+". Available gradients found: "+Object.keys(w)+".");var _=v(function(){return w[S]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+S+" must have 'float32' dtype, but has '"+_.dtype+"'");var k=y.inputs[S];if(!St(_.shape,k.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+S+"' has shape '"+_.shape+"', which does not match the shape of the input '"+k.shape+"'");if(f[k.id]==null)f[k.id]=_;else{var R=f[k.id];f[k.id]=R.add(_),R.dispose()}};for(var C in y.inputs)b(C)},g=h.length-1;g>=0;g--)p(g)}(c,s,function(f){return i.tidy(f)});var d=n.map(function(f){return c[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,v=f.saved;h<v.length;h++)v[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},e.prototype.customGrad=function(t){var n=this;return T(Ap(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];T(o.every(function(s){return s instanceof Qe}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return T((r=t.apply(void 0,o.concat([u]))).value instanceof Qe,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),T(Ap(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];T(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),T(c.every(function(f){return f instanceof Qe}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return se(this,void 0,void 0,function(){var n,r;return ue(this,function(o){switch(o.label){case 0:return n=xr(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=xr()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new R0,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),O=function(){var e=function(){if(zf==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}zf=n}return zf}();if(e._tfengine==null){var t=new AD(e);e._tfengine=new QD(t)}return function(n){CC=n}(e._tfengine.ENV),Cr=function(){return e._tfengine},e._tfengine}();function MC(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Wr=G();Wr.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Wr.registerFlag("IS_BROWSER",function(){return MC()}),Wr.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Wr.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Wr.registerFlag("PROD",function(){return!1}),Wr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Wr.getBool("DEBUG")}),Wr.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Wr.registerFlag("IS_TEST",function(){return!1});var pu,wn,yn,ci={},$f={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function JD(e,t){ci[e]=t}function Fr(e){e in ci||(ci[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete ci[n]},!1),n===1?r.getContext("webgl",$f)||r.getContext("experimental-webgl",$f):r.getContext("webgl2",$f)}(e));var t=ci[e];return t.isContextLost()?(delete ci[e],Fr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ci[e])}function Md(e,t){return[t,e]}function zs(e){var t=ce(e);return Pp(Math.ceil(t/4))}function Mu(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function xm(e,t){var n,r,o,i,a,s,u,l,c,d=e;return G().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=d.RGBA,a=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function de(e,t,n){var r=n();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+n3(o,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(pu||(pu={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(wn||(wn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(yn||(yn={}));var ZD=596e-10,e3=65504;function t3(e){return!!(G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||ZD<Math.abs(e)&&Math.abs(e)<e3)}function n3(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function yl(e,t,n){return no(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function r3(e,t,n){var r=no(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(de(e,t,function(){return e.shaderSource(r,n)}),de(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function o3(e,t,n){var r=no(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(de(e,t,function(){return e.shaderSource(r,n)}),de(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,i){var a=i3.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,m){return Sa((m+1).toString(),l)+g}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,s-1),v=c.slice(s-1,s),p=c.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+Sa(v[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Uf,Vf,i3=/ERROR: [0-9]+:([0-9]+):/g;function a3(e,t){return no(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function s3(e,t,n){if(de(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function jf(e,t,n){if(de(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function u3(e,t,n){var r=no(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return de(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),de(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function l3(e,t,n){var r=no(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return de(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),de(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function c3(e,t){return no(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function d3(e,t){var n=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function f3(e,t){return no(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function I0(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return u!==-1&&(de(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),de(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)}),de(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function h3(e,t,n,r){y3(e,r),de(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),de(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function p3(e,t,n,r){return no(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function v3(e,t,n){return e.getUniformLocation(t,n)}function m3(e,t,n,r,o,i){de(e,t,function(){return h3(e,t,r,i)}),de(e,t,function(){return e.uniform1i(o,i)})}function Hf(e,t,n,r){de(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),de(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function T0(e,t,n){de(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),de(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function xl(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+g3(e,t))}function g3(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function no(e,t,n,r){var o=de(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function y3(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function Nc(e,t){return t===void 0&&(t=2),ce(e.slice(0,e.length-t))}function Dc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Gf(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Nc(e)].concat(Dc(e))),t}function x3(e,t){var n;t===void 0&&(t=!1);var r=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?kC(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=fi(e);e=o.newShape}var i=ce(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=Nc(e),s=2,u=2;return e.length&&(s=(n=Dc(e))[0],u=n[1]),Pp(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return Pp(i)}function wl(e){return e%2==0}function bl(e,t){if(St(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||wl(n)&&wl(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&wl(e[0])&&wl(t[0])}function w3(e){if(Uf==null){var t=Fr(e);Uf=t.getParameter(t.MAX_TEXTURE_SIZE)}return Uf}function b3(e){if(Vf==null){var t=Fr(e);Vf=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Vf)}function C3(e){if(e===0)return 0;var t=Fr(e);return Ln(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Ln(t,"EXT_disjoint_timer_query")?1:0}function Ln(e,t){return e.getExtension(t)!=null}function P0(e){try{if(Fr(e)!=null)return!0}catch{return!1}return!1}function E3(e){if(e===0)return!1;var t=Fr(e);if(e===1){if(!Ln(t,"OES_texture_float"))return!1}else if(!Ln(t,"EXT_color_buffer_float"))return!1;return Lp(t)}function S3(e){if(e===0)return!1;var t=Fr(e);if(e!==1){if(Ln(t,"EXT_color_buffer_float"))return Lp(t);if(Ln(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=xm(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!Ln(t,"OES_texture_float")&&!!Ln(t,"WEBGL_color_buffer_float")&&Lp(t)}function Lp(e){var t=xm(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function _3(e){return e===2&&Fr(e).fenceSync!=null}var xe=G();function FC(e){G().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function re(e,t){return O.tidy(e,t)}function an(e){DC(e).forEach(function(t){return t.dispose()})}function k3(e){return O.keep(e)}function Mc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];G().getBool("IS_TEST")||console.warn.apply(console,e)}function ni(e,t){var n=e;if(Rr(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Rr(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&G().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!Rr(i))return void T(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});T(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),T(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(e,r,[]),r}function A0(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function I(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Qe)return A0(r,e.dtype,t,n),e;var o=Nu(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),A0(r,o,t,n),e==null||!Rr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=ni(e,o);Rr(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?IC(e,o,G().getBool("DEBUG")):Ya(e,[],!0);return O.makeTensor(s,a,o)}function Fc(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return I(o,t+"["+i+"]",n)},r)}function OC(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function R3(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[i++]):o.push(t[a++]);return o}function Ot(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(i){return e[i]})]}function un(e,t){return R3(e,t.map(function(n){return 1}),t)}function mn(e,t,n){T(OC(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Or(e,t){if(OC(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function wm(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Lr(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function I3(e,t){var n=e[0].length;e.forEach(function(o,i){T(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),T(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<n;a++)T(a===t||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Ja(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function D(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];O.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),O.endScope(s),s}catch(u){throw O.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}xe.registerFlag("HAS_WEBGL",function(){return xe.getNumber("WEBGL_VERSION")>0}),xe.registerFlag("WEBGL_VERSION",function(){return P0(2)?2:P0(1)?1:0}),xe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return xe.get("WEBGL_VERSION")===2}),xe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),xe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),xe.registerFlag("WEBGL_PACK",function(){return xe.getBool("HAS_WEBGL")}),xe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_PACK_CLIP",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),xe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_PACK_REDUCE",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_CONV_IM2COL",function(){return xe.getBool("WEBGL_PACK")}),xe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return w3(xe.getNumber("WEBGL_VERSION"))}),xe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return b3(xe.getNumber("WEBGL_VERSION"))}),xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=xe.getNumber("WEBGL_VERSION");return e===0?0:C3(e)}),xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return xe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),xe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return E3(xe.getNumber("WEBGL_VERSION"))}),xe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!xe.getBool("WEBGL_FORCE_F16_TEXTURES")&&xe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),xe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return S3(xe.getNumber("WEBGL_VERSION"))}),xe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return _3(xe.getNumber("WEBGL_VERSION"))}),xe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return xe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),NC=FC;var Rt=D({complex_:function(e,t){var n=I(e,"real","complex"),r=I(t,"imag","complex");return We(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),O.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),Fn=D({real_:function(e){var t=I(e,"input","real");return O.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Er=D({imag_:function(e){var t=I(e,"input","imag");return O.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Tt(e,t,n){return ri(e,t,ni(e,n),n)}function ri(e,t,n,r){if(r==null&&(r=Nu(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Rr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){PC(t);var o=ce(t),i=ce(n);T(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==ce(t.slice(a));T(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Rr(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?IC(e,r,G().getBool("DEBUG")):Ya(e,[],!0),O.makeTensor(e,t,r)}function ee(e,t){if((Rr(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Rr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ri(e,[],[],t)}function lt(e,t){ls(e);var n=ni(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ri(e,null,n,t)}function $o(e,t,n){if(ls(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=ni(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ri(e,t,r,n)}function bm(e,t,n){if(ls(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=ni(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ri(e,t,r,n)}function Zt(e,t,n){if(ls(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=ni(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ri(e,t,r,n)}function T3(e,t,n){if(ls(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=ni(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ri(e,t,r,n)}function P3(e,t,n){if(ls(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=ni(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ri(e,t=t||r,r,n)}function A3(e,t,n,r){return t===void 0&&(t=!0),O.makeVariable(e,t,n,r)}function cs(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=cs(e,"float32"),r=Ke(e,"float32");return Rt(n,r)}var o=TC(ce(e),t);return O.makeTensor(o,e,t)}function Ke(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Ke(e,"float32"),r=Ke(e,"float32");return Rt(n,r)}var o=Du(ce(e),t);return O.makeTensor(o,e,t)}function Tr(e,t,n){return O.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function N3(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return O.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Oc(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Ke([0],r);var o=Du(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return lt(o,r)}var LC=D({onesLike_:function(e){var t=I(e,"x","onesLike");if(t.dtype==="complex64"){var n=LC(Fn(t)),r=Ne(Er(t));return Rt(n,r)}return O.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return Ne(o)}}})}}),Ne=D({zerosLike_:function(e){var t=I(e,"x","zerosLike");return O.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Ne(n)}}})}}),pt=D({concat_:function(e,t){t===void 0&&(t=0),T(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Fc(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=xt(t,n[0].shape)[0];var r=Ja(n.map(function(s){return s.shape}),t);if(ce(r)===0)return Tt([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});I3(o,t);var i=n,a={axis:t};return O.runKernelFunc(function(s){return s.concat(n,t)},i,function(s){var u=o.map(function(l){return l[t]});return Cm(s,u,t).map(function(l){return function(){return l}})},"Concat",a)}}),D3=D({concat1d_:function(e){return pt(e,0)}}),M3=D({concat2d_:function(e,t){return pt(e,t)}}),F3=D({concat3d_:function(e,t){return pt(e,t)}}),O3=D({concat4d_:function(e,t){return pt(e,t)}}),Cm=D({split_:function(e,t,n){n===void 0&&(n=0);var r,o=I(e,"x","split");return n=xt(n,o.shape)[0],typeof t=="number"?(T(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(T(o.shape[n]===t.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),O.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return pt(i,n)}}})}});function Bi(e,t){return e(t={exports:{}},t.exports),t.exports}var L3=Bi(function(e){(function(t,n,r){function o(s){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,e)}),B3=Bi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,e)}),W3=Bi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,e)}),z3=Bi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.x&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,e)}),$3=Bi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,c=f[h+34&127],l=f[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[h]=c^l,u.i=h,c+(d^d>>>16)|0},function(l,c){var d,f,h,v,p,g=[],m=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,m=Math.max(m,c.length)),h=0,v=-32;v<m;++v)c&&(f^=c.charCodeAt((v+32)%c.length)),v===0&&(p=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(p=p+1640531527|0,h=(d=g[127&v]^=f+p)==0?h+1:0);for(h>=128&&(g[127&(c&&c.length||0)]=-1),h=127,v=512;v>0;--v)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;l.w=p,l.X=g,l.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.X&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,e)}),U3=Bi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,v=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^v,v=v-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^v,u.a=v-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,e)}),di=Bi(function(e){(function(t,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,d=i-1;function f(m,y,x){var w=[],b=p(function _(k,R){var N,P=[],L=typeof k;if(R&&L=="object")for(N in k)try{P.push(_(k[N],R-1))}catch{}return P.length?P:L=="string"?k:k+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[m,g(t)]:m??function(){try{var _;return r&&(_=r.randomBytes)?_=_(i):(_=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(_)),g(_)}catch{var k=o.navigator,R=k&&k.plugins;return[+new Date,o,R,o.screen,g(t)]}}(),3),w),C=new h(w),S=function(){for(var _=C.g(a),k=u,R=0;_<l;)_=(_+R)*i,k*=i,R=C.g(1);for(;_>=c;)_/=2,k/=2,R>>>=1;return(_+R)/k};return S.int32=function(){return 0|C.g(4)},S.quick=function(){return C.g(4)/4294967296},S.double=S,p(g(C.S),t),(y.pass||x||function(_,k,R,N){return N&&(N.S&&v(N,C),_.state=function(){return v(C,{})}),R?(n[s]=_,k):_})(S,b,"global"in y?y.global:this==n,y.state)}function h(m){var y,x=m.length,w=this,b=0,C=w.i=w.j=0,S=w.S=[];for(x||(m=[x++]);b<i;)S[b]=b++;for(b=0;b<i;b++)S[b]=S[C=d&C+m[b%x]+(y=S[b])],S[C]=y;(w.g=function(_){for(var k,R=0,N=w.i,P=w.j,L=w.S;_--;)k=L[N=d&N+1],R=R*i+L[d&(L[N]=L[P=d&P+k])+(L[P]=k)];return w.i=N,w.j=P,R})(i)}function v(m,y){return y.i=m.i,y.j=m.j,y.S=m.S.slice(),y}function p(m,y){for(var x,w=m+"",b=0;b<w.length;)y[d&b]=d&(x^=19*y[d&b])+w.charCodeAt(b++);return g(y)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=f,p(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});di.alea=L3,di.xor128=B3,di.xorwow=W3,di.xorshift7=z3,di.xor4096=$3,di.tychei=U3;var Fd=di.alea,Em=function(){function e(t,n,r,o,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Fd(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),V3=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=Fd(i.toString()),this.randn=new Em(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),j3=function(){function e(t,n,r,o){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Fd(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function be(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",PC(e),new hu(e,t,n)}function H3(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var BC=D({batchToSpaceND_:function(e,t,n){var r=I(e,"x","batchToSpaceND"),o=t.reduce(function(i,a){return i*a});return T(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),T(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),T(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),O.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),G3=D({broadcastTo_:function(e,t){var n=I(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():O.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),K3=D({cast_:function(e,t){var n=I(e,"x","cast");if(!WD(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return O.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),q3=D({clone_:function(e){var t=I(e,"x","clone",null);return O.runKernelFunc(function(){return O.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),X3=D({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=I(e,"x","cumsum"),i=Or([t|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Lr(1,o.rank)[0],u=O.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),Y3=D({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=I(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return T(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),T(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),T(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),O.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Mn=D({expandDims_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","expandDims",null);T(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(T(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Zn(n,r)}}),WC=D({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=be([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return _a(Mn(s,0),[n[0],1,1]);if(n.length===2)return _a(Mn(Mn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return _a(Mn(Mn(Mn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Q3=D({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=I(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=O.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return a===1?u.as1D():u}}),Bp=D({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=I(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),O.runKernelFunc(function(a){return a.oneHot(o,t,n,r)},{$indices:o},function(a){return{$indices:function(){return Ke(o.shape,"float32")}}}).reshape(i)}}),Wi=D({pad_:function(e,t,n){n===void 0&&(n=0);var r=I(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return O.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var a=t.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),J3=D({pad1d_:function(e,t,n){return n===void 0&&(n=0),T(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Wi(e,[t],n)}}),Z3=D({pad2d_:function(e,t,n){return n===void 0&&(n=0),T(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Wi(e,t,n)}}),eM=D({pad3d_:function(e,t,n){return n===void 0&&(n=0),T(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Wi(e,t,n)}}),tM=D({pad4d_:function(e,t,n){return n===void 0&&(n=0),T(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Wi(e,t,n)}}),nM=D({rand_:function(e,t,n){var r=ce(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return O.makeTensor(o,e,n)}}),rM=D({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Em(t,n,r,!1,o),a=be(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),oM=D({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new V3(t,n,r,o),a=be(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),zC=D({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=be(e,r),a=new j3(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Zn=D({reshape_:function(e,t){var n=I(e,"x","reshape",null);t=LD(t,n.size),T(n.size===ce(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return O.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),$C=D({spaceToBatchND_:function(e,t,n){var r=I(e,"x","spaceToBatchND");return T(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),T(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),T(r.shape.reduce(function(o,i,a){return a>0&&a<=t.length?o&&(i+n[a-1][0]+n[a-1][1])%t[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),O.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),UC=D({squeeze_:function(e,t){var n=I(e,"x","squeeze");return Zn(n,fi(n.shape,t).newShape)}}),_n=D({stack_:function(e,t){t===void 0&&(t=0);var n=Fc(e,"tensors","stack");if(T(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;T(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){We(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){T(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return pt(a,t)}}),_a=D({tile_:function(e,t){var n=I(e,"x","tile",null);T(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return O.runKernelFunc(function(i,a){var s=i.tile(n,t);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Ne(s);if(s.rank===1)for(var l=0;l<t[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var d=0;d<t[2];++d)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),iM=D({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Em(t,n,r,!0,o),a=be(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),vt=D({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=I(e,"x","unstack");T(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return O.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return _n(o,t)}}},"Unpack",r)}}),aM=function(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return ue(this,function(f){switch(f.label){case 0:return n=I(e,"x","setdiff1d"),r=I(t,"y","setdiff1d"),T(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),T(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),T(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new hu([s],n.dtype),l=new hu([s],"int32"),c=0,d=0;c<o.length;c++)a.has(o[c])||(u.values[d]=o[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})};function Lc(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function Bc(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Wc(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function VC(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function jC(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function HC(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=Ir(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var GC=30;function Kf(e){return e<=GC?e:Np(e,Math.floor(Math.sqrt(e)))}function sM(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function uM(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}sM(n,t,e)}function zc(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:ce(t.shape)/u,sliceSize:a,strides:Ir(n.slice(0,o)).concat([1]),outputSize:ce(n)}}function lM(e,t,n){T(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),T(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){T(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function N0(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Sm(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function cM(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=Tp(0,i,s-1)}function dM(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?Tp(0,i,s):Tp(-1,i,s-1)}function KC(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function qC(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function fM(e,t){T(Ap(e),function(){return"The f passed in variableGrads(f) must be a function"}),T(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Qa}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],O.registeredVariables)t.push(O.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,i=t.length;T((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=O.gradients(e,t,null,!0),s=a.value,u=a.grads;T(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),T(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,d){u[d]!=null&&(l[c.name]=u[d])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function Od(e){return O.customGrad(e)}var ro=D({softmax_:function(e,t){t===void 0&&(t=-1);var n=I(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return O.runKernelFunc(function(r,o){var i=r.softmax(n,t);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),hM=D({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=I(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Od(function(r,o){var i=r.max(t,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),XC=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),YC=function(){function e(){}return e.prototype.time=function(t){return V("time")},e.prototype.read=function(t){return V("read")},e.prototype.readSync=function(t){return V("readSync")},e.prototype.numDataIds=function(){return V("numDataIds")},e.prototype.disposeData=function(t){return V("disposeData")},e.prototype.write=function(t,n,r){return V("write")},e.prototype.move=function(t,n,r,o){return V("move")},e.prototype.memory=function(){return V("memory")},e.prototype.floatPrecision=function(){return V("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return V("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,V("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return V("slice")},e.prototype.stridedSlice=function(t,n,r,o){return V("stridedSlice")},e.prototype.unstack=function(t,n){return V("unstack")},e.prototype.reverse=function(t,n){return V("reverse")},e.prototype.concat=function(t,n){return V("concat")},e.prototype.neg=function(t){return V("neg")},e.prototype.add=function(t,n){return V("add")},e.prototype.addN=function(t){return V("addN")},e.prototype.subtract=function(t,n){return V("subtract")},e.prototype.multiply=function(t,n){return V("multiply")},e.prototype.realDivide=function(t,n){return V("realDivide")},e.prototype.floorDiv=function(t,n){return V("floorDiv")},e.prototype.sum=function(t,n){return V("sum")},e.prototype.prod=function(t,n){return V("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return V("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return V("argMin")},e.prototype.argMax=function(t,n){return V("argMax")},e.prototype.equal=function(t,n){return V("equal")},e.prototype.notEqual=function(t,n){return V("notEqual")},e.prototype.less=function(t,n){return V("less")},e.prototype.lessEqual=function(t,n){return V("lessEqual")},e.prototype.greater=function(t,n){return V("greater")},e.prototype.greaterEqual=function(t,n){return V("greaterEqual")},e.prototype.logicalNot=function(t){return V("logicalNot")},e.prototype.logicalAnd=function(t,n){return V("logicalAnd")},e.prototype.logicalOr=function(t,n){return V("logicalOr")},e.prototype.where=function(t){return V("where")},e.prototype.select=function(t,n,r){return V("select")},e.prototype.topk=function(t,n,r){return V("topk")},e.prototype.min=function(t,n){return V("min")},e.prototype.minimum=function(t,n){return V("minimum")},e.prototype.mod=function(t,n){return V("mod")},e.prototype.max=function(t,n){return V("max")},e.prototype.maximum=function(t,n){return V("maximum")},e.prototype.all=function(t,n){return V("all")},e.prototype.any=function(t,n){return V("any")},e.prototype.squaredDifference=function(t,n){return V("squaredDifference")},e.prototype.ceil=function(t){return V("ceil")},e.prototype.floor=function(t){return V("floor")},e.prototype.round=function(t){return V("round")},e.prototype.sign=function(t){return V("sign")},e.prototype.isNaN=function(t){return V("isNaN")},e.prototype.isInf=function(t){return V("isInf")},e.prototype.isFinite=function(t){return V("isFinite")},e.prototype.pow=function(t,n){return V("pow")},e.prototype.exp=function(t){return V("exp")},e.prototype.expm1=function(t){return V("expm1")},e.prototype.softmax=function(t,n){return V("softmax")},e.prototype.log=function(t){return V("log")},e.prototype.log1p=function(t){return V("log1p")},e.prototype.sqrt=function(t){return V("sqrt")},e.prototype.rsqrt=function(t){return V("rsqrt")},e.prototype.square=function(t){return V("square")},e.prototype.reciprocal=function(t){return V("reciprocal")},e.prototype.relu=function(t){return V("relu")},e.prototype.relu6=function(t){return V("relu6")},e.prototype.prelu=function(t,n){return V("prelu")},e.prototype.elu=function(t){return V("elu")},e.prototype.eluDer=function(t,n){return V("eluDer")},e.prototype.selu=function(t){return V("selu")},e.prototype.int=function(t){return V("int")},e.prototype.clip=function(t,n,r){return V("clip")},e.prototype.abs=function(t){return V("abs")},e.prototype.complexAbs=function(t){return V("complexAbs")},e.prototype.sigmoid=function(t){return V("sigmoid")},e.prototype.softplus=function(t){return V("softplus")},e.prototype.sin=function(t){return V("sin")},e.prototype.cos=function(t){return V("cos")},e.prototype.tan=function(t){return V("tan")},e.prototype.asin=function(t){return V("asin")},e.prototype.acos=function(t){return V("acos")},e.prototype.atan=function(t){return V("atan")},e.prototype.atan2=function(t,n){return V("atan2")},e.prototype.sinh=function(t){return V("sinh")},e.prototype.cosh=function(t){return V("cosh")},e.prototype.tanh=function(t){return V("tanh")},e.prototype.asinh=function(t){return V("asinh")},e.prototype.acosh=function(t){return V("acosh")},e.prototype.atanh=function(t){return V("atanh")},e.prototype.erf=function(t){return V("erf")},e.prototype.step=function(t,n){return V("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,V("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return V("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return V("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return V("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,V("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return V("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return V("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return V("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return V("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return V("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return V("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return V("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return V("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return V("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return V("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return V("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return V("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return V("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return V("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return V("reshape")},e.prototype.cast=function(t,n){return V("cast")},e.prototype.tile=function(t,n){return V("tile")},e.prototype.pad=function(t,n,r){return V("pad")},e.prototype.transpose=function(t,n){return V("transpose")},e.prototype.gather=function(t,n,r){return V("gather")},e.prototype.gatherND=function(t,n){return V("gatherND")},e.prototype.scatterND=function(t,n,r){return V("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return V("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return V("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return V("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return V("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return V("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return V("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,i,a){return V("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,i){return V("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,i,a,s){return V("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return V("multinomial")},e.prototype.oneHot=function(t,n,r,o){return V("oneHot")},e.prototype.cumsum=function(t,n,r,o){return V("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,i){return V("nonMaxSuppression")},e.prototype.fft=function(t){return V("fft")},e.prototype.ifft=function(t){return V("ifft")},e.prototype.complex=function(t,n){return V("complex")},e.prototype.real=function(t){return V("real")},e.prototype.imag=function(t){return V("imag")},e.prototype.cropAndResize=function(t,n,r,o,i,a){return V("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return V("depthToSpace")},e.prototype.split=function(t,n,r){return V("split")},e.prototype.sparseToDense=function(t,n,r,o){return V("sparseToDense")},e.prototype.diag=function(t){return V("diag")},e.prototype.fill=function(t,n,r){return V("fill")},e.prototype.onesLike=function(t){return V("onesLike")},e.prototype.zerosLike=function(t){return V("zerosLike")},e.prototype.linspace=function(t,n,r){return V("linspace")},e.prototype.dispose=function(){return V("dispose")},e}();function V(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Po(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function gt(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Ie(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];i==null&&(i=1);var a=t[t.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function vu(e,t,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=Vc(t),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return zi(e,s,n,r,o,i,!1,a)}function $c(e,t,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=Wp(t),c=l[0],d=l[1],f=l[2];if(a==="NDHWC")u="channelsLast",s=[c,d,f,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,d,f,e[1],e[1]]}return Uc(e,s,n,r,o,!1,u,i)}function zi(e,t,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if(s==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],f=e[1],c=e[2],d=e[3]}var h,v=t[0],p=t[1],g=t[3],m=Vc(n),y=m[0],x=m[1],w=Vc(r),b=w[0],C=w[1],S=ka(v,b),_=ka(p,C),k=function(M,W,B,z,A,F,U,j){var K,Y,ne;if(typeof M=="number"){K={top:M,bottom:M,left:M,right:M,type:M===0?"VALID":"NUMBER"};var pe=function(ie,le,ye,Pe,Fe){Pe==null&&(Pe=QC(ie,le,ye));var Ae=ie[0],wt=ie[1],Yt=$s((Ae-le+2*Pe)/ye+1,Fe);T(st(Yt),function(){return"The output # of rows ("+Yt+") must be an integer. Change the stride and/or zero pad parameters"});var Oe=$s((wt-le+2*Pe)/ye+1,Fe);return T(st(Oe),function(){return"The output # of columns ("+Oe+") must be an integer. Change the stride and/or zero pad parameters"}),[Yt,Oe]}([W,B],F,z,M,j);Y=pe[0],ne=pe[1]}else if(M==="same"){Y=Math.ceil(W/z),ne=Math.ceil(B/A);var te=Math.max(0,(Y-1)*z+F-W),J=Math.max(0,(ne-1)*A+U-B),oe=Math.floor(te/2),ve=te-oe,me=Math.floor(J/2);K={top:oe,bottom:ve,left:me,right:J-me,type:"SAME"}}else{if(M!=="valid")throw Error("Unknown padding parameter: "+M);K={top:0,bottom:0,left:0,right:0,type:"VALID"},Y=Math.ceil((W-F+1)/z),ne=Math.ceil((B-U+1)/A)}return{padInfo:K,outHeight:Y,outWidth:ne}}(o,c,d,y,x,S,_,i),R=k.padInfo,N=k.outHeight,P=k.outWidth,L=a?g*f:g;return s==="channelsFirst"?h=[l,L,N,P]:s==="channelsLast"&&(h=[l,N,P,L]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:N,outWidth:P,outChannels:L,padInfo:R,strideHeight:y,strideWidth:x,filterHeight:v,filterWidth:p,effectiveFilterHeight:S,effectiveFilterWidth:_,dilationHeight:b,dilationWidth:C,inShape:e,outShape:h,filterShape:t}}function Uc(e,t,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3],h=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=e[0],h=e[1],c=e[2],d=e[3],f=e[4]}var v,p=t[0],g=t[1],m=t[2],y=t[4],x=Wp(n),w=x[0],b=x[1],C=x[2],S=Wp(r),_=S[0],k=S[1],R=S[2],N=ka(p,_),P=ka(g,k),L=ka(m,R),M=function(U,j,K,Y,ne,pe,te,J,oe,ve,me){var ie,le,ye,Pe;if(typeof U=="number"){ie={top:U,bottom:U,left:U,right:U,front:U,back:U,type:U===0?"VALID":"NUMBER"};var Fe=function(uo,Pn,ii,dn,fn,lr){fn==null&&(fn=QC(uo,Pn,dn));var Uu=uo[0],Qd=uo[1],Vu=uo[2],Vi=$s((Uu-Pn+2*fn)/dn+1,lr);T(st(Vi),function(){return"The output # of depths ("+Vi+") must be an integer. Change the stride and/or zero pad parameters"});var ds=$s((Qd-Pn+2*fn)/dn+1,lr);T(st(ds),function(){return"The output # of rows ("+ds+") must be an integer. Change the stride and/or zero pad parameters"});var ai=$s((Vu-Pn+2*fn)/dn+1,lr);return T(st(ai),function(){return"The output # of columns ("+ai+") must be an integer. Change the stride and/or zero pad parameters"}),[Vi,ds,ai,ii]}([j,K,Y,1],J,1,ne,U,me);le=Fe[0],ye=Fe[1],Pe=Fe[2]}else if(U==="same"){le=Math.ceil(j/ne),ye=Math.ceil(K/pe),Pe=Math.ceil(Y/te);var Ae=(le-1)*ne+J-j,wt=(ye-1)*pe+oe-K,Yt=(Pe-1)*te+ve-Y,Oe=Math.floor(Ae/2),cn=Ae-Oe,jn=Math.floor(wt/2),ur=wt-jn,Qt=Math.floor(Yt/2);ie={top:jn,bottom:ur,left:Qt,right:Yt-Qt,front:Oe,back:cn,type:"SAME"}}else{if(U!=="valid")throw Error("Unknown padding parameter: "+U);ie={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},le=Math.ceil((j-J+1)/ne),ye=Math.ceil((K-oe+1)/pe),Pe=Math.ceil((Y-ve+1)/te)}return{padInfo:ie,outDepth:le,outHeight:ye,outWidth:Pe}}(o,c,d,f,w,b,C,N,P,L,s),W=M.padInfo,B=M.outDepth,z=M.outHeight,A=M.outWidth,F=i?y*h:y;return a==="channelsFirst"?v=[l,F,B,z,A]:a==="channelsLast"&&(v=[l,B,z,A,F]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:B,outHeight:z,outWidth:A,outChannels:F,padInfo:W,strideDepth:w,strideHeight:b,strideWidth:C,filterDepth:p,filterHeight:g,filterWidth:m,effectiveFilterDepth:N,effectiveFilterHeight:P,effectiveFilterWidth:L,dilationDepth:_,dilationHeight:k,dilationWidth:R,inShape:e,outShape:v,filterShape:t}}function QC(e,t,n,r){r===void 0&&(r=1);var o=ka(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function Vc(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Wp(e){return typeof e=="number"?[e,e,e]:e}function ka(e,t){return t<=1?e:e+(e-1)*(t-1)}function $s(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Za(e){var t=Vc(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function ln(e,t){return Za(e)||Za(t)}function _m(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function JC(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Ke(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!zD(e.dtype,t))return O.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var s=ee(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function zp(e,t){return O.makeTensorFromDataId(e.dataId,t,e.dtype)}function ZC(e,t,n){var r=(t-e)/(n-1),o=Du(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return lt(o,"float32")}function $p(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function D0(e,t){return{real:e[2*t],imag:e[2*t+1]}}function pM(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function vM(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function mM(e,t,n){var r=function(i,a,s){return function(u,l,c){for(var d=0,f=u.length,h=0,v=!1;d<f;){var p=c(l,u[h=d+(f-d>>>1)]);p>0?d=h+1:(f=h,v=!p)}return v?d:-d-1}(i,a,s||gM)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function gM(e,t){return e>t?1:e<t?-1:0}function km(e,t,n,r,o){return eE(e,t,n,r,o,0).selectedIndices}function Rm(e,t,n,r,o,i){var a=eE(e,t,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function eE(e,t,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(w,b){return{score:w,boxIndex:b,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort(M0),l=i>0?-.5/i:0,c=[],d=[];c.length<n&&u.length>0;){var f=u.pop(),h=f.score,v=f.boxIndex,p=f.suppressBeginIndex;if(h<o)break;for(var g=!1,m=c.length-1;m>=p;--m){var y=yM(e,v,c[m]);if(y>=r){g=!0;break}if(f.score=f.score*xM(r,l,y),f.score<=o)break}f.suppressBeginIndex=c.length,g||(f.score===h?(c.push(v),d.push(f.score)):f.score>o&&mM(u,f,M0))}var x=c.length;return s&&(c.fill(0,x),d.fill(0,x)),{selectedIndices:lt(c,"int32"),selectedScores:lt(d,"float32"),numValidOutputs:ee(x,"int32")}}function yM(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),v=(d-l)*(f-c);if(h<=0||v<=0)return 0;var p=Math.max(i,l),g=Math.max(a,c),m=Math.min(s,d),y=Math.min(u,f),x=Math.max(m-p,0)*Math.max(y-g,0);return x/(h+v-x)}function xM(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function M0(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function tE(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(i){o[n]=i;var a=e.slice(r,o);return r[n]+=i,a})}function nE(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=be(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function rE(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=fu(n,s*r),c=fu("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=e.subarray(f,f+u),v=[],p=0;p<h.length;p++)v.push({value:h[p],index:p});v.sort(function(w,b){return b.value-w.value});var g=d*r,m=l.subarray(g,g+r),y=c.subarray(g,g+r);for(p=0;p<r;p++)m[p]=v[p].value,y[p]=v[p].index}var x=t.slice();return x[x.length-1]=r,[Tt(l,x,n),Tt(c,x,"int32")]}function Im(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=be(e,"int32"),i=be([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var wM=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},bM=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},CM=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function oE(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function en(e,t){return t===1?[e]:oE(e,t)}function Wt(){var e,t,n,r,o,i,a,s,u,l;return G().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function mi(e,t,n){n===void 0&&(n="index");var r=Ir(t);return r.map(function(o,i){return"int "+e[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function Tm(e){var t=Ir(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var iE=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function EM(e,t,n,r){var o=[];e.forEach(function(h){var v=ce(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(v>1?"["+v+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=e.map(function(h){return function(v,p,g){g===void 0&&(g=!1);var m="";m+=g?aE(v):Ji(v);var y=v.shapeInfo.logicalShape,x=p.logicalShape;return y.length<=x.length&&(m+=g?function(w,b){var C,S=w.name,_=S.charAt(0).toUpperCase()+S.slice(1),k="get"+_+"AtOutCoords",R=w.shapeInfo.logicalShape.length,N=b.logicalShape.length,P=Po(w.shapeInfo.logicalShape,b.logicalShape),L=Ve(N),M=N-R,W=["x","y","z","w","u","v"];C=R===0?"":N<2&&P.length>=1?"coords = 0;":P.map(function(K){return"coords."+W[K+M]+" = 0;"}).join(`
`);var B="";B=N<2&&R>0?"coords":w.shapeInfo.logicalShape.map(function(K,Y){return"coords."+W[Y+M]}).join(", ");var z="return outputValue;",A=ce(w.shapeInfo.logicalShape)===1,F=ce(b.logicalShape)===1;if(R!==1||A||F){if(A&&!F)z=N===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(P.length){var U=R-2,j=R-1;P.indexOf(U)>-1&&P.indexOf(j)>-1?z="return vec4(outputValue.x);":P.indexOf(U)>-1?z="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":P.indexOf(j)>-1&&(z="return vec4(outputValue.xx, outputValue.zz);")}}else z=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+L+` coords = getOutputCoords();
      `+C+`
      vec4 outputValue = get`+_+"("+B+`);
      `+z+`
    }
  `}(v,p):function(w,b){var C=w.name,S=C.charAt(0).toUpperCase()+C.slice(1),_="get"+S+"AtOutCoords",k=b.texShape,R=w.shapeInfo.texShape,N=w.shapeInfo.logicalShape.length,P=b.logicalShape.length;if(!w.shapeInfo.isUniform&&N===P&&w.shapeInfo.flatOffset==null&&St(R,k))return`
      float `+_+`() {
        return sampleTexture(`+C+`, resultUV);
      }
    `;var L,M=Ve(P),W=Po(w.shapeInfo.logicalShape,b.logicalShape),B=P-N,z=["x","y","z","w","u","v"];L=N===0?"":P<2&&W.length>=1?"coords = 0;":W.map(function(F){return"coords."+z[F+B]+" = 0;"}).join(`
`);var A="";return A=P<2&&N>0?"coords":w.shapeInfo.logicalShape.map(function(F,U){return"coords."+z[U+B]}).join(", "),`
    float `+_+`() {
      `+M+` coords = getOutputCoords();
      `+L+`
      return get`+S+"("+A+`);
    }
  `}(v,p)),m}(h,t,r)}).join(`
`),l=t.texShape,c=Wt(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+SM+`
    `+_M+`
    `+kM+`
  `}(c);return t.isPacked?(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,b){var C=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];return C[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return 2 * (resTexRC.x * `+C[1]+` + resTexRC.y);
    }
  `}(0,v);case 2:return function(w,b){var C=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];if(St(w,b))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `;var S=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec2(r, c);
    }
  `}(h,v);case 3:return p=h,g=v,m=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(p[2]/2),x=y*Math.ceil(p[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,b){for(var C=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)],S=Math.ceil(w[w.length-1]/2),_=S*Math.ceil(w[w.length-2]/2),k=_,R="",N="b, r, c",P=2;P<w.length-1;P++)k*=w[w.length-P-1],R=`
      int b`+P+" = index / "+k+`;
      index -= b`+P+" * "+k+`;
    `+R,N="b"+P+", "+N;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+R+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+S+`);
      int c = imod(index, `+S+`) * 2;

      return ivec`+w.length+"("+N+`);
    }
  `}(h,v)}var p,g,m,y,x}(t.logicalShape,l),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,v);case 2:return function(m,y){return St(m,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(h,v);case 3:return p=v,g=mi(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+p[0]+", "+p[1]+`));
      int index = resTexRC.x * `+p[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,y){var x=mi(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(h,v);case 5:return function(m,y){var x=mi(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,v);case 6:return function(m,y){var x=mi(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,v);default:throw new Error(h.length+"-D output sampling is not yet supported")}var p,g}(t.logicalShape,l),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=RM),[f,d,a,s,i,u,n].join(`
`)}function Ji(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],d=si(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+qi(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=si(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&St(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=fi(r),c=l.newShape,d=l.keptDims,f=c;if(f.length<r.length){var h=Zi(n,f);return`
      `+Ji(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+ea(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+qi(n)+`
      }
    `;var v=a[0],p=a[1],g=si(o);return p===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+p+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+v+", "+p+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=fi(r),l=u.newShape,c=u.keptDims,d=l;if(d.length<r.length){var f=Zi(n,d);return`
        `+Ji(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+ea(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+qi(n)+`
      }
    `;var h=n.shapeInfo.texShape,v=h[0],p=h[1],g=n.shapeInfo.flatOffset;if(p===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+p+".0, "+v+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(p===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+".0, "+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var m=si(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+v+", "+p+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=fi(r),c=l.newShape,d=l.keptDims;if(c.length<r.length){var f=Zi(n,c);return`
      `+Ji(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+ea(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+qi(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,p=v[0],g=v[1];if(g===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var m=si(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+p+", "+g+", index + "+m+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=fi(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var h=Zi(n,d);return`
      `+Ji(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+ea(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+qi(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===l&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(m===a&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=si(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+m+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=fi(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=Zi(n,s);return`
      `+Ji(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+ea(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,v=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+v+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+qi(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],y=g[1];if(y===v&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=si(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+v+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+m+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function aE(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Wt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Wt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],d=Wt();if(u!=null&&St(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),d=Zi(o,c);return`
        `+aE(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+ea(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],h=l[1],v=Math.ceil(i[2]/2),p=v*Math.ceil(i[1]/2),g=Wt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+p+", "+v+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],h=Math.ceil(i[a-1]/2),v=h*Math.ceil(i[a-2]/2),p="int b, int row, int col",g="b * "+v+" + (row / 2) * "+h+" + (col / 2)",m=2;m<a-1;m++)p="int b"+m+", "+p,v*=i[a-m-1],g="b"+m+" * "+v+" + "+g;var y=Wt();return`
    vec4 `+u+"("+p+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var SM=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_M=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,kM=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,RM=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function si(e){return"offset"+e}function qi(e){var t=e.name,n=ce(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Ve(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Zi(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function ea(e,t){return t.map(function(n){return e[n]}).join(", ")}var IM=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=Ve(l),d=en("coords",l);if(i===1){var f=Ve(s=l+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),v="."+h[s-1],p=h.map(function(_){return"int "+_}),g=en("sourceLocR",s-1).concat("inIdx.r"),m=en("sourceLocG",s-1).concat("inIdx.g"),y=en("sourceLocB",s-1).concat("inIdx.b"),x=en("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",b=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",C=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",S=r?"":`
      float getBestIndicesAChannel(`+p.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+p.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+S+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+v+", sourceLocG"+v+`,
          sourceLocB`+v+", sourceLocA"+v+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+C+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+b+`
          vec4 candidate = `+C+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},TM=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},PM=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=c-1-e.padInfo.front,v=d-1-e.padInfo.top,p=f-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+v+", "+p+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},AM=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ie(e,t),Ie(e,n);var a="0.0";r!=null&&(Ie(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Ie(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},NM=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ie(e,t),Ie(e,n);var a="vec4(0.0)";r!=null&&(Ie(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Ie(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},DM="return areal * breal - aimag * bimag;",MM="return areal * bimag + aimag * breal;",F0=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ie(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},qf="return a + b;",Xf="return a - b;",O0="return a * b;",sE="return (a < 0.) ? b * a : a;",nt=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Ie(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},uE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,$r=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ie(t,n);var o=this.outputShape.length,i="";if(r)if(o===0||ce(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Ve(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=en("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},FM=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),OM=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),LM=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},BM=function(e){this.outputShape=[],this.outputShape=Ja(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},WM=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ja(e,t);var n=this.outputShape,r=n.length,o=Ve(r),i=en("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,m){return"T"+m});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),d=a.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+Cl(a,l,h)+`),
            vec2(`+Cl(c,l,h)+`));
        }`}var v=s.length,p=s[s.length-1];f+=`
        return getChannel(
          getT`+v+"("+Cl(a,l,p)+`),
          vec2(`+Cl(c,l,p)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Cl(e,t,n){var r=e.indexOf(t);return e.map(function(o,i){return i===r?o+" - "+n:o}).join()}var zM=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},$M=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},UM=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},VM=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},jM=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},HM=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},L0=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,v=e.dataFormat==="channelsLast",p=v?1:2,g=v?2:3,m=v?3:1,y="",x="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+p+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+v+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+v+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+v+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+v+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+x+`
        setOutput(result);
      }
    `},GM=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(v===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(v===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(v===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},B0=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,v=e.outChannels/e.inChannels,p="",g="";n&&(p=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+v+`;
        int q = d2 - d1 * `+v+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+g+`
        setOutput(result);
      }
    `},W0=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,v=h,p="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var m=0;m<h;m++)p+=`
          vec4 xTexelR`+g+"C"+2*m+` = vec4(0.);
          vec4 wR`+g+"C"+m+` = vec4(0.);
          vec4 xR`+g+"C"+m+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<v;y++){if(p+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(m=2*y)*d+`;
        `,l===1){if(m<h&&(p+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+m+" = vec4(previous.zw, xTexelR"+g+"C"+m+`.xy);
                } else {
                  xR`+g+"C"+m+" = vec4(0, 0, xTexelR"+g+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xR`+g+"C"+m+" = xTexelR"+g+"C"+m+`;
              `,m+1<h)){var x=s%2==0?kC(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(p+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(p+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+m+` = vec4(0.);
                    }
                  `),p+=`
                  xR`+g+"C"+(m+1)+` = vec4(
                    xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.xy);
                `):p+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(m+1)+" = xTexelR"+g+"C"+(m+2)+`;
                `}}else m<h&&(p+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(p+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(m+2)+` = vec4(0.);
                }

                xR`+g+"C"+m+` = vec4(
                  xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.zw);
              `,m+1<h&&(p+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(m+1)+" = vec4(xTexelR"+g+"C"+(m+2)+`.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(m+2)+` = vec4(0.);
                }

                xR`+g+"C"+m+` = vec4(
                  xTexelR`+g+"C"+m+".xy, xTexelR"+g+"C"+(m+2)+`.xy);
              `,m+1<h&&(p+=`
                  xR`+g+"C"+(m+1)+` = vec4(
                    xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.zw);
                `)),p+="}");m<h&&(p+=`
            vec4 wTexelR`+g+"C"+m+" = getW("+g+", "+m+`, d1, q);
            wR`+g+"C"+m+" = vec4(wTexelR"+g+"C"+m+".xz, wTexelR"+g+"C"+m+`.xz);
          `,m+1<h&&(p+=`
              vec4 wTexelR`+g+"C"+(m+1)+" = getW("+g+", "+(m+1)+`, d1, q);
              wR`+g+"C"+(m+1)+` =
                vec4(wTexelR`+g+"C"+(m+1)+".xz, wTexelR"+g+"C"+(m+1)+".xz);"))}for(g=0;g<f;g++)for(m=0;m<h;m++)p+="dotProd += xR"+g+"C"+m+" * wR"+g+"C"+m+";";var w="",b="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,b="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+p+`

        vec4 result = dotProd;
        `+C+`
        `+b+`
        setOutput(result);
      }
    `},KM=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],d=n[1];this.outputShape=[l,c,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],v=h[0],p=h[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+v+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+v],m=g[0],y=g[1],x=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p],b=w[0],C=w[1],S=w[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+b+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+C+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+v+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+S+`;
        if( in_x < 0.0 || in_x > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},qM=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ve(r)+` coords = getOutputCoords();
        int end = `+z0(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+z0(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function z0(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var XM=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=pu.DENSE;var t=zs(e),n=Wt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+mi(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},YM=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=pu.DENSE;var t=zs(e),n=Wt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+mi(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},QM=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),JM=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},ZM=function(e){this.variableNames=["A"],this.outTexUsage=wn.DOWNLOAD;var t=Wt();this.outputShape=e,this.userCode=`
      `+iE+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},eF=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=wn.DOWNLOAD;var t=Wt();this.outputShape=e,this.userCode=`
      `+iE+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},tF=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Wt(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+Tm(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},nF=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Wt(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Tm(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},rF="return real * expR - imag * expI;",oF="return real * expI + imag * expR;",$0=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},iF=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),aF=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Ve(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<a.length;d++)d===s?c.push("int(getIndices("+l[d]+"))"):c.push(""+l[d]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},sF=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Ve(t.length),o=Ve(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function uF(e,t){var n=Wt();return r3(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function lF(e,t){return u3(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function cF(e,t){return l3(e,t,new Uint16Array([0,1,2,2,1,3]))}function Fu(e,t,n,r,o,i,a){d3(n,r);var s=c3(e,t),u=e.TEXTURE_2D;return de(e,t,function(){return e.bindTexture(u,s)}),de(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),de(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),de(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),de(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),de(e,t,function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)}),de(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function dF(e,t,n,r,o){var i=Md(n,r);return Fu(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function fF(e,t,n,r,o){var i=Md(n,r);return Fu(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function hF(e,t,n,r,o){var i=Md(n,r);return Fu(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function pF(e,t,n,r,o){var i=Mu(n,r);return Fu(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function vF(e,t,n,r,o){var i=Mu(n,r);return Fu(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function mF(e,t,n,r){return de(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),I0(e,t,n,"clipSpacePos",r,3,20,0)&&I0(e,t,n,"uv",r,2,20,12)}function gF(e,t,n,r,o,i,a){var s,u,l;de(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),de(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)}),de(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function yF(e,t,n,r){de(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?de(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):de(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),de(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function xF(e,t,n,r,o){var i=e.createBuffer();de(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return de(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),de(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),de(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function wF(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function bF(e,t,n,r,o){var i=Md(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return de(e,t,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function CF(e,t,n,r,o,i,a,s){var u=e,l=new Float32Array(function(c,d){var f=Mu(c,d);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function EF(e,t,n,r){var o=new Float32Array(n*r*4);return de(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var SF=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=G().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,JD(n,t)):this.gl=Fr(n);var r="WEBGL_color_buffer_float";if(G().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=yl(this.gl,this.debug,"OES_texture_float"),Ln(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=yl(this.gl,this.debug,"OES_texture_half_float");else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ln(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=yl(this.gl,this.debug,"EXT_color_buffer_half_float");else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ln(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Ln(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=lF(this.gl,this.debug),this.indexBuffer=cF(this.gl,this.debug),this.framebuffer=f3(this.gl,this.debug),this.textureConfig=xm(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return G().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;de(n,this.debug,function(){return n.finish()}),de(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),de(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),de(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),de(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),de(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),dF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),fF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),hF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),yF(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),gF(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),vF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),pF(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(T0(this.gl,this.debug,this.framebuffer),this.outputTexture=null),de(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return bF(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,i,a){return CF(this.gl,t,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return wF(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=xF(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(G().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return EF(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=o3(n,this.debug,t),o=uF(n,this.debug),i=a3(n,this.debug);return de(n,this.debug,function(){return n.attachShader(i,o)}),de(n,this.debug,function(){return n.attachShader(i,r)}),s3(n,this.debug,i),this.debug&&jf(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=mF(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&de(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&jf(this.gl,this.debug,this.program),de(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?p3(this.gl,this.debug,t,n):v3(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),de(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),m3(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=Mu(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(t,i,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&jf(this.gl,this.debug,this.program),xl(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),de(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),de(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=yl(this.gl,this.debug,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return se(this,void 0,void 0,function(){var n=this;return ue(this,function(r){switch(r.label){case 0:return[4,C0(function(){return n.disposed||n.isQueryAvailable(t,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||C0(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Hf(this.gl,this.debug,t,this.framebuffer),this.debug&&xl(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Hf(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&xl(this.gl)):T0(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;Hf(o,this.debug,t,this.framebuffer),this.debug&&xl(o),this.outputTexture=t,de(o,this.debug,function(){return o.viewport(0,0,n,r)}),de(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var i=this;this.throwIfDisposed(),de(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function U0(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,i=t[r],a=i.shape;if(!St(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!St(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var _F=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,v=o*r,p=Wt(),g=d==="channelsLast",m=g?0:1,y=g?1:2,x="",w=0;w<=1;w++)for(var b=0;b<=1;b++)x+=`
          blockIndex = rc.y + `+b+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+v+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+v+".) / "+o+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+b)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+b)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+p.output+` = result;
      }
    `},kF=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},RF=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},IF=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},TF=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},PF=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,d=u-1-e.padInfo.top,f=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Yf=function(e,t,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",v="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,v="result = activation(result);");var p=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+p+`

        `+v+`

        setOutput(result);
      }
    `},AF=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),NF=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},DF=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=en("rc",t),r=Ve(t),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",d=s-2;d<s;d++)c+=l[d]+" >= "+u[d],d<s-1&&(c+="||");return c}(t,e,n),i=function(s,u,l,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,u){var l=s.length,c=function(d,f){for(var h=[],v=0;v<=1;v++)for(var p=0;p<=1;p++){for(var g=(v===0?"r":"rp1")+", "+(p===0?"c":"cp1"),m=2;m<d;m++)g=f[f.length-1-m]+","+g;h.push(g)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},MF=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,o=Ve(r),i=t.map(function(u){return u[0]}).join(","),a=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},FF=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,m){return g[0]+e[m]+g[1]});for(var r=e.length,o=Ve(r),i=t.map(function(g){return g[0]}).join(","),a=t.map(function(g,m){return g[0]+e[m]}).join(","),s=en("rc",r),u=en("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",v=0,p=r===1?2:4;v<p;v++)h+=`
        `+d[v]+`
        if (`+f+`) {
          result[`+v+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+v+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},Qf=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var v=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(v="avgValue / count");var p=4*Math.floor(r/4),g=r%4,m=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+p+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+v+`);
      }
    `}},Jf=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,v=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",m="0.0";if(g||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+v+", "+p+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var x=4*Math.floor(r/4),w=r%4,b=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+v+", "+p+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+b+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+b+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},OF=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,d=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},LF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+mi(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Tm(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},BF=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,v=1/f,p=2*Math.ceil(h)+2,g=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},WF=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},zF=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},$F=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,v=1/f,p=2*Math.ceil(h)+2,g=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},UF=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},VF=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=Ve(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},jF=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=en("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ve(n);function s(u){var l=e.map(function(c,d){return function(f,h){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},V0=function(e,t,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ve(o.length),u=Ve(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},HF=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},GF=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=Ve(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},KF=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Ve(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return Zf.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+Zf[s]+" = start["+s+"] + coords."+Zf[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),Zf=["x","y","z","w","u","v"],qF=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Ve(this.rank),r=en("coords",this.rank),o=en("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,d){return"start["+d+"]"}).join()+");":t.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),XF=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Ve(n.length),i=Ve(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},YF=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,i=j0(n,r),a=H0(t,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===yn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===yn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===yn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===yn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===yn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var i=H0(n,j0(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function j0(e,t){if(e===wn.UPLOAD)return yn.PACKED_2X2_FLOAT32;if(e===wn.RENDER||e==null)return function(n){return G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?yn.PACKED_2X2_FLOAT32:yn.UNPACKED_FLOAT32:n?yn.PACKED_2X2_FLOAT16:yn.UNPACKED_FLOAT16}(t);if(e===wn.DOWNLOAD||e===wn.PIXELS)return yn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function H0(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var QF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Ve(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},JF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Ve(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},ZF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ve(this.rank),i=oE("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},Pm=1.7580993408473768,Am=1.0507009873554805,Se=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},sr="if (isnan(x)) return x;",e4="return x;",G0="return abs(x);",lE=sr+`
  return (x < 0.0) ? 0.0 : x;
`,cE=sr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,dE="return (x >= 0.0) ? x : (exp(x) - 1.0);",t4=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Pm+`;
  float scale = `+Am+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,K0="return -x;",q0="return ceil(x);",X0="return floor(x);",Y0="return exp(x);",Q0="return exp(x) - 1.0;",n4=sr+`
  return sin(x);
`,r4=sr+`
  return cos(x);
`,o4=sr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,i4=sr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,a4=sr+`
  return atan(x);
`,s4=sr+"return log(x + sqrt(x * x + 1.0));",u4=sr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,l4=sr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,El="return x;",c4="return x;",fE=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,hE=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pE=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,_s=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},d4=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=en("rc",t),r=Ve(t),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},Sl={};function _l(e,t){if(t===void 0&&(t=!1),e==="linear")return t?c4:e4;if(e==="relu")return t?fE:lE;if(e==="elu")return t?pE:dE;if(e==="relu6")return t?hE:cE;if(e==="prelu")return t?uE:sE;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var f4=600,h4=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!G().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Fr(G().getNumber("WEBGL_VERSION"));o.binaryCache=((r=G().getNumber("WEBGL_VERSION"))in Sl||(Sl[r]={}),Sl[r]),o.gpgpu=new SF(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new YF(o.gpgpu),o.numMBBeforeWarning=G().global.screen==null?1024:G().global.screen.height*G().global.screen.width*window.devicePixelRatio*f4/1024/1024,o.texData=new XC(o,O),o}return ar(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(G().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:wn.UPLOAD}),i},t.prototype.move=function(n,r,o,i){if(G().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:wn.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new _s(u,El):new Se(u,El);var d=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,v,p=this.activeTimers!=null;return p&&(h=xr()),i==="complex64"?v=$p(a.real.dataSync(),a.imag.dataSync()):v=this.getValuesFromTexture(n),p&&(this.downloadWaitMs+=xr()-h),this.convertAndCacheOnCPU(n,v)},t.prototype.read=function(n){return se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,p,g,m,y,x,w,b,C,S,_;return ue(this,function(k){switch(k.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(R){return r.push(R)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return d=void 0,d=c?new _s(a,El):new Se(a,El),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&G().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return v=null,u!=="complex64"&&G().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(n),g=this.texData.get(p.dataId),v=(_=this.gpgpu).createBufferFromTexture.apply(_,[g.texture].concat(zs(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=k.sent(),x=y[0],w=y[1],m=$p(x,w),[3,5];case 4:v==null?m=this.getValuesFromTexture(n):(b=ce(a),m=this.gpgpu.downloadFloat32MatrixFromBuffer(v,b)),k.label=5;case 5:return p!=null&&this.disposeData(p.dataId),C=this.convertAndCacheOnCPU(n,m),S=this.pendingRead.get(n),this.pendingRead.delete(n),S.forEach(function(R){return R(C)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,C]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!t3(o))throw G().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=ce(i);if(G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(zs(i))).subarray(0,u);return this.disposeData(l.dataId),d}var f=G().getBool("WEBGL_PACK")&&s===!0,h=f?Gf(i):i,v=f?new eF(h):new ZM(h),p=this.runWebGLProgram(v,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(p.dataId),m},t.prototype.time=function(n){return se(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return ue(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=Ya(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=Ya(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=FD(l),u.getExtraProfileInfo=function(){return l.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xr(),endMs:null}},t.prototype.endTimer=function(n){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=xr(),n)},t.prototype.getQueryTime=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return G().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=O.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:O.keep(n.clone()),imag:O.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(ce(o)===0)return Tt([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=KC(n.shape,r,o);if(i||!a){var s=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qF(o):new KF(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=qC(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},t.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Sm(r,o,i);if(a.some(function(u){return u===0}))return Tt([],a);var s=new XF(r,i,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jF(n.shape,r):new VF(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return Fn(h)}),i=n.map(function(h){return Er(h)});return Rt(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>G().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new WM(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=Ja(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,ce(h.shape.slice(r)))}),f=new BM(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,K0,n.dtype);var r=new Se(n.shape,K0);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),d=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var h=It(n.dtype,r.dtype),v=new Yf(n.shape,[l,a,s],o,i);return this.compileAndRun(v,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=It(r.dtype,o.dtype),v=s!=null,p=l!=null,g=u?_l(u,!0):null,m=new Yf(r.shape,[f,c,d],i,a,v,g,p),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(m,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new F0(DM,n.shape,r.shape),s=new F0(MM,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,O0,n.dtype);var f=new nt(O0,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),G().getBool("WEBGL_PACK_NORMALIZATION")){var d=new NM(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)}var f=new AM(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=G().getBool("WEBGL_PACK_NORMALIZATION")?new IF(n.shape,r,o,i,a):new kF(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new RF(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return Ac(a)});return nE(be(n.shape,n.dtype,o),r)}var i=new QF(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,o){var i=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FF(n.shape,r,o):new MF(n.shape,r,o);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZF(n.shape,r):new JF(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new aF(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){T(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=Lc(n.shape,r,i),s=Bc(a.length,r.length),u=Wc(n.shape,r,i),l=VC(o,r.length),c=jC(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){T(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=Lc(u.shape,r,i,!1),c=Bc(l.length,r.length,!1),d=Wc(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=Kf(a),u=new OF({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=Kf(a),u=new CM({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=Kf(i[i.length-1]),s=new IM(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){mn("sum",r,n.rank);var o=Ot(n.shape,r),i=o[0],a=ce(o[1]),s=n.as2D(-1,a),u=Wf(n.dtype);return this.reduce(s,"sum",u).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Ot(n.shape,r),i=o[0],a=ce(o[1]),s=n.as2D(-1,a),u=Wf(n.dtype);return this.reduce(s,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=Or([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Lr(1,n.rank)[0]);var u=function(h,v,p){for(var g=[],m=h.length,y=0;y<m;y++)y!==v?g.push(h[y]):g.push(p);return g}(s.shape,i,o),l=ce([s.shape[i]]),c=s.as2D(-1,l),d=Wf(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(u);return a!=null&&(f=f.transpose(wm(a))),f},t.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(f,h){var v,p=!1;for(f<=GC?(v=f,p=!0):v=Np(f,Math.floor(Math.sqrt(f)));!p;)v>h||v===f?p=!0:v=Np(f,v+1);return v}(u,a),c=new HF({windowSize:l,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(c,[n,o],i);return d.shape[1]===a?d:(o=Oc(0,a).tile([u/l]),this.segOpCompute(d,r,o,i,a))},t.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(mn("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!G().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Ot(n.shape,i),s=a[0],u=ce(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new qM(n.shape,o,i);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new nt("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new nt("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new nt("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new nt("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new nt("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new nt("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Se(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new nt("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new nt("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var i=new GF(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],It(r.dtype,o.dtype))},t.prototype.where=function(n){Mc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Im(n.shape,r)},t.prototype.topk=function(n,r,o){return rE(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){mn("min",r,n.rank);var o=Ot(n.shape,r),i=o[0],a=ce(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new nt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new nt(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);mn("max",r,n.rank);var o=Ot(n.shape,r),i=o[0],a=ce(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new nt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){mn("all",r,n.rank);var o=Ot(n.shape,r),i=o[0],a=ce(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},t.prototype.any=function(n,r){mn("any",r,n.rank);var o=Ot(n.shape,r),i=o[0],a=ce(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new nt(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new nt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,qf);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=It(n.dtype,r.dtype);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,qf,o);var i=new nt(qf,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var i=new _s(n.shape,r);return this.compileAndRun(i,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new $r(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],v=f[1],p=i.makeComplexComponentTensorInfo(n,h),g=i.makeComplexComponentTensorInfo(r,v),m=new nt(o,n.shape,r.shape);return i.compileAndRun(m,[p,g],It(h.dtype,v.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>G().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return It(l,c)}),s=n.map(function(l){return l.shape}),u=G().getBool("WEBGL_PACK")?new bM(n[0].shape,s):new wM(n[0].shape,s);return this.compileAndRun(u,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Xf);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=It(n.dtype,r.dtype);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Xf,n.dtype);var i=new nt(Xf,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.pow=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new nt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=It(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,q0,n.dtype);var r=new Se(n.shape,q0);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,X0,n.dtype);var r=new Se(n.shape,X0);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Se(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Se(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Se(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Se(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Se(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Y0,n.dtype);var r=new Se(n.shape,Y0);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Q0,n.dtype);var r=new Se(n.shape,Q0);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=xt([r],n.shape),i=this.max(n,o),a=un(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Se(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Se(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Se(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Se(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Se(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=G().getBool("WEBGL_PACK")?new _s(n.shape,fE):new Se(n.shape,lE),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=G().getBool("WEBGL_PACK")?new _s(n.shape,hE):new Se(n.shape,cE),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(uE,n.shape,r.shape):new nt(sE,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,pE,n.dtype);var r=new Se(n.shape,dE);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new nt("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new Se(n.shape,t4);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Se(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var i,a=(i=G().getBool("WEBGL_PACK_CLIP")?new OM(n.shape):new FM(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,G0,n.dtype);var r=new Se(n.shape,G0);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new LM(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(n){var r=new Se(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Se(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Se(n.shape,n4);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Se(n.shape,r4);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Se(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Se(n.shape,o4);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Se(n.shape,i4);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Se(n.shape,a4);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new nt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new Se(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Se(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Se(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Se(n.shape,s4);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Se(n.shape,u4);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Se(n.shape,l4);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Se(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new Se(n.shape,function(i){return i===void 0&&(i=0),sr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",v=(d===1||f===1)&&c>1e3,p=u[2]%2!=0&&!!l.isPacked;if(v||!G().getBool("WEBGL_LAZILY_UNPACK")||!G().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],m=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},b=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,T(bl(l.shape,w.shape),function(){return"packed reshape "+l.shape+" to "+w.shape+" isn't free"});var C=this.reshape(r,[1,o.inChannels,o.outChannels]),S=this.fusedBatchMatMul({a:w,b:C,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),_=this.texData.get(S.dataId);return T(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=b,_.shape=o.outShape,O.makeTensorFromDataId(S.dataId,o.outShape,S.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",v=u*l*c,p=f*d,g=[v,p],m=n.squeeze([0]),y=r.reshape([1,v,-1]),x=new _F(g,m.shape,o),w=this.compileAndRun(x,[m]).reshape([1,g[0],g[1]]),b=i!=null,C=s!=null,S=a?_l(a,!0):null,_=new Yf(w.shape,[1,p,o.outChannels],!0,!1,b,S,C),k=[w,y];i&&k.push(i),C&&k.push(s);var R=this.compileAndRun(_,k);return h?R.reshape([1,f,d,o.outChannels]):R.reshape([1,o.outChannels,f,d])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(G().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,d=s?_l(s,!1):null,f=new L0(i,l,d,c),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(G().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new L0(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var i=new $M(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var i=new zM(o);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=G().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?_l(u,c):null,f=[o,i],h=s!=null,v=l!=null;return h&&f.push(s),v&&f.push(l),c?(r=new W0(a,h,d,v),this.compileAndRun(r,f)):(r=new B0(a,h,d,v),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,o){var i;return G().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new W0(o),this.compileAndRun(i,[n,r])):(i=new B0(o),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new HM(o);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new jM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,o){var i=new GM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var i=new VM(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var i=new UM(o);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var o=new Qf(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new Qf(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,i){var a=new Qf(i,"max",!0),s=this.compileAndRun(a,[r]),u=new TF(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,o){var i=new TM(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return JC(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.avgPool3d=function(n,r){var o=new Jf(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var i=new PM(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new Jf(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Jf(i,"max",!0),s=this.compileAndRun(a,[r]),u=new PF(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!bl(n.shape,r)&&(o.texture===null||!bl(o.shape,r))){var i=this.packedReshape(n,r);return O.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return zp(n,r)},t.prototype.resizeBilinear=function(n,r,o,i){var a=G().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new zF(n.shape,r,o,i):new WF(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var i=new BF(n,r,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new UF(n.shape,r,o,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new $F(n,r,o);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,o,i){var a=r?n:ro(n),s=a.shape[0],u=a.shape[1],l=new AF(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},t.prototype.oneHot=function(n,r,o,i){var a=new NF(n.size,r,o,i);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new JM(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Mc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),km(n.dataSync(),r.dataSync(),o,i,a)},t.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new KM(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){T(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,d=u/(r*r),f=new QM(o==="NHWC"?[i,l,c,d]:[i,d,l,c],r,o);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,o){return tE(n,r,o)},t.prototype.scatterND=function(n,r,o){var i=zc(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=[c/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(c===0)return zp(Tt([]),o);var v=ee(0),p=new V0(s,a,f.rank,h.rank,l,d);return this.compileAndRun(p,[h,f,v]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,i){var a=zc(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,d=new V0(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new $0(rF,n.shape,r),a=new $0(oF,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=HC(n,r),s=a[0],u=a[1],l=a[2],c=a[3],d=r.reshape([u,i]),f=n.reshape([n.size/l,l]),h=new sF(i,c,[u,l]);return this.compileAndRun(h,[f,d]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||Nu(r))==="string"){var i=Pc(o,ce(n));return i.fill(r),O.makeTensor(i,n,o,this)}var a=new iF(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return ZC(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return O.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new d4(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new DF(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[Nc(n.shape)].concat(Dc(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[Nc(r)].concat(Dc(r)),s=new LF(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=Gf(a);return r=i?new YM(u):new XM(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===pu.DENSE){var c=zs(n.outputShape);l.texShape=c.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),ce(u.shape)===0)return l.values=fu(u.dtype,0),u;var d=[],f=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(x.dataId);if(w.texture==null){if(!n.packedInputs&&ce(x.shape)<=G().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=x.shape)}else if(!!w.isPacked!=!!n.packedInputs)x=w.isPacked?s.unpackTensor(x):s.packTensor(x),d.push(x),w=s.texData.get(x.dataId);else if(w.isPacked&&!bl(w.shape,x.shape)){var b=x,C=x.shape;x.shape=w.shape,x=s.packedReshape(x,C),d.push(x),w=s.texData.get(x.dataId),b.shape=C}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,v={shape:u.shape,texData:l,isUniform:!1},p=function(x,w,b){var C="";w.concat(b).forEach(function(k){var R=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,N=k.isUniform?"uniform":k.texData.texShape;C+=k.shape+"_"+N+"_"+R});var S=x.userCode,_=x.constructor.name;return _+="_"+C+"_"+S}(n,f,v),g=this.getAndSaveBinary(p,function(){return function(x,w,b,C){var S=w.userCode,_=b.map(function(A,F){var U={logicalShape:A.shape,texShape:A.isUniform?null:A.texData.texShape,isUniform:A.isUniform,isPacked:!A.isUniform&&A.texData.isPacked,flatOffset:null};return A.texData!=null&&A.texData.slice!=null&&A.texData.slice.flatOffset>0&&(U.flatOffset=A.texData.slice.flatOffset),{name:w.variableNames[F],shapeInfo:U}}),k=_.map(function(A){return A.shapeInfo}),R={logicalShape:C.shape,texShape:C.texData.texShape,isUniform:!1,isPacked:C.texData.isPacked,flatOffset:null},N=EM(_,R,S,w.packedInputs),P=x.createProgram(N),L=null,M=x.getUniformLocation(P,"NAN",!1);G().getNumber("WEBGL_VERSION")===1&&(L=x.getUniformLocation(P,"INFINITY",!1));for(var W={},B=0;B<w.variableNames.length;B++){var z=w.variableNames[B];W[z]=x.getUniformLocation(P,z,!1),W["offset"+z]=x.getUniformLocation(P,"offset"+z,!1)}return{program:w,source:N,webGLProgram:P,uniformLocations:W,inShapeInfos:k,outShapeInfo:R,infLoc:L,nanLoc:M}}(s.gpgpu,n,f,v)}),m=this.activeTimers!=null;if(m&&(h=this.startTimer()),function(x,w,b,C,S){U0(w.inShapeInfos,b),U0([w.outShapeInfo],[C]);var _=C.texData.texture,k=C.texData.texShape;C.texData.isPacked?x.setOutputPackedMatrixTexture(_,k[0],k[1]):x.setOutputMatrixTexture(_,k[0],k[1]),x.setProgram(w.webGLProgram),G().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&x.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&x.gl.uniform1f(w.nanLoc,NaN),b.forEach(function(R,N){var P=w.program.variableNames[N],L=w.uniformLocations[P],M=w.uniformLocations["offset"+P];if(L!=null)if(R.isUniform)if(ce(R.shape)<2)x.gl.uniform1f(L,R.uniformValues[0]);else{var W=R.uniformValues;W instanceof Float32Array||(W=new Float32Array(W)),x.gl.uniform1fv(L,W)}else R.texData.slice!=null&&M!=null&&x.gl.uniform1i(M,R.texData.slice.flatOffset),x.setInputMatrixTexture(R.texData.texture,L,N)}),S!=null&&S(x,w.webGLProgram),x.executeProgram()}(this.gpgpu,g,f,v,i),d.forEach(function(x){return s.disposeData(x.dataId)}),m&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!G().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return O.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(G().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=re(function(){if(!G().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=G().getBool("DEBUG");G().set("DEBUG",!1);var o=n.abs(ee(1e-8)).dataSync()[0];if(G().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=xr());var h=o.texShape;if(h==null&&(h=x3(i,c),o.texShape=h),s!=null){var v=Gf(i),p=void 0,g=h[1],m=h[0],y=s instanceof Uint8Array;c?(g=(r=Mu(h[0],h[1]))[0],m=r[1],p=new nF(v,[m,g],y)):p=new tF(v,[m,g],y);var x=this.makeTensorInfo([m,g],a);this.texData.get(x.dataId).usage=y?wn.PIXELS:wn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,m,s);var w=this.runWebGLProgram(p,[x],a,null,!0),b=this.texData.get(w.dataId);o.texture=b.texture,o.texShape=b.texShape,o.isPacked=b.isPacked,o.usage=b.usage,this.disposeData(x.dataId),this.texData.delete(w.dataId),o.values=null,f&&(this.uploadWaitMs+=xr()-d)}else{var C=this.acquireTexture(h,l,a,c);o.texture=C}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},t.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*RC(r)},t}(YC);MC()&&O.registerBackend("webgl",function(){return new h4},2);var p4=D({square_:function(e){var t=I(e,"x","square"),n=[t];return O.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),mu="SquaredDifference",vE=D({squaredDifference_:function(e,t){var n,r=I(e,"a","squaredDifference"),o=I(t,"b","squaredDifference");n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return O.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],d=ee(2);return{a:function(){return s.mul(l.sub(c).mul(d))},b:function(){return s.mul(c.sub(l).mul(d))}}},mu,{},a,[])}}),v4=D({abs_:function(e){var t=I(e,"x","abs");return t.dtype==="complex64"?O.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):O.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),m4=D({acos_:function(e){var t=I(e,"x","acos");return O.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),g4=D({acosh_:function(e){var t=I(e,"x","acosh");return O.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),y4=D({asin_:function(e){var t=I(e,"x","asin");return O.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).sub(o.toFloat().square()).sqrt())}}})}}),x4=D({asinh_:function(e){var t=I(e,"x","asinh");return O.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).add(o.toFloat().square()).sqrt())}}})}}),w4=D({atan_:function(e){var t=I(e,"x","atan");return O.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),b4=D({atanh_:function(e){var t=I(e,"x","atanh");return O.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(ee(1).sub(o.toFloat().square()))}}})}}),C4=D({ceil_:function(e){var t=I(e,"x","ceil");return O.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),Nm=D({clipByValue_:function(e,t,n){var r=I(e,"x","clipByValue");T(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],i={min:t,max:n};return O.runKernelFunc(function(a,s){var u=a.clip(r,t,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),Ne(a))}}},"ClipByValue",i,o)}}),E4=D({cos_:function(e){var t=I(e,"x","cos"),n=[t];return O.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),S4=D({cosh_:function(e){var t=I(e,"x","cosh");return O.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),_4=D({erf_:function(e){var t=I(e,"x","erf");return T(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),O.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Up=D({exp_:function(e){var t=I(e,"x","exp");return O.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),k4=D({expm1_:function(e){var t=I(e,"x","expm1");return O.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),R4=D({floor_:function(e){var t=I(e,"x","floor");return O.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),I4=D({log_:function(e){var t=I(e,"x","log"),n=[t];return O.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),T4=D({log1p_:function(e){var t=I(e,"x","log1p");return O.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),P4=D({logSigmoid_:function(e){var t=I(e,"x","logSigmoid");return O.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),jc=D({neg_:function(e){var t=I(e,"x","neg"),n=[t];return O.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),A4=D({reciprocal_:function(e){var t=I(e,"x","reciprocal");return O.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),N4=D({round_:function(e){var t=I(e,"x","round");return O.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),mE=D({rsqrt_:function(e){var t=I(e,"x","rsqrt"),n=[t];return O.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),gE=D({sigmoid_:function(e){var t=I(e,"x","sigmoid");return O.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ee(1).sub(o)))}}},"Sigmoid")}}),D4=D({sign_:function(e){var t=I(e,"x","sign");return O.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),M4=D({isNaN_:function(e){var t=I(e,"x","isNaN");return O.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),F4=D({isInf_:function(e){var t=I(e,"x","isInf");return O.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),O4=D({isFinite_:function(e){var t=I(e,"x","isFinite");return O.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Ne(n)}}})}}),L4=D({sin_:function(e){var t=I(e,"x","sin"),n=[t];return O.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),B4=D({sinh_:function(e){var t=I(e,"x","sinh");return O.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),W4=D({softplus_:function(e){var t=I(e,"x","softplus");return O.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),z4=D({sqrt_:function(e){var t=I(e,"x","sqrt");return O.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),$4=D({step_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","step");return O.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Ne(r)}}})}}),U4=D({tan_:function(e){var t=I(e,"x","tan");return O.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),V4=D({tanh_:function(e){var t=I(e,"x","tanh");return O.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return ee(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function yE(e,t,n,r,o,i){var a,s,u=I(e,"x","batchNorm"),l=I(t,"mean","batchNorm"),c=I(n,"variance","batchNorm");return o!=null&&(a=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),T(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),T(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),T(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&T(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&T(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Ou(u,l,c,s,a,i)}function xE(e,t,n,r,o,i){var a,s,u=I(e,"x","batchNorm"),l=I(t,"mean","batchNorm"),c=I(n,"variance","batchNorm");return o!=null&&(a=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),T(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),T(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),T(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&T(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&T(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Ou(u,l,c,s,a,i)}function wE(e,t,n,r,o,i){var a,s,u=I(e,"x","batchNorm"),l=I(t,"mean","batchNorm"),c=I(n,"variance","batchNorm");return o!=null&&(a=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),T(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),T(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),T(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&T(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&T(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Ou(u,l,c,s,a,i)}function Ou(e,t,n,r,o,i){i==null&&(i=.001);var a,s,u,l=I(e,"x","batchNorm"),c=I(t,"mean","batchNorm"),d=I(n,"variance","batchNorm");o!=null&&(a=I(o,"scale","batchNorm")),r!=null&&(s=I(r,"offset","batchNorm")),T(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),T(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),T(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,d,a];return O.runKernelFunc(function(h,v){var p=h.batchNormalization(u,kl(c),kl(d),i,kl(a),kl(s));return v([l,c,d,a]),p},{x:l,mean:c,variance:d,scale:a,offset:s},function(h,v){var p=v,g=p[0],m=p[1],y=p[2],x=p[3],w=x??ee(1),b=gt(m.shape,u.shape),C=[];if(m.rank===1){for(var S=0;S<u.shape.length-1;++S)C.push(u.shape[S]);C.push(1)}var _=g.sub(m),k=h.mul(w),R=mE(y.add(ee(i))),N=R.mul(R).mul(R).mul(ee(-.5));return{x:function(){return m.rank===1?h.mul(_a(R.as4D(1,1,1,m.shape[0]),C)).mul(w).reshape(g.shape):h.mul(R).mul(w).reshape(g.shape)},mean:function(){var P=R.mul(ee(-1)).mul(k);return m.rank===1&&(P=P.sum(b)),P.reshape(m.shape)},variance:function(){var P=N.mul(_).mul(k);return m.rank===1&&(P=P.sum(b)),P.reshape(m.shape)},scale:function(){var P=_.mul(R),L=h.mul(P);return m.rank===1&&(L=L.sum(b)),L.reshape(m.shape)},offset:function(){var P=h;return m.rank===1&&(P=P.sum(b)),P.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(l.shape)}function kl(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Ld(){FC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var j4=D({batchNormalization2d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Ld(),yE(e,t,n,i,o,r)}}),H4=D({batchNormalization3d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Ld(),xE(e,t,n,i,o,r)}}),G4=D({batchNormalization4d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Ld(),wE(e,t,n,i,o,r)}}),K4=D({batchNormalization_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Ld(),Ou(e,t,n,i,o,r)}}),bE=D({batchNorm_:Ou}),q4=D({batchNorm2d_:yE}),X4=D({batchNorm3d_:xE}),Y4=D({batchNorm4d_:wE}),Bd=D({logicalAnd_:function(e,t){var n=I(e,"a","logicalAnd","bool"),r=I(t,"b","logicalAnd","bool");return Ie(n.shape,r.shape),O.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),Q4=D({logicalNot_:function(e){var t=I(e,"x","logicalNot","bool");return O.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),CE=D({logicalOr_:function(e,t){var n=I(e,"a","logicalOr","bool"),r=I(t,"b","logicalOr","bool");return Ie(n.shape,r.shape),O.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),J4=D({logicalXor_:function(e,t){var n=I(e,"a","logicalXor","bool"),r=I(t,"b","logicalXor","bool");return Ie(n.shape,r.shape),CE(e,t).logicalAnd(Bd(e,t).logicalNot())}}),Di=D({where_:function(e,t,n){var r=I(t,"a","where"),o=I(n,"b","where"),i=I(e,"condition","where","bool");return We(r.shape,o.shape,"Error in where: "),i.rank===1?T(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):We(i.shape,o.shape,"Error in where: "),O.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Ne(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),EE=function(e){return se(this,void 0,void 0,function(){var t,n,r;return ue(this,function(o){switch(o.label){case 0:return[4,(t=I(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Im(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Re=D({add_:function(e,t){var n,r=I(e,"a","add"),o=I(t,"b","add");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=gt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=gt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),Z4=D({addN_:function(e){T(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),T(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,i){return I(o,"tensors"+i,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!St(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return O.runKernelFunc(function(o){return o.addN(t)},r,function(o){var i={};return t.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),eO=D({addStrict_:function(e,t){var n=I(e,"a","addStrict"),r=I(t,"b","addStrict");return We(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),tO=D({atan2_:function(e,t){var n,r=I(e,"a","atan2"),o=I(t,"b","atan2");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Re(u.square(),l.square()),d=a.mul(l.div(c)),f=gt(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=Re(u.square(),l.square()),d=jc(a.mul(u.div(c))),f=gt(l.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),Jn=D({div_:function(e,t){var n,r=I(e,"a","div"),o=I(t,"b","div");if(n=tt(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return SE(r,o);var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=gt(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=gt(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),nO=D({divNoNan_:function(e,t){var n,r=I(e,"a","div"),o=I(t,"b","div");r=(n=tt(r,o))[0],o=n[1];var i=Jn(r,o),a=Ne(i),s=o.equal(a);return Di(s,a,i)}}),rO=D({divStrict_:function(e,t){var n=I(e,"a","div"),r=I(t,"b","div");return We(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),SE=D({floorDiv_:function(e,t){var n,r=I(e,"a","floorDiv"),o=I(t,"b","floorDiv");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=gt(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=gt(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),Dm=D({maximum_:function(e,t){var n,r=I(e,"a","maximum"),o=I(t,"b","maximum");return n=tt(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Ie(r.shape,o.shape),O.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),oO=D({maximumStrict_:function(e,t){var n=I(e,"a","maximumStrict"),r=I(t,"b","maximumStrict");return We(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),_E=D({minimum_:function(e,t){var n,r=I(e,"a","minimum"),o=I(t,"b","minimum");return n=tt(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Ie(r.shape,o.shape),O.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),iO=D({minimumStrict_:function(e,t){var n=I(e,"a","minimumStrict"),r=I(t,"b","minimumStrict");return We(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),aO=D({mod_:function(e,t){var n,r=I(e,"a","mod"),o=I(t,"b","mod");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=gt(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),d=gt(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),sO=D({modStrict_:function(e,t){var n=I(e,"a","modStrict"),r=I(t,"b","modStrict");return We(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),$t=D({mul_:function(e,t){var n,r=I(e,"a","mul"),o=I(t,"b","mul");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),d=gt(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=gt(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),uO=D({mulStrict_:function(e,t){var n=I(e,"a","mul"),r=I(t,"b","mul");return We(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Hc=D({pow_:function(e,t){var n,r=I(e,"base","pow"),o=I(t,"exp","pow");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape),a=[r,o];return O.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],d=u[2];return{a:function(){var f=c.toFloat(),h=s.mul(f.mul(l.pow(f.sub(ee(1))))),v=gt(l.shape,i);return v.length>0&&(h=h.sum(v)),h.reshape(l.shape)},b:function(){var f=l.greater(0),h=l.log().where(f,Ne(l)),v=s.mul(d.mul(h)),p=gt(c.shape,i);return p.length>0&&(v=v.sum(p)),v.reshape(c.shape)}}},"Pow",{},a,[!0])}}),lO=D({powStrict_:function(e,t){return We(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),cO=D({squaredDifferenceStrict_:function(e,t){var n=I(e,"a","squaredDifferenceStrict"),r=I(t,"b","squaredDifferenceStrict");return We(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),yt=D({sub_:function(e,t){var n,r=I(e,"a","sub"),o=I(t,"b","sub");n=tt(r,o),r=n[0],o=n[1];var i=Ie(r.shape,o.shape);return O.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=gt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=gt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),dO=D({subStrict_:function(e,t){var n=I(e,"a","subStrict"),r=I(t,"b","subStrict");return We(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),kE=D({equal_:function(e,t){var n,r=I(e,"a","equal"),o=I(t,"b","equal");return n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape),O.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),fO=D({equalStrict_:function(e,t){var n=I(e,"a","equalStrict"),r=I(t,"b","equalStrict");return We(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),hO=D({greater_:function(e,t){var n,r=I(e,"a","greater"),o=I(t,"b","greater");return n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape),O.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),RE=D({greaterEqual_:function(e,t){var n,r=I(e,"a","greaterEqual"),o=I(t,"b","greaterEqual");return n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape),O.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Ne(s)},b:function(){return Ne(u)}}},"GreaterEqual")}}),pO=D({greaterEqualStrict_:function(e,t){var n=I(e,"a","greaterEqualStrict"),r=I(t,"b","greaterEqualStrict");return We(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),vO=D({greaterStrict_:function(e,t){var n=I(e,"a","greaterStrict"),r=I(t,"b","greaterStrict");return We(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),mO=D({less_:function(e,t){var n,r=I(e,"a","less"),o=I(t,"b","less");return n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape),O.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),gO=D({lessEqual_:function(e,t){var n,r=I(e,"a","lessEqual"),o=I(t,"b","lessEqual");return n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape),O.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),yO=D({lessEqualStrict_:function(e,t){var n=I(e,"a","lessEqualStrict"),r=I(t,"b","lessEqualStrict");return We(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),xO=D({lessStrict_:function(e,t){var n=I(e,"a","lessStrict"),r=I(t,"b","lessStrict");return We(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),wO=D({notEqual_:function(e,t){var n,r=I(e,"a","notEqual"),o=I(t,"b","notEqual");return n=tt(r,o),r=n[0],o=n[1],Ie(r.shape,o.shape),O.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),bO=D({notEqualStrict_:function(e,t){var n=I(e,"a","notEqualStrict"),r=I(t,"b","notEqualStrict");return We(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function J0(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Z0(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Mm=D({gather_:function(e,t,n){n===void 0&&(n=0);var r=I(e,"x","gather"),o=I(t,"indices","gather","int32");n=xt(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],d=1,f=1,h=0;h<u;h++)c.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<a.rank;h++)c.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,o,n);return O.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,d=l.slice(0,n),f=d.length,h=l.slice(n,l.length).slice(1),v=h.length,p=J0(0,f),g=J0(f+1,f+1+v),m=Z0([d,[c],h]),y=a.reshape(m),x=u.reshape([c]),w=Z0([[f],p,g]),b=y.transpose(w),C=IE(b,x,r.shape[n]),S=wm(w);return C=C.transpose(S)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),IE=D({unsortedSegmentSum_:function(e,t,n){var r=I(e,"x","unsortedSegmentSum"),o=I(t,"segmentIds","unsortedSegmentSum","int32");return T(st(n),function(){return"numSegments must be of dtype int"}),O.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=Dm(l,Ne(l)),d=Mm(u,c),f=RE(l,ee(0,"int32")),h=d.rank-f.rank,v=0;v<h;++v)f=Mn(f,v+1);f=Bd(f,cs(d.shape,"bool"));var p=Ne(d);return Di(f,d,p)}(i,s)}}})}}),CO=function(e,t,n){return se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,p;return ue(this,function(g){switch(g.label){case 0:for(r=I(e,"tensor","boolMask"),o=I(t,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,T(a>0,function(){return"mask cannot be scalar"}),We(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(c),f=o.reshape([-1]),[4,EE(f)];case 1:return h=g.sent(),v=h.squeeze([1]),p=Mm(d,v,i),e!==r&&r.dispose(),t!==o&&o.dispose(),v.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,p]}})})};function TE(e,t,n,r,o,i,a){i===void 0&&(i="NHWC"),T(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),T(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),T(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),T(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];T(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),T(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&T(st(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=_m(i),h=zi(s,n.shape,r,1,o,a,!1,f),v=O.runKernelFunc(function(p,g){var m=p.conv2dDerInput(u,n,h);return g([n,u]),m},{dy4D:u,filter:n},function(p,g){var m=g[0],y=g[1];return{dy4D:function(){return Vn(p,m,r,o,i,1,a)},filter:function(){return Fm(p,y,m.shape,r,o,i,a)}}});return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function eh(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function PE(e,t,n,r,o){T(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=a.shape[4];T(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),T(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),T(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),T(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),T(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=Uc(i,n.shape,r,1,o),d=O.runKernelFunc(function(f){return f.conv3dDerInput(a,n,c)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var EO=D({conv1d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=I(e,"x","conv1d"),u=I(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),T(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),T(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&T(st(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),T(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),T(ln(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),T(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Vn(f,d,[1,n],r,"NHWC",[1,i],a);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Vn=D({conv2d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=I(e,"x","conv2d"),u=I(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),T(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),T(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&T(st(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?l.shape[3]:l.shape[1];T(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),T(ln(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=_m(o),h=zi(l.shape,u.shape,n,i,r,a,!1,f),v=[u,l],p=O.runKernelFunc(function(g,m){var y=g.conv2d(l,u,h);return m([u,l]),y},{x:l,filter:u},function(g,m){var y=m,x=y[0],w=y[1];return T(Za(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return AE(w.shape,g,x,n,r,o)},filter:function(){return Fm(w,g,x.shape,n,r,o)}}},"Conv2D",h,v);return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),SO=D({conv3d_:function(e,t,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=I(e,"x","conv3d"),s=I(t,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),T(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),T(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),T(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),T(function(f,h){return eh(f)||eh(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),T(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Uc(u.shape,s.shape,n,i,r),d=O.runKernelFunc(function(f,h){var v=f.conv3d(u,s,c);return h([u,s]),v},{x:u,$filter:s},function(f,h){T(eh(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var v=h[0],p=h[1];return{x:function(){return PE(v.shape,f,p,n,r)},$filter:function(){return function(g,m,y,x,w){var b=g;g.rank===4&&(b=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var C=m;C.rank===4&&(C=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),T(b.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+b.shape+"."}),T(C.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+C.shape+"."}),T(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),T(b.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+b.shape[4]+") must match input depth in filter ("+y[3]+"."}),T(C.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+C.shape[4]+") must match output depth for filter ("+y[4]+")."});var S=Uc(b.shape,y,x,1,w);return O.runKernelFunc(function(_){return _.conv3dDerFilter(b,C,S)},{x5D:b,dy5D:C})}(v,f,p.shape,n,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Fm=D({conv2dDerFilter_:function(e,t,n,r,o,i,a){i===void 0&&(i="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),T(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),T(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),T(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];T(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),T(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&T(st(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=_m(i),f=zi(s.shape,n,r,1,o,a,!1,d);return O.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),AE=D({conv2dDerInput_:TE}),Wd=D({depthwiseConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=I(e,"x","depthwiseConv2d"),u=I(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),T(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),T(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),T(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),T(ln(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&T(st(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=zi(l.shape,u.shape,n,i,r,a,!0),f=[l,u],h=O.runKernelFunc(function(v,p){var g=v.depthwiseConv2D(l,u,d);return p([l,u]),g},{x:l,filter:u},function(v,p){T(Za(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=p[0],m=p[1];return{x:function(){return NE(g.shape,v,m,d)},filter:function(){return DE(g,v,m.shape,d)}}},"DepthwiseConv2dNative",d,f);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),NE=D({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;t.rank===3&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=O.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),DE=D({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),O.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Om=D({separableConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=I(e,"x","separableConv2d"),u=I(t,"depthwiseFilter","separableConv2d"),l=I(n,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),T(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),T(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),T(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),T(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],h=u.shape[3];T(l.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+l.shape[2]+"."});var v=Wd(c,u,r,o,a,i),p=Vn(v,l,1,"valid",a);return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),_O=D({conv2dTranspose_:function(e,t,n,r,o,i){return TE(n,I(e,"x","conv2dTranspose"),I(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),kO=D({conv3dTranspose_:function(e,t,n,r,o){return PE(n,I(e,"x","conv3dTranspose"),I(t,"filter","conv3dTranspose"),r,o)}}),zd=D({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=I(e,"a","matMul"),a=I(t,"b","matMul");o=tt(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=ce(d),v=ce(f);T(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),T(St(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),T(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var p=i.shape.slice(0,-2).concat([l,c]),g=n?i.as3D(h,s,l):i.as3D(h,l,s),m=r?a.as3D(v,c,u):a.as3D(v,u,c),y={transposeA:n,transposeB:r};return O.runKernelFunc(function(x,w){var b=x.batchMatMul(g,m,n,r);return w([g,m]),b},{a:g,b:m},function(x,w){var b=w,C=b[0],S=b[1];return n||r?!n&&r?{a:function(){return x.matMul(S,!1,!1)},b:function(){return x.matMul(C,!0,!1)}}:n&&!r?{a:function(){return S.matMul(x,!1,!0)},b:function(){return C.matMul(x,!1,!1)}}:{a:function(){return S.matMul(x,!0,!0)},b:function(){return x.matMul(C,!0,!0)}}:{a:function(){return x.matMul(S,!1,!0)},b:function(){return C.matMul(x,!0,!1)}}},"BatchMatMul",y).reshape(p)}}),RO=D({dot_:function(e,t){var n=I(e,"t1","dot"),r=I(t,"t2","dot");T(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return T(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),IO=D({outerProduct_:function(e,t){var n=I(e,"v1","outerProduct"),r=I(t,"v2","outerProduct");return T(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Lu=D({reverse_:function(e,t){var n=I(e,"x","reverse");if(n.rank===0)return n.clone();var r=xt(t,n.shape);return O.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),TO=D({reverse1d_:function(e){var t=I(e,"x","reverse");return T(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Lu(t,0)}}),PO=D({reverse2d_:function(e,t){var n=I(e,"x","reverse");return T(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Lu(n,t)}}),AO=D({reverse3d_:function(e,t){var n=I(e,"x","reverse");return T(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Lu(n,t)}}),NO=D({reverse4d_:function(e,t){var n=I(e,"x","reverse");return T(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Lu(n,t)}});function ME(e,t,n,r,o,i){var a=I(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),T(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),T(ln(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&T(st(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=vu(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&St(l.inShape,l.outShape))return a.clone();var c=[s],d=O.runKernelFunc(function(f,h){var v=f.maxPool(s,l);return h([s,v]),v},{x:s},function(f,h){var v=h[0],p=h[1];return{x:function(){return function(g,m,y,x,w,b,C,S){var _=I(g,"dy","maxPoolBackprop"),k=I(m,"input","maxPoolBackprop"),R=I(y,"output","maxPoolBackprop");T(k.rank===_.rank,function(){return"Rank of input ("+k.rank+") does not match rank of dy ("+_.rank+")"}),T(ln(w,b),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),T(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),T(k.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+k.rank+"."});var N=vu(k.shape,x,w,b,C,S);return O.runKernelFunc(function(P){return P.maxPoolBackprop(_,k,R,N)},{$dy:_,$input:k})}(f,v,p,t,n,r,o)}}},"MaxPool",l,c);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function FE(e,t,n,r,o,i){var a=I(e,"x","avgPool","float32");T(ln(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),T(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&T(st(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=vu(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&St(l.inShape,l.outShape))return a.clone();var c=O.runKernelFunc(function(d){return d.avgPool(s,l)},{x:s},function(d){return{x:function(){return function(f,h,v,p,g,m){var y=I(f,"dy","avgPoolBackprop"),x=I(h,"input","avgPoolBackprop");T(x.rank===y.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+y.rank+")"}),T(ln(p,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+p+" and dilations '"+g+"'"});var w=x,b=y,C=!1;x.rank===3&&(C=!0,w=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),b=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),T(b.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+b.rank+"."}),T(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var S=vu(w.shape,v,p,g,m),_=O.runKernelFunc(function(k){return k.avgPoolBackprop(b,w,S)},{dy4D:b,input4D:w});return C?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(d,s,t,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var bt=D({maxPool_:function(e,t,n,r,o){return ME(e,t,n,1,r,o)}}),Bu=D({avgPool_:function(e,t,n,r,o){return FE(e,t,n,1,r,o)}}),DO=D({pool_:function(e,t,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=I(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),T(ln(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=vu(s.shape,t,i,o,r),d=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(w,b){var C=w.map(function(k,R){return k+(k-1)*(b[R]-1)}).map(function(k){return k-1}),S=C.map(function(k){return Math.floor(k/2)}),_=C.map(function(k,R){return k-S[R]});return C.map(function(k,R){return[S[R],_[R]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,b,C){var S=C.map(function(M){return M[0]}),_=C.map(function(M){return M[1]}),k=w.concat(S,_),R=b.map(function(M,W){return(M-k[W]%M)%M}),N=_.map(function(M,W){return M+R[W]}),P=b.map(function(M,W){return[S[W],N[W]]}),L=b.map(function(M,W){return[0,R[W]]});return[P,L]}([c.inHeight,c.inWidth],d,l),v=h[0],p=h[1],g=f?r:"valid",m=f?s:$C(s,d,v),y=(n==="avg"?function(){return FE(m,t,i,1,g)}:function(){return ME(m,t,i,1,g)})(),x=f?y:BC(y,d,p);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),MO=D({maxPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=I(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),T(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),T(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),T(ln(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&T(st(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=$c(u.shape,t,n,a,r,o,i),d=O.runKernelFunc(function(f,h){var v=f.maxPool3d(u,c);return h([u,v]),v},{x:u},function(f,h){var v=h[0],p=h[1];return{x:function(){return function(g,m,y,x,w,b,C,S){var _=I(g,"dy","maxPool3dBackprop"),k=I(m,"input","maxPool3dBackprop"),R=I(y,"output","maxPool3dBackprop"),N=_,P=k,L=R,M=!1;k.rank===4&&(M=!0,N=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),P=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),L=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3])),T(N.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+N.rank+"."}),T(P.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."}),T(L.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+L.rank+"."}),b==null&&(b=[1,1,1]),T(ln(w,b),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),S!=null&&T(st(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+S+" but got pad "+C+"."});var W=$c(P.shape,x,w,b,C,S),B=O.runKernelFunc(function(z){return z.maxPool3dBackprop(N,P,L,W)},{dy5D:N,input5D:P});return M?B.as4D(B.shape[1],B.shape[2],B.shape[3],B.shape[4]):B}(f,v,p,t,n,a,r,o)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),FO=D({avgPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=I(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),T(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),T(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),T(ln(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&T(st(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=$c(u.shape,t,n,a,r,o,i),d=O.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(h,v,p,g,m,y,x){var w=I(h,"dy","avgPool3dBackprop"),b=I(v,"input","avgPool3dBackprop"),C=w,S=b,_=!1;b.rank===4&&(_=!0,C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),S=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3])),T(C.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+C.rank+"."}),T(S.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+S.rank+"."}),m==null&&(m=[1,1,1]),T(ln(g,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"}),x!=null&&T(st(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+y+"."});var k=$c(S.shape,p,g,m,y,x),R=O.runKernelFunc(function(N){return N.avgPool3dBackprop(C,S,k)},{dy5D:C,input5D:S});return _?R.as4D(R.shape[1],R.shape[2],R.shape[3],R.shape[4]):R}(f,u,t,n,a,r,o)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Ar=D({slice_:function(e,t,n){var r,o,i=I(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){T(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(T(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),lM(i,r,o);var a=i.shape,s={begin:r,size:o};return O.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),OO=D({slice1d_:function(e,t,n){var r=I(e,"x","slice1d");return T(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Ar(r,[t],[n])}}),LO=D({slice2d_:function(e,t,n){var r=I(e,"x","slice2d");return T(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Ar(r,t,n)}}),OE=D({slice3d_:function(e,t,n){var r=I(e,"x","slice3d");return T(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Ar(r,t,n)}}),BO=D({slice4d_:function(e,t,n){var r=I(e,"x","slice4d");return T(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Ar(r,t,n)}});function LE(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(un(t.shape,r))),e.rank<n.rank&&(e=e.reshape(un(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return o==null?i:i.transpose(o)}}}var WO=D({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","all","bool"),o=xt(t,r.shape),i=o,a=Or(i,r.rank);a!=null&&(r=r.transpose(a),i=Lr(i.length,r.rank));var s=O.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=un(s.shape,o);return s.reshape(u)}return s}}),zO=D({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","any","bool"),o=xt(t,r.shape),i=o,a=Or(i,r.rank);a!=null&&(r=r.transpose(a),i=Lr(i.length,r.rank));var s=O.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=un(s.shape,o);return s.reshape(u)}return s}}),$O=D({argMax_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","argMax");t==null&&(t=0);var r=xt(t,n.shape),o=Or(r,n.rank);o!=null&&(n=n.transpose(o),r=Lr(r.length,n.rank));var i={axis:r[0]},a=[n];return O.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return Ne(l)}}},"ArgMax",i,a)}}),UO=D({argMin_:function(e,t){t===void 0&&(t=0);var n=I(e,"x","argMin");t==null&&(t=0);var r=xt(t,n.shape),o=Or(r,n.rank);return o!=null&&(n=n.transpose(o),r=Lr(r.length,n.rank)),O.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Ne(s)}}})}}),VO=D({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","logSumExp"),o=xt(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=un(s.shape,o);return s.reshape(u)}return s}}),$d=D({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","max"),o=r,i=xt(t,r.shape),a=i,s=Or(a,r.rank);s!=null&&(r=r.transpose(s),a=Lr(a.length,r.rank));var u=[r],l=O.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return LE(d,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=un(l.shape,i);l=l.reshape(c)}return l}}),jO=D({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","mean"),o=xt(t,r.shape),i=ce(Ot(r.shape,o)[1]);return Od(function(a){var s=ee(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(cs(a.shape,"float32")).div(i)}}})(r)}}),HO=D({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","min"),o=r,i=xt(t,r.shape),a=i,s=Or(a,r.rank);s!=null&&(r=r.transpose(s),a=Lr(a.length,r.rank));var u=[r],l=O.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return LE(d,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=un(l.shape,i);l=l.reshape(c)}return l}}),GO=D({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=xt(t,(e=I(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=un(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),BE=D({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=xt(t,r.shape);return Od(function(i){var a=Or(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Lr(s.length,i.rank));var l=function(h){var v=i.shape.slice();return o.forEach(function(p){v[p]=1}),h.reshape(v).mul(cs(i.shape,"float32"))},c={axes:s},d=O.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var f=un(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:l}})(r)}}),KO=D({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=I(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=xt(t,r.shape),i=Or(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Lr(a.length,r.rank));var u=O.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=un(u.shape,o);u=u.reshape(l)}return u}}),WE=D({elu_:function(e){var t=I(e,"x","elu");return O.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return O.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),qO=D({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=I(e,"x","leakyRelu");return Dm(ee(t).mul(n),n)}}),zE=D({prelu_:function(e,t){var n=I(e,"x","prelu"),r=I(t,"alpha","prelu");return O.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return Di(u,o,o.mul(s))},alpha:function(){var l=Di(u,Ne(o),o.mul(a)),c=gt(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),Je=D({relu_:function(e){var t=I(e,"x","relu");return t.dtype==="bool"?t.toInt():O.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),$E=D({relu6_:function(e){var t=I(e,"x","relu6");return t.dtype==="bool"?t.toInt():O.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),XO=D({selu_:function(e){var t=I(e,"x","selu");return O.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(ee(0)),a=ee(Pm),s=ee(Am),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return Di(i,u,l)}}})}}),Yo=D({transpose_:function(e,t){var n=I(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,i){return i}).reverse()),T(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){T(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return O.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var i=wm(t);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),YO=D({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=I(e,"x","localResponseNormalization");T(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),T(st(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=O.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(a,t,n,r,o);return c([a,d]),d},{x4D:a},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return O.runKernelFunc(function(h){return h.LRNGrad(l,d,f,t,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),UE=D({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ee(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=I(e,"x","norm"),t,n),i=o.shape;if(r){var a=xt(n,e.shape);i=un(o.shape,a)}return o.reshape(i)}}),QO=D({basicLSTMCell_:function(e,t,n,r,o,i){var a=I(e,"forgetBias","basicLSTMCell"),s=I(t,"lstmKernel","basicLSTMCell"),u=I(n,"lstmBias","basicLSTMCell"),l=I(r,"data","basicLSTMCell"),c=I(o,"c","basicLSTMCell"),d=I(i,"h","basicLSTMCell"),f=l.concat(d,1).matMul(s).add(u),h=f.shape[0],v=f.shape[1]/4,p=[h,v],g=f.slice([0,0],p),m=f.slice([0,v],p),y=f.slice([0,2*v],p),x=f.slice([0,3*v],p),w=g.sigmoid().mulStrict(m.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),b=w.tanh().mulStrict(x.sigmoid());return[w,b]}}),JO=D({multiRNNCell_:function(e,t,n,r){for(var o=I(t,"data","multiRNNCell"),i=Fc(n,"c","multiRNNCell"),a=Fc(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),ZO=D({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var i=I(e,"v","movingAverage"),a=I(t,"x","movingAverage"),s=I(n,"decay","movingAverage");YD(i,a),T(St(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ee(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){T(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=I(r,"step","movingAverage");c=c.div(u.sub(Hc(s,d)))}return i.add(c)}}),eL=D({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=I(e,"x","stridedSlice"),c=N0(s),d=l.shape.slice();c.forEach(function(g){t[g]=0,n[g]=1,d.splice(g,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)t[f]=cM(o,t,r,l.shape,f),n[f]=dM(i,n,r,l.shape,f),r[f]=r[f]||1;var h=N0(u);h.forEach(function(g){n[g]=t[g]+1,r[g]=1});var v=Sm(t,n,r),p=v.filter(function(g,m){return h.indexOf(m)===-1});return r.every(function(g){return g===1})?Ar(l,t,v).reshape(p):O.runKernelFunc(function(g){return g.stridedSlice(l,t,n,r)},{$x:l}).reshape(p)}}),tL=D({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=I(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=O.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),nL=D({scatterND_:function(e,t,n){var r=I(e,"indices","scatterND","int32"),o=I(t,"updates","scatterND");return uM(o,r,n),O.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Lm=D({fft_:function(e){T(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return O.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),Gc=D({ifft_:function(e){T(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return O.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Bm=D({rfft_:function(e,t){T(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(m){return 0}),a=e.shape.map(function(m){return m});a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(m){return m});s[e.shape.length-1]=t-r,n=e.concat(Ke(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=Rt(n,u).as2D(o,r),c=Lm(l),d=Math.floor(r/2)+1,f=Fn(c),h=Er(c),v=f.split([d,r-d],f.shape.length-1),p=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Rt(v[0],p[0]).reshape(g)}}),VE=D({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Gc(r);return Fn(o)}var i=[n,2*(t-1)],a=Fn(e).as2D(n,t),s=Er(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(ee(-1)),c=a.concat(u,1),d=s.concat(l,1);return r=Rt(c,d).as2D(i[0],i[1]),o=Gc(r),Fn(o)}}),rL=Object.freeze({fft:Lm,ifft:Gc,rfft:Bm,irfft:VE}),oL=D({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=I(e,"sparseIndices","sparseToDense","int32"),i=I(t,"sparseValues","sparseToDense"),a=I(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),O.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),iL=D({gatherND_:function(e,t){var n=I(t,"indices","gatherND","int32"),r=I(e,"x","gatherND");return O.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),aL=D({diag_:function(e){var t=I(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return O.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),sL=D({dropout_:function(e,t,n,r){var o=I(e,"x","dropout");if(T(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),T(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Qe?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if(St(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?c.push(u.shape[d]):c.push(l[d]);return c}return l}(o,n),a=1-t,s=zC(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function jE(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return lt(o,"float32")}var Wm=D({hannWindow_:function(e){return jE(e,.5,.5)}}),HE=D({hammingWindow_:function(e){return jE(e,.54,.46)}}),zm=D({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Ar(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=pt([Ar(e,i,t-s),Tr([s],o)]);a.push(u),i+=n}return a.length===0?$o([],[0,t]):pt(a).as2D(a.length,t)}}),GE=D({stft_:function(e,t,n,r,o){var i;o===void 0&&(o=Wm),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=zm(e,t,n),s=$t(a,o(t)),u=[],l=0;l<a.shape[0];l++)u.push(Bm(s.slice([l,0],[1,t]),r));return pt(u)}}),uL=Object.freeze({hannWindow:Wm,hammingWindow:HE,frame:zm,stft:GE}),zt,lL=function(e,t,n){return n===void 0&&(n=1),se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,p,g;return ue(this,function(m){switch(m.label){case 0:return r=I(e,"predictions","inTopK"),o=I(t,"targets","inTopK"),T(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),T(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),We(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],T(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=m.sent(),[4,o.data()];case 2:for(s=m.sent(),u=[a.length/i,i],c=u[1],d=fu("bool",l=u[0]),f=0;f<l;f++){for(h=f*c,v=a.subarray(h,h+c),p=[],g=0;g<v.length;g++)p.push({value:v[g],index:g});for(p.sort(function(y,x){return x.value-y.value}),d[f]=0,g=0;g<n;g++)if(p[g].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,Tt(d,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(zt||(zt={}));var cL=D({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=zt.SUM_BY_NONZERO_WEIGHTS);var o=I(e,"labels","absoluteDifference"),i=I(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=I(n,"weights","absoluteDifference")),We(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return oo(s,a,r)}}),oo=D({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=zt.SUM_BY_NONZERO_WEIGHTS);var r=I(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=I(t,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===zt.NONE)return i;if(n===zt.SUM)return i.sum();if(n===zt.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ee(a)):s}if(n===zt.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(ee(r.size));var u=o.mul(cs(r.shape)).notEqual(ee(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),dL=D({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=zt.SUM_BY_NONZERO_WEIGHTS);var i=I(e,"labels","cosineDistance"),a=I(t,"predictions","cosineDistance"),s=null;r!=null&&(s=I(r,"weights","cosineDistance")),We(i.shape,a.shape,"Error in cosineDistance: ");var u=ee(1).sub(i.mul(a).sum(n,!0));return oo(u,s,o)}}),fL=D({hingeLoss_:function(e,t,n,r){r===void 0&&(r=zt.SUM_BY_NONZERO_WEIGHTS);var o=I(e,"labels","hingeLoss"),i=I(t,"predictions","hingeLoss"),a=null;n!=null&&(a=I(n,"weights","hingeLoss")),We(o.shape,i.shape,"Error in hingeLoss: ");var s=ee(1);o=ee(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return oo(u,a,r)}}),hL=D({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=zt.SUM_BY_NONZERO_WEIGHTS);var i=I(e,"labels","huberLoss"),a=I(t,"predictions","huberLoss"),s=null;n!=null&&(s=I(n,"weights","huberLoss")),We(i.shape,a.shape,"Error in huberLoss: ");var u=ee(r),l=a.sub(i).abs(),c=_E(l,u),d=l.sub(c),f=ee(.5).mul(c.square()).add(u.mul(d));return oo(f,s,o)}}),pL=D({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=zt.SUM_BY_NONZERO_WEIGHTS);var i=I(e,"labels","logLoss"),a=I(t,"predictions","logLoss"),s=null;n!=null&&(s=I(n,"weights","logLoss")),We(i.shape,a.shape,"Error in logLoss: ");var u=ee(1),l=ee(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return oo(c,s,o)}}),vL=D({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=zt.SUM_BY_NONZERO_WEIGHTS);var o=I(e,"labels","meanSquaredError"),i=I(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=I(n,"weights","meanSquaredError")),We(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return oo(s,a,r)}}),mL=D({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=zt.SUM_BY_NONZERO_WEIGHTS);var i=I(e,"multiClassLabels","sigmoidCrossEntropy"),a=I(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=I(n,"weights","sigmoidCrossEntropy")),We(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ee(r),l=ee(1),c=ee(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var d=function(f,h){var v=I(f,"labels","sigmoidCrossEntropyWithLogits"),p=I(h,"logits","sigmoidCrossEntropyWithLogits");We(v.shape,p.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=p.relu(),m=p.mul(v),y=p.abs().neg().exp().log1p();return g.sub(m).add(y)}(i,a);return oo(d,s,o)}}),gL=D({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=zt.SUM_BY_NONZERO_WEIGHTS);var i=I(e,"onehotLabels","softmaxCrossEntropy"),a=I(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=I(n,"weights","softmaxCrossEntropy")),We(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ee(r),l=ee(1),c=ee(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var d=function(f,h,v){if(v===void 0&&(v=-1),v===-1&&(v=h.rank-1),v!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+v);return Od(function(p,g,m){var y=g.logSumExp([v],!0),x=g.toFloat().sub(y);return m([p,x]),{value:x.mul(p).neg().sum([v]),gradFunc:function(w,b){var C=b[0],S=b[1],_=un(w.shape,[v]);return[w.reshape(_).mul(C.toFloat().sub(S.exp())),w.reshape(_).mul(S.exp().sub(C.toFloat()))]}}})(f,h)}(i,a);return oo(d,s,o)}}),yL=Object.freeze({get Reduction(){return zt},absoluteDifference:cL,computeWeightedLoss:oo,cosineDistance:dL,hingeLoss:fL,huberLoss:hL,logLoss:pL,meanSquaredError:vL,sigmoidCrossEntropy:mL,softmaxCrossEntropy:gL});function e1(e,t){return t===void 0&&(t=!1),O.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=WC(n),i=e.clone(),a=$o([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(d){var f,h=i,v=s,p=o;f=O.tidy(function(){var g=i.slice([d,d],[n-d,1]),m=g.norm(),y=i.slice([d,d],[1,1]),x=$o([[-1]]).where(y.greater(0),$o([[1]])),w=y.sub(x.mul(m)),b=g.div(w);s=b.shape[0]===1?a.clone():a.concat(b.slice([1,0],[b.shape[0]-1,b.shape[1]]),0);var C=x.matMul(w).div(m).neg(),S=i.slice([d,0],[n-d,r]),_=C.mul(s);if(d===0)i=S.sub(_.matMul(s.transpose().matMul(S)));else{var k=S.sub(_.matMul(s.transpose().matMul(S)));i=i.slice([0,0],[d,r]).concat(k,0)}var R=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=R.sub(R.matMul(s).matMul(_.transpose()));else{var N=R.sub(R.matMul(s).matMul(_.transpose()));o=o.slice([0,0],[n,d]).concat(N,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],an([h,v,p])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var xL=D({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=I(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=Oc(0,a,1,"int32").reshape([-1,1]),l=Oc(0,s,1,"int32"),c=yt(u,l),d=Bd(c.lessEqual(ee(+t,"int32")),c.greaterEqual(ee(-n,"int32"))),f=Ke([a,s],r.dtype);return _n(vt(r.reshape([-1,a,s])).map(function(h){return Di(d,h,f)})).reshape(o)}}),wL=D({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,T(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){T(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=Cm(e,e.shape[0],0).map(function(u){return UC(u,[0])});T(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(u){i.push(O.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var d=BE(i[c].mulStrict(l)).mul(i[c]);l=l.sub(d)}return l.div(UE(l,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?_n(i,0):i}}),bL=D({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return e1(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=vt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=e1(a,t),u=s[0],l=s[1];o.push(u),i.push(l)}),[_n(o,0).reshape(e.shape),_n(i,0).reshape(e.shape)]}}),CL=Object.freeze({bandPart:xL,gramSchmidt:wL,qr:bL});function Ud(e,t,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=e.shape[0];return n=Math.min(n,a),T(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),T(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),T(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),T(t.rank===1,function(){return"scores must be a 1D tensor"}),T(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),T(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var EL=D({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=I(e,"images","resizeBilinear");T(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),T(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=O.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return O.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),SL=D({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=I(e,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),T(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),T(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=O.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return O.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),_L=D({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=I(e,"boxes","nonMaxSuppression"),a=I(t,"scores","nonMaxSuppression"),s=Ud(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return O.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),kL=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),se(this,void 0,void 0,function(){var i,a,s,u,l,c,d;return ue(this,function(f){switch(f.label){case 0:return i=I(e,"boxes","nonMaxSuppressionAsync"),a=I(t,"scores","nonMaxSuppressionAsync"),s=Ud(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],d=km(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,d]}})})},RL=D({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=I(e,"boxes","nonMaxSuppression"),s=I(t,"scores","nonMaxSuppression"),u=Ud(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=O.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),IL=function(e,t,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),se(this,void 0,void 0,function(){var a,s,u,l,c,d,f;return ue(this,function(h){switch(h.label){case 0:return a=I(e,"boxes","nonMaxSuppressionAsync"),s=I(t,"scores","nonMaxSuppressionAsync"),u=Ud(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=h.sent(),c=l[0],d=l[1],f=Rm(c,d,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,f]}})})},TL=D({cropAndResize_:function(e,t,n,r,o,i){var a=I(e,"image","cropAndResize"),s=I(t,"boxes","cropAndResize","float32"),u=I(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return T(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),T(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),T(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),T(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),T(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),T(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),O.runKernelFunc(function(c,d){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),$m=Object.freeze({resizeBilinear:EL,resizeNearestNeighbor:SL,nonMaxSuppression:_L,nonMaxSuppressionAsync:kL,nonMaxSuppressionWithScore:RL,nonMaxSuppressionWithScoreAsync:IL,cropAndResize:TL}),Um=function(e,t){return!(e>0)||t==="linear"},Vm=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},jm=function(e,t){var n=t,r=gt(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Hm=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Je(e);if(t==="elu")return WE(e);if(t==="relu6")return $E(e);if(t==="prelu")return zE(e,n);throw new Error("Unknown fused activation "+t+".")},PL=D({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=o!==void 0&&o,a=e.transposeB,s=a!==void 0&&a,u=e.bias,l=e.activation,c=l===void 0?"linear":l,d=e.preluActivationWeights;if(Um(O.state.gradientDepth,c)===!1){var f=zd(n,r,i,s);return u!=null&&(f=Re(f,u)),Hm(f,c,d)}var h=I(n,"a","fused matMul"),v=I(r,"b","fused matMul");t=tt(h,v),h=t[0],v=t[1];var p=i?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?v.shape[v.rank-1]:v.shape[v.rank-2],m=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?v.shape[v.rank-2]:v.shape[v.rank-1],x=h.shape.slice(0,-2),w=v.shape.slice(0,-2),b=ce(x),C=ce(w);T(h.rank>=2&&v.rank>=2&&h.rank===v.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+v.rank+"."}),T(St(x,w),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+w+") of Tensors with shapes "+h.shape+" and "+v.shape+" must match."}),T(p===g,function(){return"Error in fused matMul: inner shapes ("+p+") and ("+g+") of Tensors with shapes "+h.shape+" and "+v.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var S,_,k=h.shape.slice(0,-2).concat([m,y]),R=i?h.as3D(b,p,m):h.as3D(b,m,p),N=s?v.as3D(C,y,g):v.as3D(C,g,y);u!=null&&Ie(k,(S=tt(S=I(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(_=I(d,"prelu weights","fused matMul"));var P={a:R,b:N};u!=null&&(P.bias=S),d!=null&&(P.preluActivationWeights=_);var L=[R,N];return O.runKernelFunc(function(M,W){var B=M.fusedBatchMatMul({a:R,b:N,transposeA:i,transposeB:s,bias:S,activation:c,preluActivationWeights:_});return W([R,N,B]),B},P,function(M,W){var B=W[0],z=W[1],A=W[2],F=Vm(M,A,c),U={};return u!=null&&(U={bias:function(){return jm(S,F)}}),Object.assign(i||s?!i&&s?{a:function(){return F.matMul(z,!1,!1)},b:function(){return F.matMul(B,!0,!1)}}:i&&!s?{a:function(){return z.matMul(F,!1,!0)},b:function(){return B.matMul(F,!1,!1)}}:{a:function(){return z.matMul(F,!0,!0)},b:function(){return F.matMul(B,!0,!0)}}:{a:function(){return F.matMul(z,!1,!0)},b:function(){return B.matMul(F,!0,!1)}},U)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},L,[!0]).reshape(k)}}),AL=D({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(f=f||"linear",Um(O.state.gradientDepth,f)===!1){var v=Vn(t,n,r,o,a,u,l);return c!=null&&(v=Re(v,c)),Hm(v,f,h)}var p=I(t,"x","conv2d"),g=I(n,"filter","conv2d"),m=p,y=!1;p.rank===3&&(y=!0,m=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),T(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),T(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&T(st(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),T(m.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),T(ln(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),T(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var x,w,b=zi(m.shape,g.shape,r,u,o,l);c!=null&&(x=tt(x=I(c,"bias","fused conv2d"),p)[0],Ie(b.outShape,x.shape)),h!=null&&(w=I(h,"prelu weights","fused conv2d"));var C={x:m,filter:g};c!=null&&(C.bias=x),h!=null&&(C.preluActivationWeights=w);var S=[g,m],_=O.runKernelFunc(function(k,R){var N=k.fusedConv2d({input:m,filter:g,convInfo:b,bias:x,activation:f,preluActivationWeights:w});return R([g,m,N]),N},C,function(k,R){var N=R,P=N[0],L=N[1],M=N[2],W=Vm(k,M,f);T(Za(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var B={};return c!=null&&(B={bias:function(){return jm(x,W)}}),Object.assign({x:function(){return AE(L.shape,W,P,r,o)},filter:function(){return Fm(L,W,P.shape,r,o)}},B)},"FusedConv2D",{convInfo:b,activation:f},S,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),NL=D({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(Um(O.state.gradientDepth,f)===!1){var v=Wd(t,n,r,o,a,u,l);return c!=null&&(v=Re(v,c)),Hm(v,f,h)}var p=I(t,"x","depthwiseConv2d"),g=I(n,"filter","depthwiseConv2d"),m=p,y=!1;p.rank===3&&(y=!0,m=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),T(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),T(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),T(m.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),T(ln(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&T(st(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var x,w,b=zi(m.shape,g.shape,r,u,o,l,!0);c!=null&&(x=tt(x=I(c,"bias","fused conv2d"),p)[0],Ie(b.outShape,x.shape)),h!=null&&(w=I(h,"prelu weights","fused depthwiseConv2d"));var C={x:m,filter:g};c!=null&&(C.bias=x),h!=null&&(C.preluActivationWeights=w);var S=[g,m],_=O.runKernelFunc(function(k,R){var N=k.fusedDepthwiseConv2D({input:m,filter:g,convInfo:b,bias:x,activation:f,preluActivationWeights:w});return R([g,m,N]),N},C,function(k,R){T(Za(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var N=R[0],P=R[1],L=R[2],M=Vm(k,L,f),W={};return c!=null&&(W={bias:function(){return jm(x,M)}}),Object.assign({x:function(){return NE(P.shape,M,N,b)},filter:function(){return DE(P,M,N.shape,b)}},W)},"FusedDepthwiseConv2D",{convInfo:b,activation:f},S,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),DL=Object.freeze({matMul:PL,conv2d:AL,depthwiseConv2d:NL}),ML=Object.freeze({image:$m,linalg:CL,losses:yL,spectral:rL,fused:DL,signal:uL,square:p4,squaredDifference:vE,conv1d:EO,conv2d:Vn,conv3d:SO,depthwiseConv2d:Wd,separableConv2d:Om,conv2dTranspose:_O,conv3dTranspose:kO,op:D,batchNormalization2d:j4,batchNormalization3d:H4,batchNormalization4d:G4,batchNormalization:K4,batchNorm:bE,batchNorm2d:q4,batchNorm3d:X4,batchNorm4d:Y4,booleanMaskAsync:CO,complex:Rt,real:Fn,imag:Er,concat:pt,concat1d:D3,concat2d:M3,concat3d:F3,concat4d:O3,split:Cm,matMul:zd,dot:RO,outerProduct:IO,reverse:Lu,reverse1d:TO,reverse2d:PO,reverse3d:AO,reverse4d:NO,maxPool:bt,avgPool:Bu,pool:DO,maxPool3d:MO,avgPool3d:FO,slice:Ar,slice1d:OO,slice2d:LO,slice3d:OE,slice4d:BO,abs:v4,acos:m4,acosh:g4,asin:y4,asinh:x4,atan:w4,atanh:b4,ceil:C4,clipByValue:Nm,cos:E4,cosh:S4,erf:_4,exp:Up,expm1:k4,floor:R4,log:I4,log1p:T4,logSigmoid:P4,neg:jc,reciprocal:A4,round:N4,rsqrt:mE,sigmoid:gE,sign:D4,isNaN:M4,isInf:F4,isFinite:O4,sin:L4,sinh:B4,softplus:W4,sqrt:z4,step:$4,tan:U4,tanh:V4,all:WO,any:zO,argMax:$O,argMin:UO,logSumExp:VO,max:$d,mean:jO,min:HO,moments:GO,sum:BE,prod:KO,equal:kE,equalStrict:fO,greater:hO,greaterEqual:RE,greaterEqualStrict:pO,greaterStrict:vO,less:mO,lessEqual:gO,lessEqualStrict:yO,lessStrict:xO,notEqual:wO,notEqualStrict:bO,add:Re,addN:Z4,addStrict:eO,atan2:tO,div:Jn,divNoNan:nO,divStrict:rO,floorDiv:SE,maximum:Dm,maximumStrict:oO,minimum:_E,minimumStrict:iO,mod:aO,modStrict:sO,mul:$t,mulStrict:uO,pow:Hc,powStrict:lO,squaredDifferenceStrict:cO,sub:yt,subStrict:dO,elu:WE,leakyRelu:qO,prelu:zE,relu:Je,relu6:$E,selu:XO,logicalAnd:Bd,logicalNot:Q4,logicalOr:CE,logicalXor:J4,where:Di,whereAsync:EE,buffer:be,print:H3,batchToSpaceND:BC,broadcastTo:G3,cast:K3,clone:q3,cumsum:X3,depthToSpace:Y3,expandDims:Mn,eye:WC,multinomial:Q3,oneHot:Bp,pad:Wi,pad1d:J3,pad2d:Z3,pad3d:eM,pad4d:tM,rand:nM,randomNormal:rM,randomGamma:oM,randomUniform:zC,reshape:Zn,spaceToBatchND:$C,squeeze:UC,stack:_n,tile:_a,truncatedNormal:iM,unstack:vt,setdiff1dAsync:aM,fill:Tr,linspace:N3,ones:cs,range:Oc,scalar:ee,tensor:Tt,tensor1d:lt,tensor2d:$o,tensor3d:bm,tensor4d:Zt,tensor5d:T3,tensor6d:P3,variable:A3,zeros:Ke,onesLike:LC,zerosLike:Ne,transpose:Yo,softmax:ro,logSoftmax:hM,localResponseNormalization:YO,norm:UE,gather:Mm,unsortedSegmentSum:IE,basicLSTMCell:QO,multiRNNCell:JO,movingAverage:ZO,stridedSlice:eL,topk:tL,scatterND:nL,fft:Lm,ifft:Gc,rfft:Bm,irfft:VE,sparseToDense:oL,gatherND:iL,diag:aL,dropout:sL,hannWindow:Wm,hammingWindow:HE,frame:zm,stft:GE,inTopKAsync:lL});function X(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&T(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function th(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var FL=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new XC(n,O),n}return ar(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,G().get("IS_NODE")&&Mc(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},t.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?$p(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return Ac(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return be(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return O.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){return r=xr(),n(),[2,{kernelMs:xr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:O.keep(n.clone()),imag:O.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(X(n,"slice"),KC(n.shape,r,o)){var i=qC(r,n.strides),a=ce(o);return Tt(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=be(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(d,f){return d+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,i){X(n,"stridedSlice");var a=Sm(r,o,i);if(a.some(function(h){return h===0}))return Tt([],a);for(var s=be(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=be([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.reverse=function(n,r){X(n,"reverse");for(var o=be(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=n.shape[d]-1-c[d]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return Fn(h)}),a=n.map(function(h){return Er(h)});return Rt(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var v=ce(h.shape.slice(r));return h.as2D(-1,v)}),u=Ja(s.map(function(h){return h.shape}),1),l=be(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;s.forEach(function(h){for(var v=o.readSync(h.dataId),p=0,g=0;g<h.shape[0];++g)for(var m=g*u[1]+d,y=0;y<h.shape[1];++y)l[m+y]=v[p++];d+=h.shape[1]})}var f=Ja(n.map(function(h){return h.shape}),r);return Tt(l,f,n[0].dtype)},t.prototype.neg=function(n){return X(n,"neg"),this.multiply(ee(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,It(n.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(n){var r=this;X(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=be(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},t.prototype.softmax=function(n,r){var o=xt([r],n.shape),i=this.max(n,o),a=un(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,It(n.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(n,r){return X([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(n,r,o,i){X([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],v=f[1],p=f[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=g[0],y=g[1],x=g[2],w=s*u,b=be([l,s,u],n.dtype),C=b.values,S=this.blockSize,_=0;_<l;_++)for(var k=0;k<s;k+=S)for(var R=0;R<u;R+=S)for(var N=0;N<a;N+=S)for(var P=Math.min(k+S,s),L=Math.min(R+S,u),M=Math.min(N+S,a),W=k;W<P;W++)for(var B=R;B<L;B++){for(var z=0,A=N;A<M;A++)z+=c[_*h+W*v+A*p]*d[A*m+B*y+_*x];C[_*w+(W*u+B)]+=z}return b.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=th(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,It(n.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(n,r){return X([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(n,r){return X([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(n,r){X(n,"sum"),mn("sum",r,n.rank);for(var o=Ot(n.shape,r),i=o[0],a=o[1],s=Ke(i,It(n.dtype,"int32")),u=ce(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=0,v=0;v<u;++v)h+=c[f+v];l[d]=h}return s},t.prototype.prod=function(n,r){X(n,"sum");for(var o=Ot(n.shape,r),i=o[0],a=o[1],s=Ke(i,It(n.dtype,"int32")),u=ce(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=1,v=0;v<u;++v)h*=c[f+v];l[d]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,o){X(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ee(s,"int32"),l=kE(u,r).asType("float32").mul(n).sum(0);i.push(l)}return _n(i)},t.prototype.argMin=function(n,r){X(n,"argMin");var o=[r];mn("argMin",o,n.rank);for(var i=Ot(n.shape,o),a=i[0],s=i[1],u=Ke(a,"int32"),l=ce(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,v=d[h],p=0,g=0;g<l;++g){var m=d[h+g];m<v&&(v=m,p=g)}c[f]=p}return u},t.prototype.argMax=function(n,r){X(n,"argMax");var o=[r];mn("argMax",o,n.rank);for(var i=Ot(n.shape,o),a=i[0],s=i[1],u=Ke(a,"int32"),l=ce(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,v=d[h],p=0,g=0;g<l;++g){var m=d[h+g];m>v&&(v=m,p=g)}c[f]=p}return u},t.prototype.cumsum=function(n,r,o,i){if(X(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=It(n.dtype,"int32"),s=Ke(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],d=i?function(g,m){return g+c-m-1}:function(g,m){return g+m},f=0;f<l.length;f+=c)for(var h=0;h<c;h++){var v=d(f,h);if(h===0)u[v]=o?0:l[v];else{var p=d(f,h-1);u[v]=o?l[p]+u[p]:l[v]+u[p]}}return s},t.prototype.equal=function(n,r){return X([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(n,r){return X([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(n,r){return X([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(n,r){return X([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(n,r){return X([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(n,r){return X([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(n){X(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return X([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(n,r){return X([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},t.prototype.select=function(n,r,o){X([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=Ke(r.shape,It(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,d=n.rank===0||n.rank>1||r.rank===1?1:ce(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?l[c++]=a[f]:l[c++]=s[f];return u},t.prototype.where=function(n){X([n],"where");var r=this.readSync(n.dataId);return Im(n.shape,r)},t.prototype.topk=function(n,r,o){return X(n,"topk"),rE(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){X(n,"min"),mn("min",r,n.rank);for(var o=Ot(n.shape,r),i=o[0],a=o[1],s=Ke(i,n.dtype),u=ce(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];p<h&&(h=p)}l[d]=h}return s},t.prototype.minimum=function(n,r){return X([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(n,r){return X([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},t.prototype.max=function(n,r){X(n,"max"),mn("max",r,n.rank);for(var o=Ot(n.shape,r),i=o[0],a=o[1],s=Ke(i,n.dtype),u=ce(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];p>h&&(h=p)}l[d]=h}return s},t.prototype.maximum=function(n,r){return X([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(n,r){X(n,"all"),mn("all",r,n.rank);for(var o=Ot(n.shape,r),i=o[0],a=o[1],s=Ke(i,n.dtype),u=ce(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];h=h&&p}l[d]=h}return s},t.prototype.any=function(n,r){X(n,"any"),mn("any",r,n.rank);for(var o=Ot(n.shape,r),i=o[0],a=o[1],s=Ke(i,n.dtype),u=ce(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];h=h||p}l[d]=h}return s},t.prototype.squaredDifference=function(n,r){return X([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},t.prototype.ceil=function(n){X(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){X(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){X(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){X(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){X(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){X(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){X(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){X(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){X(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){X(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){X(n,"relu");for(var r=Ke(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},t.prototype.relu6=function(n){X(n,"relu");for(var r=Ke(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},t.prototype.prelu=function(n,r){return X([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(n){X(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){X([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){X(n,"selu");for(var r=Pm,o=Am,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,o){X(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){X(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){X(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){X(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){X(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){X(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){X(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){X(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){X(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){X(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return X([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(n){X(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){X(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){X(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=OD(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){X(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){X(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){X(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){X(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),X(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=th(this,l,s,u)),l},t.prototype.conv2d=function(n,r,o){X([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.dataFormat==="channelsLast",f=be(o.outShape,n.dtype),h=n.strides[0],v=d?n.strides[1]:n.strides[2],p=d?n.strides[2]:1,g=d?1:n.strides[1],m=f.strides[0],y=d?f.strides[1]:f.strides[2],x=d?f.strides[2]:1,w=d?1:f.strides[1],b=this.readSync(n.dataId),C=this.readSync(r.dataId),S=f.values,_=0;_<o.batchSize;++_)for(var k=_*h,R=_*m,N=0;N<o.outHeight;++N)for(var P=R+N*y,L=N*o.strideHeight-c,M=0;M<i;M++){var W=L+M*s;if(!(W<0||W>=o.inHeight))for(var B=M*r.strides[0],z=k+W*v,A=0;A<o.outWidth;++A)for(var F=P+A*x,U=A*o.strideWidth-l,j=0;j<a;j++){var K=U+j*u;if(!(K<0||K>=o.inWidth))for(var Y=z+K*p,ne=B+j*r.strides[1],pe=0;pe<o.inChannels;++pe){for(var te=b[Y+pe*g],J=0;J<o.outChannels;++J)S[F+J*w]+=te*C[ne+J];ne+=o.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,v=be(o.outShape,n.dtype),p=this.readSync(n.dataId),g=this.readSync(r.dataId),m=v.values,y=0;y<o.batchSize;++y)for(var x=y*n.strides[0],w=y*v.strides[0],b=0;b<o.outDepth;++b)for(var C=w+b*v.strides[1],S=b*o.strideDepth-d,_=0;_<i;_++){var k=S+_*u;if(!(k<0||k>=o.inDepth))for(var R=_*r.strides[0],N=x+k*n.strides[1],P=0;P<o.outHeight;++P)for(var L=C+P*v.strides[2],M=P*o.strideHeight-h,W=0;W<a;W++){var B=M+W*l;if(!(B<0||B>=o.inHeight))for(var z=R+W*r.strides[1],A=N+B*n.strides[2],F=0;F<o.outWidth;++F)for(var U=L+F*o.outChannels,j=F*o.strideWidth-f,K=0;K<s;K++){var Y=j+K*c;if(!(Y<0||Y>=o.inWidth))for(var ne=z+K*r.strides[2],pe=A+Y*o.inChannels,te=ne,J=0;J<o.inChannels;++J){for(var oe=p[pe+J],ve=0;ve<o.outChannels;++ve)m[U+ve]+=oe*g[te+ve];te+=o.outChannels}}}}return v.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){X([n,r],"conv2dDerInput");for(var i=be(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],h=o.batchSize,v=o.filterHeight,p=o.filterWidth,g=o.inChannels,m=o.inHeight,y=o.inWidth,x=o.outChannels,w=o.outHeight,b=o.outWidth,C=o.strideHeight,S=o.strideWidth,_=o.dataFormat,k=v-1-o.padInfo.top,R=p-1-o.padInfo.left,N=_==="channelsLast",P=i.strides[0],L=N?i.strides[1]:i.strides[2],M=N?i.strides[2]:1,W=N?1:i.strides[1],B=n.strides[0],z=N?n.strides[1]:n.strides[2],A=N?n.strides[2]:1,F=N?1:n.strides[1],U=0;U<h;++U)for(var j=0;j<g;++j)for(var K=0;K<m;++K)for(var Y=K-k,ne=Math.max(0,Math.ceil(Y/C)),pe=Math.min(w,(v+Y)/C),te=0;te<y;++te){for(var J=te-R,oe=Math.max(0,Math.ceil(J/S)),ve=Math.min(b,(p+J)/S),me=0,ie=ne;ie<pe;++ie)for(var le=ie*C-Y,ye=oe;ye<ve;++ye)for(var Pe=B*U+z*ie+A*ye,Fe=c*(v-1-le)+d*(p-1-(ye*S-J))+f*j,Ae=0;Ae<x;++Ae)me+=s[Pe+F*Ae]*u[Fe+Ae];a[P*U+L*K+M*te+W*j]=me}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var i=be(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,v=h[0],p=h[1],g=h[2],m=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],b=x[1],C=x[2],S=x[3],_=o.batchSize,k=o.filterDepth,R=o.filterHeight,N=o.filterWidth,P=o.inChannels,L=o.inDepth,M=o.inHeight,W=o.inWidth,B=o.outChannels,z=o.outDepth,A=o.outHeight,F=o.outWidth,U=o.strideDepth,j=o.strideHeight,K=o.strideWidth,Y=k-1-o.padInfo.front,ne=R-1-o.padInfo.top,pe=N-1-o.padInfo.left,te=0;te<_;++te)for(var J=0;J<P;++J)for(var oe=0;oe<L;++oe)for(var ve=oe-Y,me=Math.max(0,Math.ceil(ve/U)),ie=Math.min(z,(k+ve)/U),le=0;le<M;++le)for(var ye=le-ne,Pe=Math.max(0,Math.ceil(ye/j)),Fe=Math.min(A,(R+ye)/j),Ae=0;Ae<W;++Ae){for(var wt=Ae-pe,Yt=Math.max(0,Math.ceil(wt/K)),Oe=Math.min(F,(N+wt)/K),cn=0,jn=me;jn<ie;++jn)for(var ur=jn*U-ve,Qt=Pe;Qt<Fe;++Qt)for(var uo=Qt*j-ye,Pn=Yt;Pn<Oe;++Pn)for(var ii=v*te+p*jn+g*Qt+m*Pn,dn=w*(k-1-ur)+b*(R-1-uo)+C*(N-1-(Pn*K-wt))+S*J,fn=0;fn<B;++fn)cn+=f[ii+fn]*y[dn+fn];a[u*te+l*oe+c*le+d*Ae+J]=cn}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){X([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=be(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),v=this.bufferSync(r),p=0;p<s;++p)for(var g=Math.max(0,Math.ceil((f-p)/i)),m=Math.min(o.outHeight,(o.inHeight+f-p)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((d-y)/a)),w=Math.min(o.outWidth,(o.inWidth+d-y)/a),b=0;b<o.inChannels;++b)for(var C=0;C<o.outChannels;++C){for(var S=0,_=0;_<o.batchSize;++_)for(var k=g;k<m;++k)for(var R=p+k*i-f,N=x;N<w;++N){var P=y+N*a-d;S+=l?h.get(_,R,P,b)*v.get(_,k,N,C):h.get(_,b,R,P)*v.get(_,C,k,N)}c.set(S,p,y,b,C)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=be(o.filterShape,"float32"),f=d.values,h=d.strides,v=h[0],p=h[1],g=h[2],m=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],b=x[1],C=x[2],S=x[3],_=this.readSync(n.dataId),k=n.strides,R=k[0],N=k[1],P=k[2],L=k[3],M=o.padInfo.front,W=o.padInfo.left,B=o.padInfo.top,z=0;z<u;++z)for(var A=Math.max(0,Math.ceil((M-z)/i)),F=Math.min(o.outDepth,(o.inDepth+M-z)/i),U=z*v,j=0;j<l;++j)for(var K=Math.max(0,Math.ceil((B-j)/a)),Y=Math.min(o.outHeight,(o.inHeight+B-j)/a),ne=j*p+U,pe=0;pe<c;++pe)for(var te=Math.max(0,Math.ceil((W-pe)/s)),J=Math.min(o.outWidth,(o.inWidth+W-pe)/s),oe=pe*g+ne,ve=0;ve<o.inChannels;++ve)for(var me=ve*m+oe,ie=0;ie<o.outChannels;++ie){for(var le=0,ye=0;ye<o.batchSize;++ye)for(var Pe=ye*R,Fe=ye*w,Ae=A;Ae<F;++Ae)for(var wt=(z+Ae*i-M)*N+Pe,Yt=Ae*b+Fe,Oe=K;Oe<Y;++Oe)for(var cn=(j+Oe*a-B)*P+wt,jn=Oe*C+Yt,ur=te;ur<J;++ur){var Qt=ur*S+jn;le+=_[(pe+ur*s-W)*L+cn+ve]*y[Qt+ie]}f[me+ie]=le}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=th(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,o){X([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=be(o.outShape,n.dtype),h=this.readSync(n.dataId),v=this.readSync(r.dataId),p=f.values,g=0;g<o.batchSize;++g)for(var m=g*n.strides[0],y=g*f.strides[0],x=0;x<o.outHeight;++x)for(var w=y+x*f.strides[1],b=x*o.strideHeight-l,C=0;C<i;++C){var S=b+C*s;if(!(S<0||S>=o.inHeight))for(var _=C*r.strides[0],k=m+S*n.strides[1],R=0;R<o.outWidth;++R)for(var N=w+R*f.strides[2],P=R*o.strideWidth-c,L=0;L<a;++L){var M=P+L*u;if(!(M<0||M>=o.inWidth))for(var W=_+L*r.strides[1],B=k+M*o.inChannels,z=N,A=W,F=0;F<o.inChannels;++F){for(var U=h[B+F],j=0;j<d;++j)p[z+j]+=U*v[A+j];z+=d,A+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){X([n,r],"depthwiseConv2DDerInput");for(var i=be(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],v=f[1],p=f[2],g=this.readSync(r.dataId),m=r.strides,y=m[0],x=m[1],w=m[2],b=o.batchSize,C=o.filterHeight,S=o.filterWidth,_=o.inChannels,k=o.inHeight,R=o.inWidth,N=o.outChannels,P=o.outHeight,L=o.outWidth,M=o.strideHeight,W=o.strideWidth,B=C-1-o.padInfo.top,z=S-1-o.padInfo.left,A=N/_,F=0;F<b;++F)for(var U=0;U<_;++U)for(var j=0;j<k;++j)for(var K=j-B,Y=Math.max(0,Math.ceil(K/M)),ne=Math.min(P,(C+K)/M),pe=0;pe<R;++pe){for(var te=pe-z,J=Math.max(0,Math.ceil(te/W)),oe=Math.min(L,(S+te)/W),ve=0,me=Y;me<ne;++me)for(var ie=me*M-K,le=J;le<oe;++le)for(var ye=h*F+v*me+p*le,Pe=y*(C-1-ie)+x*(S-1-(le*W-te))+w*U,Fe=0;Fe<A;++Fe)ve+=d[ye+(U*A+Fe)]*g[Pe+Fe];a[u*F+l*j+c*pe+U]=ve}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){X([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=be(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),v=this.bufferSync(r),p=0;p<s;++p)for(var g=Math.max(0,Math.ceil((d-p)/i)),m=Math.min(o.outHeight,(o.inHeight+d-p)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((c-y)/a)),w=Math.min(o.outWidth,(o.inWidth+c-y)/a),b=0;b<o.outChannels;++b){for(var C=Math.trunc(b/f),S=b%f,_=0,k=0;k<o.batchSize;++k)for(var R=g;R<m;++R)for(var N=p+R*i-d,P=x;P<w;++P){var L=y+P*a-c;_+=h.get(k,N,L,C)*v.get(k,R,P,b)}l.set(_,p,y,C,S)}return l.toTensor()},t.prototype.tile=function(n,r){return X(n,"tile"),nE(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){X(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=be(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),d=c.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,c)].concat(d))}return u.toTensor()},t.prototype.transpose=function(n,r){X(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=be(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=s.locToIndex(c);s.values[f]=a[i]}return s.toTensor()},t.prototype.gather=function(n,r,o){X([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=be(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),d=c.slice();d[o]=a[c[o]];var f=u.locToIndex(d);s.values[l]=u.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){X([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=Lc(n.shape,r,i),s=Bc(a.length,r.length),u=Wc(n.shape,r,i),l=VC(o,r.length),c=jC(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){X([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=Lc(u.shape,r,i,!1),c=Bc(l.length,r.length,!1),d=Wc(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.pool=function(n,r,o){X(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(n.dataId),p=be(r.outShape,n.dtype),g=p.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3],w=0;w<r.batchSize;++w)for(var b=w*m,C=w*n.strides[0],S=0;S<r.inChannels;++S)for(var _=0;_<r.outHeight;++_)for(var k=_*i-d,R=Math.max(0,k),N=Math.min(r.inHeight,l+k),P=b+_*y,L=0;L<r.outWidth;++L){for(var M=L*a-f,W=Math.max(0,M),B=Math.min(r.inWidth,c+M),z=h,A=0,F=0,U=R;U<N;U+=s){for(var j=C+U*n.strides[1],K=W;K<B;K+=u){var Y=v[j+K*n.strides[2]+S];o==="max"&&Y>z?z=Y:o==="avg"&&(A+=Y,F++)}if(isNaN(z))break}g[P+L*x+S]=o==="avg"?A/F:z}return p.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=be(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),v=0;v<r.batchSize;++v)for(var p=0;p<r.inChannels;++p)for(var g=0;g<r.outHeight;++g){for(var m=g*i-d,y=m;y<0;)y+=s;for(var x=Math.min(r.inHeight,l+m),w=0;w<r.outWidth;++w){for(var b=w*a-f,C=b;C<0;)C+=u;for(var S=Math.min(r.inWidth,c+b),_=Number.NEGATIVE_INFINITY,k=-1,R=y;R<x;R+=s)for(var N=R-m,P=C;P<S;P+=u){var L=P-b,M=h.get(v,R,P,p);M>_&&(_=M,k=N*c+L)}o.set(k,v,g,w,p)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,i){X([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,v=d-1-i.padInfo.top,p=be(r.shape,"float32"),g=this.bufferSync(a),m=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var x=0;x<i.inChannels;++x)for(var w=0;w<i.inHeight;++w)for(var b=0;b<i.inWidth;++b){for(var C=w-v,S=b-h,_=0,k=0;k<d;k+=l){var R=(C+k)/s;if(!(R<0||R>=i.outHeight||Math.floor(R)!==R))for(var N=0;N<f;N+=c){var P=(S+N)/u;if(!(P<0||P>=i.outWidth||Math.floor(P)!==P)){var L=d*f-1-g.get(y,R,P,x)===k*f+N?1:0;L!==0&&(_+=m.get(y,R,P,x)*L)}}}p.set(_,y,w,b,x)}return p.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){X([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,v=d-1-o.padInfo.top,p=be(r.shape,"float32"),g=1/(s*u),m=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var x=0;x<o.inChannels;++x)for(var w=0;w<o.inHeight;++w)for(var b=0;b<o.inWidth;++b){for(var C=w-v,S=b-h,_=0,k=0;k<d;k+=l){var R=(C+k)/i;if(!(R<0||R>=o.outHeight||Math.floor(R)!==R))for(var N=0;N<f;N+=c){var P=(S+N)/a;P<0||P>=o.outWidth||Math.floor(P)!==P||(_+=m.get(y,R,P,x))}}p.set(_*g,y,w,b,x)}return p.toTensor()},t.prototype.pool3d=function(n,r,o){X(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,p=r.padInfo.top,g=r.padInfo.left,m=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),x=be(r.outShape,n.dtype),w=x.values,b=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],_=r.outShape[4],k=0;k<r.batchSize;++k)for(var R=k*b,N=k*n.strides[0],P=0;P<r.inChannels;++P)for(var L=0;L<r.outDepth;++L){for(var M=L*i-v,W=M;W<0;)W+=u;for(var B=Math.min(r.inDepth,d+M),z=R+L*C,A=0;A<r.outHeight;++A){for(var F=A*a-p,U=F;U<0;)U+=l;for(var j=Math.min(r.inHeight,f+F),K=z+A*S,Y=0;Y<r.outWidth;++Y){for(var ne=Y*s-g,pe=ne;pe<0;)pe+=c;for(var te=Math.min(r.inWidth,h+ne),J=K+Y*_,oe=m,ve=0,me=0,ie=W;ie<B;ie+=u){for(var le=N+ie*n.strides[1],ye=U;ye<j;ye+=l){for(var Pe=le+ye*n.strides[2],Fe=pe;Fe<te;Fe+=c){var Ae=y[Pe+Fe*n.strides[3]+P];if(o==="max"&&Ae>oe?oe=Ae:o==="avg"&&(ve+=Ae,me++),isNaN(oe))break}if(isNaN(oe))break}if(isNaN(oe))break}w[J+P]=o==="avg"?ve/me:oe}}}return x.toTensor()},t.prototype.avgPool3d=function(n,r){return X(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){X([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,v=o.effectiveFilterDepth,p=o.effectiveFilterHeight,g=o.effectiveFilterWidth,m=v-1-o.padInfo.front,y=g-1-o.padInfo.left,x=p-1-o.padInfo.top,w=be(r.shape,"float32"),b=1/(u*l*c),C=this.bufferSync(n),S=0;S<o.batchSize;++S)for(var _=0;_<o.inChannels;++_)for(var k=0;k<o.inDepth;++k)for(var R=0;R<o.inHeight;++R)for(var N=0;N<o.inWidth;++N){for(var P=k-m,L=R-x,M=N-y,W=0,B=0;B<v;B+=d){var z=(P+B)/i;if(!(z<0||z>=o.outDepth||Math.floor(z)!==z))for(var A=0;A<p;A+=f){var F=(L+A)/a;if(!(F<0||F>=o.outHeight||Math.floor(F)!==F))for(var U=0;U<g;U+=h){var j=(M+U)/s;j<0||j>=o.outWidth||Math.floor(j)!==j||(W+=C.get(S,z,F,j,_))}}}w.set(W*b,S,k,R,N,_)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return X(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=be(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,p=r.padInfo.top,g=r.padInfo.left,m=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var x=0;x<r.inChannels;++x)for(var w=0;w<r.outDepth;++w){for(var b=w*i-v,C=b;C<0;)C+=u;for(var S=Math.min(r.inDepth,d+b),_=0;_<r.outHeight;++_){for(var k=_*a-p,R=k;R<0;)R+=l;for(var N=Math.min(r.inHeight,f+k),P=0;P<r.outWidth;++P){for(var L=P*s-g,M=L;M<0;)M+=c;for(var W=Math.min(r.inWidth,h+L),B=Number.NEGATIVE_INFINITY,z=-1,A=C;A<S;A+=u)for(var F=A-b,U=R;U<N;U+=l)for(var j=U-k,K=M;K<W;K+=c){var Y=K-L,ne=m.get(y,A,U,K,x);ne>=B&&(B=ne,z=F*f*h+j*f+Y)}o.set(z,y,w,_,P,x)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,i){X([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,v=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=h-1-i.padInfo.front,m=p-1-i.padInfo.left,y=v-1-i.padInfo.top,x=be(r.shape,"float32"),w=this.bufferSync(a),b=this.bufferSync(n),C=0;C<i.batchSize;++C)for(var S=0;S<i.inChannels;++S)for(var _=0;_<i.inDepth;++_)for(var k=0;k<i.inHeight;++k)for(var R=0;R<i.inWidth;++R){for(var N=_-g,P=k-y,L=R-m,M=0,W=0;W<h;W+=c){var B=(N+W)/s;if(!(B<0||B>=i.outDepth||Math.floor(B)!==B))for(var z=0;z<v;z+=d){var A=(P+z)/u;if(!(A<0||A>=i.outHeight||Math.floor(A)!==A))for(var F=0;F<p;F+=f){var U=(L+F)/l;if(!(U<0||U>=i.outWidth||Math.floor(U)!==U)){var j=h*v*p-1-w.get(C,B,A,U,S)===W*v*p+z*p+F?1:0;j!==0&&(M+=b.get(C,B,A,U,S)*j)}}}}x.set(M,C,_,k,R,S)}return x.toTensor()},t.prototype.cast=function(n,r){return JC(n,r,this)},t.prototype.reshape=function(n,r){return zp(n,r)},t.prototype.avgPool=function(n,r){return X(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,i){X(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(ce([s,r,o,c])),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=0,g=h[0]/v[0],m=h[1]/v[1],y=0;y<s;y++)for(var x=0;x<r;x++)for(var w=g*x,b=Math.floor(w),C=w-b,S=Math.min(u-1,Math.ceil(w)),_=y*n.strides[0]+b*n.strides[1],k=y*n.strides[0]+S*n.strides[1],R=0;R<o;R++)for(var N=m*R,P=Math.floor(N),L=N-P,M=Math.min(l-1,Math.ceil(N)),W=_+P*n.strides[2],B=k+P*n.strides[2],z=_+M*n.strides[2],A=k+M*n.strides[2],F=0;F<c;F++){var U=d[W+F],j=d[B+F],K=U+(d[z+F]-U)*L,Y=K+(j+(d[A+F]-j)*L-K)*C;f[p++]=Y}return Tt(f,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){X([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),v=[o&&d>1?s-1:s,o&&f>1?u-1:u],p=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=v[0]/p[0],m=v[1]/p[1],y=this.readSync(n.dataId),x=0,w=0;w<a;w++)for(var b=w*r.strides[0],C=0;C<d;C++)for(var S=C*g,_=Math.floor(S),k=Math.min(Math.ceil(S),s-1),R=b+_*r.strides[1],N=b+k*r.strides[1],P=S-_,L=1-P,M=0;M<f;M++)for(var W=M*m,B=Math.floor(W),z=Math.min(Math.ceil(W),u-1),A=W-B,F=1-A,U=R+B*r.strides[2],j=R+z*r.strides[2],K=N+B*r.strides[2],Y=N+z*r.strides[2],ne=L*F,pe=L*A,te=P*F,J=P*A,oe=0;oe<l;oe++){var ve=y[x++];h[U+oe]+=ve*ne,h[j+oe]+=ve*pe,h[K+oe]+=ve*te,h[Y+oe]+=ve*J}return Zt(h,[a,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,i){X(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=h[0]/v[0],g=h[1]/v[1],m=0,y=0;y<s;y++)for(var x=y*n.strides[0],w=0;w<r;w++)for(var b=p*w,C=x+Math.min(u-1,i?Math.round(b):Math.floor(b))*n.strides[1],S=0;S<o;S++)for(var _=g*S,k=C+Math.min(l-1,i?Math.round(_):Math.floor(_))*n.strides[2],R=0;R<c;R++){var N=d[k+R];f[m++]=N}return Tt(f,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){X([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),v=this.readSync(n.dataId),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],m=p[0]/g[0],y=p[1]/g[1],x=1/m,w=1/y,b=2*Math.ceil(x)+2,C=2*Math.ceil(w)+2,S=0;S<a;S++)for(var _=S*r.strides[0],k=0;k<s;k++)for(var R=_+k*r.strides[1],N=Math.floor(k*x),P=Math.floor(N-b/2),L=0;L<u;L++)for(var M=R+L*r.strides[2],W=Math.floor(L*w),B=Math.floor(W-C/2),z=0;z<l;z++){for(var A=0,F=0;F<b;F++){var U=F+P;if(!(U<0||U>=d)){var j=_+U*n.strides[1],K=U*m;if(k===Math.min(s-1,o?Math.round(K):Math.floor(K)))for(var Y=0;Y<C;Y++){var ne=Y+B;if(!(ne<0||ne>=f)){var pe=j+ne*n.strides[2],te=ne*y;L===Math.min(u-1,o?Math.round(te):Math.floor(te))&&(A+=v[pe+z])}}}}h[M+z]=A}return Zt(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){X([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),v=f.length,p=d.length,g=c.length,m=l.length,y=0,x=0,w=0,b=0,C=0;C<u.length;++C)h[C]=f[y++]+(u[C]-l[x++])*d[w++]/Math.sqrt(c[b++]+i),y>=v&&(y=0),x>=m&&(x=0),w>=p&&(w=0),b>=g&&(b=0);return Zt(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){X(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,d=new Float32Array(c);function f(g){for(var m=g%s,y=g-m+Math.max(0,m-r),x=g-m+Math.min(m+r,u),w=0;y<=x;y++){var b=l[y];w+=b*b}return w}for(var h=0;h<c;h++){var v=f(h),p=l[h]*Math.pow(o+i*v,-a);d[h]=p}return Zt(d,n.shape)},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){X(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),v=n.size,p=0;p<v;p++){for(var g=p%l,m=p-g+Math.max(0,g-i),y=p-g+Math.min(l,g+i+1),x=0,w=m;w<y;w++)x+=Math.pow(d[w],2);for(x=s*x+a,w=m;w<y;w++){var b=-2*s*u*d[w]*f[p]/x;p===w&&(b+=Math.pow(x,-u)),b*=c[p],h[w]+=b}}return Zt(h,n.shape)},t.prototype.multinomial=function(n,r,o,i){X(n,"multinomial");for(var a=r?n:ro(n),s=a.shape[0],u=a.shape[1],l=Ke([s,o],"int32"),c=this.readSync(l.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,v=new Float32Array(u-1);v[0]=d[h];for(var p=1;p<v.length;++p)v[p]=v[p-1]+d[h+p];for(var g=Fd(i.toString()),m=f*o,y=0;y<o;++y){var x=g();c[m+y]=v.length;for(var w=0;w<v.length;w++)if(x<v[w]){c[m+y]=w;break}}}return l},t.prototype.oneHot=function(n,r,o,i){X(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return $o(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return X(n,"nonMaxSuppression"),km(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=be(n.shape,"float32"),s=be(n.shape,"float32"),u=Fn(n).as2D(o,i),l=Er(n).as2D(o,i),c=0;c<o;c++)for(var d=u.slice([c,0],[1,i]),f=l.slice([c,0],[1,i]),h=Rt(d,f),v=this.readSync(this.fftImpl(h,r).dataId),p=0;p<i;p++){var g=D0(v,p);a.values[c*i+p]=g.real,s.values[c*i+p]=g.imag}return Rt(a.toTensor(),s.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Rt(Fn(a).div(ee(i)),Er(a).div(ee(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Rt(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(m){for(var y=Math.ceil(m.length/4),x=new Float32Array(y),w=new Float32Array(y),b=0;b<m.length;b+=4)x[Math.floor(b/4)]=m[b],w[Math.floor(b/4)]=m[b+1];return{real:x,imag:w}}(i),u=Rt(s.real,s.imag).as1D(),l=function(m){for(var y=Math.floor(m.length/4),x=new Float32Array(y),w=new Float32Array(y),b=2;b<m.length;b+=4)x[Math.floor(b/4)]=m[b],w[Math.floor(b/4)]=m[b+1];return{real:x,imag:w}}(i),c=Rt(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var d=function(m,y){for(var x=new Float32Array(m/2),w=new Float32Array(m/2),b=0;b<Math.ceil(m/2);b++){var C=(y?2:-2)*Math.PI*(b/m);x[b]=Math.cos(C),w[b]=Math.sin(C)}return{real:x,imag:w}}(r,o),f=Rt(d.real,d.imag).mul(c),h=u.add(f),v=u.sub(f),p=Fn(h).concat(Fn(v)),g=Er(h).concat(Er(v));return Rt(p,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=vM(a*l,r,o),d=D0(n,l);s+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}o&&(s/=r,u/=r),pM(i,s,u,a)}return i},t.prototype.depthToSpace=function(n,r,o){T(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),T(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*l*c*d),v=0,p=0;p<i;++p)for(var g=0;g<l;++g)for(var m=Math.floor(g/r),y=g%r,x=0;x<c;++x)for(var w=Math.floor(x/r),b=(y*r+x%r)*d,C=0;C<d;++C){var S=C+b+u*(w+s*(m+a*p));h[v++]=f[S]}return Zt(h,[i,l,c,d])},t.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Ie(n.shape,r.shape),s=be(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Po(n.shape,a),d=Po(r.shape,a),f=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],l[h%l.length]);else{var v=this.bufferSync(n),p=this.bufferSync(r),g=function(m){var y=s.indexToLoc(m),x=y.slice(-n.rank);c.forEach(function(S){return x[S]=0});var w=v.locToIndex(x),b=y.slice(-r.rank);d.forEach(function(S){return b[S]=0});var C=p.locToIndex(b);f[m]=i(u[w],l[C])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Ie(n.shape,r.shape),a=be(i,"float32"),s=be(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Po(n.shape,i),d=Po(r.shape,i),f=a.values,h=s.values;if(c.length+d.length===0)for(var v=0;v<f.length;v++){var p=v%u.length,g=v%l.length,m=o(u[2*p],u[2*p+1],l[2*g],l[2*g+1]);f[v]=m.real,h[v]=m.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(b){var C=a.indexToLoc(b),S=C.slice(-n.rank);c.forEach(function(P){return S[P]=0});var _=y.locToIndex(S),k=C.slice(-r.rank);d.forEach(function(P){return k[P]=0});var R=x.locToIndex(k),N=o(u[2*_],u[2*_+1],l[2*R],l[2*R+1]);f[b]=N.real,h[b]=N.imag};for(v=0;v<f.length;v++)w(v)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return tE(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],d=u[2],f=u[3],h=r.shape[0],v=i[0],p=i[1],g=be([h,v,p,f],"float32"),m=this.readSync(r.dataId),y=this.readSync(o.dataId),x=this.readSync(n.dataId),w=n.strides,b=g.strides,C=0;C<h;C++){var S=4*C,_=m[S],k=m[S+1],R=m[S+2],N=m[S+3],P=y[C];if(!(P>=l))for(var L=v>1?(R-_)*(c-1)/(v-1):0,M=p>1?(N-k)*(d-1)/(p-1):0,W=0;W<v;W++){var B=v>1?_*(c-1)+W*L:.5*(_+R)*(c-1);if(B<0||B>c-1)for(var z=0;z<p;z++)for(var A=0;A<f;A++){var F=A+z*b[2]+W*b[1]+C*b[0];g.values[F]=s}else if(a==="bilinear"){var U=Math.floor(B),j=Math.ceil(B),K=B-U;for(z=0;z<p;z++)if((ie=p>1?k*(d-1)+z*M:.5*(k+N)*(d-1))<0||ie>d-1)for(A=0;A<f;A++)F=A+z*b[2]+W*b[1]+C*b[0],g.values[F]=s;else{var Y=Math.floor(ie),ne=Math.ceil(ie),pe=ie-Y;for(A=0;A<f;A++){var te=x[F=A+Y*w[2]+U*w[1]+P*w[0]],J=x[F=A+ne*w[2]+U*w[1]+P*w[0]],oe=x[F=A+Y*w[2]+j*w[1]+P*w[0]],ve=te+(J-te)*pe,me=oe+(x[F=A+ne*w[2]+j*w[1]+P*w[0]]-oe)*pe;F=A+z*b[2]+W*b[1]+C*b[0],g.values[F]=ve+(me-ve)*K}}}else for(z=0;z<p;++z){var ie;if((ie=p>1?k*(d-1)+z*M:.5*(k+N)*(d-1))<0||ie>d-1)for(A=0;A<f;A++)F=A+z*b[2]+W*b[1]+C*b[0],g.values[F]=s;else{var le=Math.round(ie),ye=Math.round(B);for(A=0;A<f;A++){var Pe=A+le*w[2]+ye*w[1]+P*w[0],Fe=A+z*b[2]+W*b[1]+C*b[0];g.values[Fe]=x[Pe]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,o,i){var a=zc(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,l,u,s,c,i,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=HC(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return Tt([],s,n.dtype);for(var d=new hu([u,l],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),v=0;v<u;v++){for(var p=[],g=0,m=0;m<i;m++){var y=f[v*i+m];g+=y*c[m],p.push(y)}if(g<0||g>=n.size/l)throw new Error("Invalid indices: "+p+" does not index into "+n.shape);for(var x=0;x<l;x++)d.values[v*l+x]=h[g*l+x]}return d.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var i=zc(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=ee(0);return this.scatter(n,r,o,c,u,s,a,l,d,!0)},t.prototype.fill=function(n,r,o){var i=Pc(o=o||Nu(r),ce(n));return i.fill(r),O.makeTensor(i,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Pc(n.dtype,ce(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return ZC(n,r,o)},t.prototype.scatter=function(n,r,o,i,a,s,u,l,c,d){var f=[i/a,a],h=this.readSync(n.dataId),v=this.readSync(r.dataId);if(i===0)return Tt([],o,r.dtype);var p=new hu(f,r.dtype);p.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var m=[],y=0,x=0;x<u;x++){var w=h[g*u+x];m.push(w),y+=w*l[x]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+m+" does not index into "+o);for(var b=0;b<a;b++)d?p.values[y*a+b]+=v[g*a+b]:p.values[y*a+b]=r.rank===0?v[0]:v[g*a+b]}return p.toTensor().reshape(o)},t}(YC);O.registerBackend("cpu",function(){return new FL},1);for(var nh=0,t1=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n;X(i,"NonMaxSuppressionWithScore");var h=Rm(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;X(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:mu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;X([o,i],mu);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(f,h,v,p,g,m){var y=Ie(f,h),x=y.length,w=Ir(y),b=fu(g,ce(y)),C=f.length,S=h.length,_=Ir(f),k=Ir(h),R=Po(f,y),N=Po(h,y);if(R.length+N.length===0)for(var P=0;P<b.length;++P)b[P]=m(v[P%v.length],p[P%p.length]);else{var L=function(M){var W=HD(M,x,w),B=W.slice(-C);R.forEach(function(U){return B[U]=0});var z=S0(B,C,_),A=W.slice(-S);N.forEach(function(U){return A[U]=0});var F=S0(A,S,k);b[M]=m(v[z],p[F])};for(P=0;P<b.length;++P)L(P)}return[b,y]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var v=f-h;return v*v}),c=l[0],d=l[1];return{dataId:a.write(c,d,o.dtype),shape:d,dtype:o.dtype}}}];nh<t1.length;nh++)SC(t1[nh]);var Xi,OL=function(e){this.variableNames=["A"];var t=Wt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},LL=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Wt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var rh=0,n1=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],d=[c,l],f=[c,l,i];(s||a)&&(Xi==null&&(Xi=document.createElement("canvas").getContext("2d")),Xi.canvas.width=l,Xi.canvas.height=c,Xi.drawImage(o,0,0,l,c),o=Xi.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=wn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var v=G().getBool("WEBGL_PACK")?new LL(f):new OL(f),p=n.runWebGLProgram(v,[h],"int32");return n.disposeData(h.dataId),p}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Mc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n,h=Rm(f.readSync(i.dataId),f.readSync(a.dataId),u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new Se(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:mu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $r("return (a - b) * (a - b);",o.shape,i.shape):new nt("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];rh<n1.length;rh++)SC(n1[rh]);for(var oh=0,r1=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:mu,gradFunc:function(e,t){var n=t[0],r=t[1],o=ee(2);return{a:function(){return $t(e,$t(o,yt(n,r)))},b:function(){return $t(e,$t(o,yt(r,n)))}}}}];oh<r1.length;oh++)MD(r1[oh]);var BL=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();G().get("IS_BROWSER")&&G().setPlatform("browser",new BL);var ih,WL=function(){return require("node-fetch")},zL=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return G().global.fetch!=null?G().global.fetch(t,n):(ih==null&&(ih=WL()),ih(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();G().get("IS_NODE")&&G().setPlatform("node",new zL);var Vp={float32:4,int32:4,uint16:2,uint8:1,bool:1},Kc=4;function KE(e,t){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,d=ce(c),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var v=Vp[h.dtype],p=e.slice(r,r+d*v),g=h.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(l==="float32")f=Float32Array.from(g,function(C){return C*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(g,function(C){return Math.round(C*h.scale+h.min)})}r+=d*v}else if(l==="string"){var m=ce(s.shape);f=[];for(var y=0;y<m;y++){var x=new Uint32Array(e.slice(r,r+Kc))[0];r+=Kc;var w=new Uint8Array(e.slice(r,r+x));f.push(w),r+=x}}else{var b=Vp[l];if(p=e.slice(r,r+d*b),l==="float32")f=new Float32Array(p);else if(l==="int32")f=new Int32Array(p);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(p)}r+=d*b}n[u]=Tt(f,c,l)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function $L(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var jp=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function o1(e){return jp?Buffer.byteLength(e):new Blob([e]).size}function Gm(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function i1(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Wu(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:o1(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:o1(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var bn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(t,r);a!==null&&o.push(a)}),o},e}(),Ra="://",Uo=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){T(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Ra)&&(t=t.slice(0,t.indexOf(Ra))),T(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();T(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Kl(e){if(e.indexOf(Ra)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Uo.getSchemes().join(","));return{scheme:e.split(Ra)[0],path:e.split(Ra)[1]}}function a1(e,t,n){return n===void 0&&(n=!1),se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d;return ue(this,function(f){switch(f.label){case 0:return T(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),T((r=bn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),T(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],T((i=bn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),T(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=i[0],s=Kl(e).scheme,u=Kl(e).path,l=s===Kl(e).scheme,[4,o.load()];case 1:return c=f.sent(),n&&l?[4,Uo.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return d=f.sent(),!n||l?[3,6]:[4,Uo.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var gi="models_store",Ao="model_info_store";function qE(){if(!G().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Hp(e){var t=e.result;t.createObjectStore(gi,{keyPath:"modelPath"}),t.createObjectStore(Ao,{keyPath:"modelPath"})}var Ia=function(){function e(t){if(this.indexedDB=qE(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){return ue(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return se(this,void 0,void 0,function(){return ue(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Hp(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(gi,"readonly"),l=u.objectStore(gi).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(p){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,d=Wu(n),f=s.transaction(Ao,"readwrite"),h=f.objectStore(Ao),v=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});v.onsuccess=function(){var p=(c=s.transaction(gi,"readwrite")).objectStore(gi).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});p.onsuccess=function(){return o({modelArtifactsInfo:d})},p.onerror=function(g){var m=(h=f.objectStore(Ao)).delete(r.modelPath);m.onsuccess=function(){return s.close(),i(p.error)},m.onerror=function(y){return s.close(),i(p.error)}}},v.onerror=function(p){return s.close(),i(v.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),s1=function(e){return G().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ia.URL_SCHEME)?(t=e.slice(Ia.URL_SCHEME.length),new Ia(t)):null;var t};bn.registerSaveRouter(s1),bn.registerLoadRouter(s1);var UL=function(){function e(){this.indexedDB=qE()}return e.prototype.listModels=function(){return se(this,void 0,void 0,function(){var t=this;return ue(this,function(n){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Hp(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Ao,"readonly"),u=s.objectStore(Ao).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(t){return se(this,void 0,void 0,function(){var n=this;return ue(this,function(r){var o;return t=(o=t).startsWith(Ia.URL_SCHEME)?o.slice(Ia.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Hp(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Ao,"readwrite"),d=c.objectStore(Ao),f=d.get(t);f.onsuccess=function(){if(f.result==null)return l.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),v=function(){var p=(u=l.transaction(gi,"readwrite")).objectStore(gi).delete(t);p.onsuccess=function(){return i(f.result.modelArtifactsInfo)},p.onerror=function(g){return a(f.error)}};h.onsuccess=v,h.onerror=function(p){return v(),l.close(),a(f.error)}},f.onerror=function(h){return l.close(),a(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(G().getBool("IS_BROWSER"))try{Uo.registerManager(Ia.URL_SCHEME,new UL)}catch{}var jr="/",ta="tensorflowjs_models",XE="info",VL="model_topology",jL="weight_specs",HL="weight_data",GL="model_metadata";function YE(e){return{info:[ta,e,XE].join(jr),topology:[ta,e,VL].join(jr),weightSpecs:[ta,e,jL].join(jr),weightData:[ta,e,HL].join(jr),modelMetadata:[ta,e,GL].join(jr)}}function KL(e){var t=e.split(jr);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(jr)}var Ta=function(){function e(t){if(!G().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=YE(this.modelPath)}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){var n,r,o;return ue(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Wu(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(jp)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return se(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return ue(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(jp){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),u1=function(e){return G().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ta.URL_SCHEME)?(t=e.slice(Ta.URL_SCHEME.length),new Ta(t)):null;var t};bn.registerSaveRouter(u1),bn.registerLoadRouter(u1);var qL=function(){function e(){T(G().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),T(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return se(this,void 0,void 0,function(){var t,n,r,o,i,a;return ue(this,function(s){for(t={},n=ta+jr,r=jr+XE,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=KL(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return se(this,void 0,void 0,function(){var n,r;return ue(this,function(o){var i;if(t=(i=t).startsWith(Ta.URL_SCHEME)?i.slice(Ta.URL_SCHEME.length):i,n=YE(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(G().getBool("IS_BROWSER"))try{Uo.registerManager(Ta.URL_SCHEME,new qL)}catch{}var XL="model",YL=".json",QL=".weights.bin";function l1(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var ah=function(){function e(t){if(!G().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=XL),this.modelTopologyFileName=t+YL,this.weightDataFileName=t+QL}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s;return ue(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,l1(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,l1(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Wu(t)}]}})})},e.URL_SCHEME="downloads://",e}(),JL=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return se(this,void 0,void 0,function(){var t,n,r=this;return ue(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var d=l.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void a(g)}var h=[],v=[],p=[];d.forEach(function(g){g.paths.forEach(function(m){v.push(m),p.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(m){var y=new FileReader;y.onload=function(x){var w=x.target.result,b=v.indexOf(m);p[b]=w,p.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:h,weightData:Gm(p),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(x){return a("Failed to weights data from file of path '"+m+"'.")},y.readAsArrayBuffer(f[m])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(u){return i1(u.name)}),i={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(u){var l=i1(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function c1(e,t,n,r){(function(i){T(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,a){T(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),T(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),T(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=n+ ++o/e.length*(r-n);return t(s),a}),i}))}function QE(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return ue(this,function(d){switch(d.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?G().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),o=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,c1(r,t.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,c1(s,t.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function d1(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),se(t,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v;return ue(this,function(p){switch(p.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,m){var y=0;g.weights.forEach(function(x){var w="quantization"in x?x.quantization.dtype:x.dtype,b=Vp[w]*ce(x.shape),C=function(){i[m]=!0,a[m]==null&&(a[m]=[]),a[m].push({manifestEntry:x,groupOffset:y,sizeBytes:b})};o!=null?o.forEach(function(S,_){S===x.name&&(C(),s[_]=!0)}):C(),u.push(x.name),y+=b})}),!s.every(function(g){return g}))throw l=o.filter(function(g,m){return!s[m]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(g,m,y){return m&&g.push(y),g},[]),d=[],c.forEach(function(g){n[g].paths.forEach(function(m){var y=r+(r.endsWith("/")?"":"/")+m;d.push(y)})}),[4,e(d)];case 1:return f=p.sent(),h={},v=0,c.forEach(function(g){for(var m=n[g].paths.length,y=0,x=0;x<m;x++)y+=f[v+x].byteLength;for(var w=new ArrayBuffer(y),b=new Uint8Array(w),C=0,S=0;S<m;S++){var _=new Uint8Array(f[v+S]);b.set(_,C),C+=_.byteLength}a[g].forEach(function(k){var R=KE(w.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var N in R)h[N]=R[N]}),v+=m}),[2,h]}})})}}bn.registerSaveRouter(function(e){return G().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ah.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new ah(t)}(e.slice(ah.URL_SCHEME.length)):null});var JE=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(T(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=G().platform.fetch,T(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&T(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){var n,r,o,i;return ue(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Wu(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return se(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c,d,f;return ue(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f;return ue(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(v){var p=v.lastIndexOf("/"),g=v.lastIndexOf("?"),m=v.substring(0,p),y=g>p?v.substring(g):"";return[m+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return d=[],t.forEach(function(v){v.paths.forEach(function(p){d.push(a+p+i)})}),[4,QE(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,Gm(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Gp(e){return e.match(JE.URL_SCHEME_REGEX)!=null}var f1=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Gp(n)}):Gp(e))?Kp(e,{onProgress:t}):null};function Kp(e,t){return new JE(e,t)}bn.registerSaveRouter(f1),bn.registerLoadRouter(f1);var sh=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return se(this,void 0,void 0,function(){return ue(this,function(t){return[2,this.modelArtifacts]})})},e}(),ZL=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){return ue(this,function(n){return[2,this.saveHandler(t)]})})},e}(),ZE=Object.freeze({browserFiles:function(e){return new JL(e)},browserHTTPRequest:function(e,t){return Kp(e,t)},concatenateArrayBuffers:Gm,decodeWeights:KE,encodeWeights:function(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ue(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),i=function(l){var c=o[l],d=Array.isArray(e)?e[l].tensor:e[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(v){return se(s,void 0,void 0,function(){var p,g,m,y,x,w,b;return ue(this,function(C){switch(C.label){case 0:return[4,d.bytes()];case 1:for(p=C.sent(),g=p.reduce(function(S,_){return S+_.length},0)+Kc*p.length,m=new Uint8Array(g),y=0,x=0;x<p.length;x++)w=p[x],b=new Uint8Array(new Uint32Array([w.length]).buffer),m.set(b,y),y+=Kc,m.set(w,y),y+=w.length;return v(m),[2]}})})});r.push(h)}else r.push(d.data());t!=null&&(f.group=t),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:$L(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new sh(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new sh({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new sh({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return bn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Wu,getSaveHandlers:function(e){return bn.getSaveHandlers(e)},http:Kp,isHTTPScheme:Gp,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),se(this,void 0,void 0,function(){return ue(this,function(o){return[2,d1(function(i){return QE(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return bn.registerLoadRouter(e)},registerSaveRouter:function(e){return bn.registerSaveRouter(e)},weightsLoaderFactory:d1,withSaveHandler:function(e){return new ZL(e)},copyModel:function(e,t){return se(this,void 0,void 0,function(){return ue(this,function(n){return[2,a1(e,t,!1)]})})},listModels:function(){return se(this,void 0,void 0,function(){var e,t,n,r,o,i,a;return ue(this,function(s){switch(s.label){case 0:e=Uo.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,Uo.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+Ra+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return se(this,void 0,void 0,function(){return ue(this,function(n){return[2,a1(e,t,!0)]})})},removeModel:function(e){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){return t=Kl(e),[2,Uo.getManager(t.scheme).removeModel(t.path)]})})}}),Yi;D({confusionMatrix_:function(e,t,n){var r=I(e,"labels","confusionMatrix"),o=I(t,"predictions","confusionMatrix");T(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),T(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),T(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),T(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),T(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Bp(r.asType("int32"),n),a=Bp(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var eB=D({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(EC("FromPixels",O.backendName)!=null)return O.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],d=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,d).data:r||n?s=e.data:(i||o)&&(Yi==null&&(Yi=document.createElement("canvas").getContext("2d")),Yi.canvas.width=c,Yi.canvas.height=d,Yi.drawImage(e,0,0,c,d),s=Yi.getImageData(0,0,c,d).data),t===4)u=new Int32Array(s);else{var f=c*d;u=new Int32Array(f*t);for(var h=0;h<f;h++)for(var v=0;v<t;++v)u[h*t+v]=s[4*h+v]}return bm(u,[d,c,t],"int32")}}),Km=Object.freeze({toPixels:function(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f,h,v,p,g,m,y,x,w,b,C,S,_;return ue(this,function(k){switch(k.label){case 0:if(n=I(e,"img","toPixels"),e instanceof Qe||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=k.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=k.sent(),d=c[0],f=c[1],h=d[0],v=f[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||v>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+v+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||v>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+v+"].")}for(p=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),m=0;m<o*i;++m)y=void 0,x=void 0,w=void 0,b=void 0,a===1?(y=s[m]*p,x=s[m]*p,w=s[m]*p,b=255):a===3?(y=s[3*m]*p,x=s[3*m+1]*p,w=s[3*m+2]*p,b=255):a===4&&(y=s[4*m]*p,x=s[4*m+1]*p,w=s[4*m+2]*p,b=s[4*m+3]*p),g[(C=4*m)+0]=Math.round(y),g[C+1]=Math.round(x),g[C+2]=Math.round(w),g[C+3]=Math.round(b);return t!=null&&(t.width=i,t.height=o,S=t.getContext("2d"),_=new ImageData(g,i,o),S.putImageData(_,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:eB}),tB=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),nB=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function $i(e){T(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),T(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),T(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),nB.register(e)}var Ui=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return ar(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return an(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return fM(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&an(this.iterations_)},t.prototype.saveIterations=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ee(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(tB);Object.defineProperty(Ui,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var rB=function(e){function t(n,r,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=O.backend.epsilon()),i}return ar(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=O.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:re(function(){return Ne(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:re(function(){return Ne(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;re(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(an(this.accumulatedGrads.map(function(n){return n.variable})),an(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){var n;return ue(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(Ui);$i(rB);var oB=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return ar(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=O.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:re(function(){return Tr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;re(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(O.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&an(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(Ui);$i(oB);var iB=function(e){function t(n,r,o,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],re(function(){a.accBeta1=ee(r).variable(),a.accBeta2=ee(o).variable()}),i==null&&(a.epsilon=O.backend.epsilon()),a}return ar(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);re(function(){var i=yt(1,r.accBeta1),a=yt(1,r.accBeta2);o.forEach(function(s,u){var l=O.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:re(function(){return Ne(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:re(function(){return Ne(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),p=h.div(i),g=v.div(a);d.assign(h),f.assign(v);var m=p.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&an(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&an(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){var n;return ue(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){var r,o=this;return ue(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),re(function(){o.accBeta1.assign(Hc(o.beta1,o.iterations_+1)),o.accBeta2.assign(Hc(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(Ui);$i(iB);var aB=function(e){function t(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],re(function(){s.iteration=ee(0).variable(),s.accBeta1=ee(r).variable()}),i==null&&(s.epsilon=O.backend.epsilon()),s}return ar(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);re(function(){var i=yt(1,r.accBeta1),a=Jn(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=O.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Ne(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Ne(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2),p=c.abs(),g=v.maximum(p);d.assign(h),f.assign(g);var m=a.div(i).mul(h.div(g.add(r.epsilon))).add(l);l.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&an(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&an(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(Ui);$i(aB);var eS=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return ar(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=O.registeredVariables[o];re(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=k3(ee(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(Ui);$i(eS);var sB=function(e){function t(n,r,o){o===void 0&&(o=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ee(i.momentum),i}return ar(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=O.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:re(function(){return Ne(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&re(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&an(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(eS);$i(sB);var uB=function(e){function t(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=O.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return ar(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=O.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:re(function(){return Ne(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:re(function(){return Ne(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:re(function(){return Ne(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;re(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(h);var v=a.sub(h);a.assign(v)}else{var p=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(p.add(r.epsilon).sqrt())),u.assign(p),l.assign(h),v=a.sub(h),a.assign(v)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&an(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&an(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&an(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){var n;return ue(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(Ui);$i(uB);Qe.prototype.squaredDifference=function(e){return vE(this,e)},H=ML;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qp=function(e,t){return qp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},qp(e,t)};function we(e,t){qp(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Bt=function(){return Bt=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Bt.apply(this,arguments)};function fe(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(e,[])).next())})}function he(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Us(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Si=function(){function e(t,n){if(!_i(t)||!_i(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Vd(e,t){return e instanceof Qe&&e.shape.length===t}function lB(e){return Vd(e,2)}function jd(e){return Vd(e,3)}function Vo(e){return Vd(e,4)}function cB(e){return e%1!==0}function h1(e){return e%2===0}function tS(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function p1(e){return e&&e.width&&e.height}function dB(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new Si(Math.round(n*o),Math.round(r*o))}function qm(e){return e.reduce(function(t,n){return t.add(n)},new Le(0,0)).div(new Le(e.length,e.length))}function gu(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function _i(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function v1(e){return _i(e)&&0<=e&&e<=1}var Le=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Nr=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(_i),i=[r.x,r.y,r.width,r.height].every(_i);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(_i)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Le(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Le(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Le(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Le(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=p1(t)?t.width:t,r=p1(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,d=s-l,f=Math.min(c,t-u),h=Math.min(d,n-l);return new e({x:u,y:l,width:f,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>t&&(u=-f+t+o,f=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:f,x:l,ex:d,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Hd=function(e){we(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return t}(Nr),nS=function(){function e(t,n,r,o,i){this._imageDims=new Si(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new Nr(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Nr(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Rn=function(e){we(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(nS);function fB(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function hB(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=t.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new Hd(r,o,i,a)}function yu(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var d=u[c],f=e[s],h=e[d];l.push(fB(f,h,r))}o=o.filter(function(v,p){return l[p]<=n})};o.length>0;)a();return i}function zu(e,t){return re(function(){var n=t[0],r=t[1],o=t[2],i=Tr(Us(e.shape.slice(0,3),[1]),n),a=Tr(Us(e.shape.slice(0,3),[1]),r),s=Tr(Us(e.shape.slice(0,3),[1]),o),u=pt([i,a,s],3);return yt(e,u)})}function pB(e,t){return t===void 0&&(t=!1),re(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(h){var v=e.shape.slice();return v[s]=h,Tr(v,0)},l=u(a),c=i-l.shape[s],d=t&&c?u(c):null,f=[d,e,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return pt(f,s)})}function uh(e){return 1/(1+Math.exp(-e))}var Xm=function(e){we(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:o,height:i},a)||this}return t}(Nr),vB=.5,mB=.43,gB=.45,xu=function(){function e(t,n,r){r===void 0&&(r=new Le(0,0));var o=n.width,i=n.height;this._imgDims=new Si(o,i),this._shift=r,this._positions=t.map(function(a){return a.mul(new Le(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Le(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new Le(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new Le(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Rn?t.box.floor():new Nr(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/gB),u=qm(t),l=Math.floor(Math.max(0,u.x-vB*s)),c=Math.floor(Math.max(0,u.y-mB*s));return new Xm(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=hB(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),yB=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],qm([n[3],n[4]])]},t}(xu),xB=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(qm)},t}(xu),m1=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+tS(this.distance)+")":"")},e}(),g1=function(e){we(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(Nr.assertIsValidBox(n,r),!_i(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Nr),Rl=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){we(t,e);function t(n,r,o,i){var a=e.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return t.assertIsValidPredictedBox=function(n,r){if(g1.assertIsValidLabeledBox(n,r),!v1(n.score)||!v1(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(g1);function qc(e){return e.detection instanceof Rn}function wu(e,t){var n={detection:t};return Object.assign({},e,n)}function rS(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function oS(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function iS(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=oS();return Bt({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function aS(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function sS(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var dt;function wB(){if(!dt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return dt}function Xp(e){dt=e}function Ym(){aS()&&Xp(rS()),sS()&&Xp(iS())}function bB(e){if(dt||Ym(),!dt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?dt.Canvas:t,r=e.Image,o=r===void 0?dt.Image:r;dt.Canvas=n,dt.Image=o,dt.createCanvasElement=e.createCanvasElement||function(){return new n},dt.createImageElement=e.createImageElement||function(){return new o},dt.ImageData=e.ImageData||dt.ImageData,dt.Video=e.Video||dt.Video,dt.fetch=e.fetch||dt.fetch,dt.readFile=e.readFile||dt.readFile}var Vt={getEnv:wB,setEnv:Xp,initialize:Ym,createBrowserEnv:rS,createFileSystem:oS,createNodejsEnv:iS,monkeyPatch:bB,isBrowser:aS,isNodejs:sS};Ym();function Qm(e){return!Vt.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function eo(e){var t=Vt.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=Qm(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var No;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(No||(No={}));var uS=function(){function e(t){t===void 0&&(t={});var n=t.anchorPosition,r=t.backgroundColor,o=t.fontColor,i=t.fontSize,a=t.fontStyle,s=t.padding;this.anchorPosition=n||No.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=o||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=a||"Georgia",this.padding=s||4}return e}(),CB=function(){function e(t,n,r){r===void 0&&(r={}),this.text=typeof t=="string"?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new uS(r)}return e.prototype.measureWidth=function(t){var n=this.options.padding;return this.text.map(function(r){return t.measureText(r).width}).reduce(function(r,o){return r<o?o:r},0)+2*n},e.prototype.measureHeight=function(){var t=this.options,n=t.fontSize,r=t.padding;return this.text.length*n+2*r},e.prototype.getUpperLeft=function(t,n){var r=this.options.anchorPosition,o=r===No.BOTTOM_RIGHT||r===No.TOP_RIGHT,i=r===No.BOTTOM_LEFT||r===No.BOTTOM_RIGHT,a=this.measureWidth(t),s=this.measureHeight(),u=o?this.anchor.x-a:this.anchor.x,l=i?this.anchor.y-s:this.anchor.y;if(n){var c=n.width,d=n.height,f=Math.max(Math.min(u,c-a),0),h=Math.max(Math.min(l,d-s),0);return{x:f,y:h}}return{x:u,y:l}},e.prototype.draw=function(t){var n=Qm(t),r=eo(n),o=this.options,i=o.backgroundColor,a=o.fontColor,s=o.fontSize,u=o.fontStyle,l=o.padding;r.font=s+"px "+u;var c=this.measureWidth(r),d=this.measureHeight();r.fillStyle=i;var f=this.getUpperLeft(r,n);r.fillRect(f.x,f.y,c,d),r.fillStyle=a,this.text.forEach(function(h,v){var p=l+f.x,g=l+f.y+(v+1)*s;r.fillText(h,p,g)})},e}(),EB=function(){function e(t){t===void 0&&(t={});var n=t.boxColor,r=t.lineWidth,o=t.label,i=t.drawLabelOptions;this.boxColor=n||"rgba(0, 0, 255, 1)",this.lineWidth=r||2,this.label=o;var a={anchorPosition:No.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new uS(Object.assign({},a,i))}return e}(),SB=function(){function e(t,n){n===void 0&&(n={}),this.box=new Nr(t),this.options=new EB(n)}return e.prototype.draw=function(t){var n=eo(t),r=this.options,o=r.boxColor,i=r.lineWidth,a=this.box,s=a.x,u=a.y,l=a.width,c=a.height;n.strokeStyle=o,n.lineWidth=i,n.strokeRect(s,u,l,c);var d=this.options.label;d&&new CB([d],{x:s-i/2,y:u},this.options.drawLabelOptions).draw(t)},e}();function m5(e,t){var n=Array.isArray(t)?t:[t];n.forEach(function(r){var o=r instanceof Rn?r.score:qc(r)?r.detection.score:void 0,i=r instanceof Rn?r.box:qc(r)?r.detection.box:new Nr(r),a=o?""+tS(o):void 0;new SB(i,{label:a}).draw(e)})}function lS(e){var t=Vt.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function _B(e){return new Promise(function(t,n){if(e instanceof Vt.getEnv().Canvas||lS(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}function Jm(e){var t=Vt.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Si(e.naturalWidth,e.naturalHeight):e instanceof r?new Si(e.videoWidth,e.videoHeight):new Si(e.width,e.height)}function Gd(e){var t=e.width,n=e.height,r=Vt.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function Zm(e,t){var n=Vt.getEnv().ImageData;if(!(e instanceof n)&&!lS(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Jm(e),o=r.width,i=r.height,a=Gd({width:o,height:i});return e instanceof n?eo(a).putImageData(e,0,0):eo(a).drawImage(e,0,0,o,i),a}function kB(e,t){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s;return he(this,function(u){switch(u.label){case 0:return n=Vt.getEnv().createCanvasElement(),r=e.shape.slice(Vo(e)?1:0),o=r[0],i=r[1],a=r[2],s=re(function(){return e.as3D(o,i,a).toInt()}),[4,Km.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function y1(e){var t=Vt.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function RB(e,t,n){n===void 0&&(n=!1);var r=Vt.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=Jm(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=Gd({width:t,height:t}),d=e instanceof i?e:Zm(e),f=Math.abs(u-l)/2,h=n&&u<l?f:0,v=n&&l<u?f:0;return eo(c).drawImage(d,h,v,u,l),c}var Xc=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,i){if(jd(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Vo(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Vt.getEnv().Canvas?o:Zm(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return gu(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return dB({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,re(function(){var o=gu(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof Qe){var u=Vo(s)?s:s.expandDims();return u=pB(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=$m.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof Vt.getEnv().Canvas)return Km.fromPixels(RB(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=_n(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function _t(e){return fe(this,void 0,void 0,function(){var t,n,r;return he(this,function(o){switch(o.label){case 0:if(e instanceof Xc)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(Qm),r.forEach(function(i,a){if(!y1(i)&&!jd(i)&&!Vo(i))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Vo(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return y1(i)&&_B(i)}))];case 1:return o.sent(),[2,new Xc(r,Array.isArray(e))]}})})}function eg(e,t){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return he(this,function(l){switch(l.label){case 0:return n=Vt.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,_t(e)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,kB(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=eo(r),u=t.map(function(c){return c instanceof Rn?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var d=c.x,f=c.y,h=c.width,v=c.height,p=Gd({width:h,height:v});return eo(p).putImageData(s.getImageData(d,f,h,v),0,0),p})]}})})}function tg(e,t){return fe(this,void 0,void 0,function(){return he(this,function(n){if(!jd(e)&&!Vo(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Vo(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,re(function(){var r=e.shape.slice(Vo(e)?1:0),o=r[0],i=r[1],a=r[2],s=t.map(function(l){return l instanceof Rn?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,d=l.y,f=l.width,h=l.height;return OE(e.as3D(o,i,a),[d,c,0],[h,f,a])});return u})]})})}function IB(e,t){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return n=Vt.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function TB(e){return fe(this,void 0,void 0,function(){return he(this,function(t){switch(t.label){case 0:return[4,IB(e)];case 1:return[2,t.sent().json()]}})})}function cS(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function PB(e,t){return fe(this,void 0,void 0,function(){var n,r,o,i;return he(this,function(a){switch(a.label){case 0:return n=cS(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,TB(r)];case 1:return i=a.sent(),[2,ZE.loadWeights(i,o)]}})})}function g5(e,t,n){n===void 0&&(n=!1);var r=n?Jm(t):t,o=r.width,i=r.height;return e.width=o,e.height=i,{width:o,height:i}}var io=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Qa})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Qa)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=Tt(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return fe(this,void 0,void 0,function(){var n;return he(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,PB(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return he(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Vt.getEnv().readFile,r=cS(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(v){return n(v).then(function(p){return p.buffer})}))},s=ZE.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof Qe))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function Cn(e,t,n){return re(function(){var r=Om(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Re(r,t.bias),r})}function lh(e,t,n){return n===void 0&&(n=!1),re(function(){var r=Je(n?Re(Vn(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Cn(e,t.conv0,[2,2])),o=Cn(r,t.conv1,[1,1]),i=Je(Re(r,o)),a=Cn(i,t.conv2,[1,1]);return Je(Re(r,Re(o,a)))})}function Il(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),re(function(){var o=Je(n?Re(Vn(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Cn(e,t.conv0,r?[2,2]:[1,1])),i=Cn(o,t.conv1,[1,1]),a=Je(Re(o,i)),s=Cn(a,t.conv2,[1,1]),u=Je(Re(o,Re(i,s))),l=Cn(u,t.conv3,[1,1]);return Je(Re(o,Re(i,Re(s,l))))})}function nr(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),re(function(){var o=Re(Vn(e,t.filters,[1,1],n),t.bias);return r?Je(o):o})}function ao(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function Kd(e,t){return function(n,r,o,i){var a=Zt(e(n*r*o*o),[o,o,n,r]),s=lt(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function ng(e,t){return function(n,r,o){var i=$o(e(n*r),[n,r]),a=lt(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var dS=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function rg(e,t){return function(n,r,o){var i=Zt(e(9*n),[3,3,n,1]),a=Zt(e(n*r),[1,1,n,r]),s=lt(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new dS(i,a,s)}}function og(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new dS(n,r,o)}}function oi(e,t){return function(n,r,o){var i=e[n];if(!Vd(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function so(e){var t=e;function n(o){var i=t.slice(0,o);return t=t.slice(o),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function fS(e,t){var n=Kd(e,t),r=rg(e,t);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:c,conv1:d,conv2:f}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),d=c.conv0,f=c.conv1,h=c.conv2,v=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:v}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function AB(e){var t=[],n=so(e),r=n.extractWeights,o=n.getRemainingWeights,i=fS(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function hS(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function pS(e,t){var n=oi(e,t),r=hS(n),o=og(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:l,conv1:c,conv2:d}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:l,conv1:c,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function NB(e){var t=[],n=pS(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return ao(e,t),{params:r,paramMappings:t}}var vS=function(e){we(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return re(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=zu(o,i).div(ee(255)),s=Il(a,r.dense0,!0);return s=Il(s,r.dense1),s=Il(s,r.dense2),s=Il(s,r.dense3),s=Bu(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return NB(n)},t.prototype.extractParams=function(n){return AB(n)},t}(io);function Sr(e,t){return re(function(){return Re(zd(e,t.weights),t.bias)})}function DB(e,t,n){var r=[],o=so(e),i=o.extractWeights,a=o.getRemainingWeights,s=ng(i,r),u=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function MB(e){var t=[],n=oi(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return ao(e,t),{params:o,paramMappings:t}}function mS(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var gS=function(e){we(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return re(function(){var i=n instanceof Xc?r.faceFeatureExtractor.forwardInput(n):n;return Sr(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return DB(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=mS(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),MB(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(io),x1=["neutral","happy","sad","angry","fearful","disgusted","surprised"],FB=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);x1.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return x1.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),OB=function(e){we(t,e);function t(n){return n===void 0&&(n=new vS),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return re(function(){return ro(r.runNet(n))})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a,s=this;return he(this,function(u){switch(u.label){case 0:return[4,_t(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(vt(o).map(function(l){return fe(s,void 0,void 0,function(){var c;return he(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return c=d.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new FB(l)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(gS);function yS(e,t){var n={expressions:t};return Object.assign({},e,n)}function xS(e){return qc(e)&&e.landmarks instanceof xu&&e.unshiftedLandmarks instanceof xu&&e.alignedRect instanceof Rn}function qd(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Rn(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function LB(e,t){var n=Kd(e,t),r=rg(e,t);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:d}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function BB(e,t){var n=[],r=so(e),o=r.extractWeights,i=r.getRemainingWeights,a=LB(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=l(32,64,"entry_flow/reduction_block_0"),h=l(64,128,"entry_flow/reduction_block_1"),v={conv_in:d,reduction_block_0:f,reduction_block_1:h},p={};gu(t,0,1).forEach(function(x){p["main_block_"+x]=c(128,"middle_flow/main_block_"+x)});var g=l(128,256,"exit_flow/reduction_block"),m=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:m};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:v,middle_flow:p,exit_flow:y}}}function WB(e,t){var n=oi(e,t),r=hS(n),o=og(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function zB(e,t){var n=[],r=WB(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:c},f={};gu(t,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),v=i("exit_flow/separable_conv"),p={reduction_block:h,separable_conv:v};return ao(e,n),{params:{entry_flow:d,middle_flow:f,exit_flow:p},paramMappings:n}}function wS(e,t,n){return Re(Vn(e,t.filters,n,"same"),t.bias)}function ch(e,t,n){n===void 0&&(n=!0);var r=n?Je(e):e;return r=Cn(r,t.separable_conv0,[1,1]),r=Cn(Je(r),t.separable_conv1,[1,1]),r=bt(r,[3,3],[2,2],"same"),r=Re(r,wS(e,t.expansion_conv,[2,2])),r}function $B(e,t){var n=Cn(Je(e),t.separable_conv0,[1,1]);return n=Cn(Je(n),t.separable_conv1,[1,1]),n=Cn(Je(n),t.separable_conv2,[1,1]),n=Re(n,e),n}var UB=function(e){we(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return re(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=zu(i,a).div(ee(256)),u=Je(wS(s,o.entry_flow.conv_in,[2,2]));return u=ch(u,o.entry_flow.reduction_block_0,!1),u=ch(u,o.entry_flow.reduction_block_1),gu(r._numMainBlocks,0,1).forEach(function(l){u=$B(u,o.middle_flow["main_block_"+l])}),u=ch(u,o.exit_flow.reduction_block),u=Je(Cn(u,o.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return zB(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return BB(n,this._numMainBlocks)},t}(io);function VB(e){var t=[],n=so(e),r=n.extractWeights,o=n.getRemainingWeights,i=ng(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function jB(e){var t=[],n=oi(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return ao(e,t),{params:o,paramMappings:t}}var Yc;(function(e){e.FEMALE="female",e.MALE="male"})(Yc||(Yc={}));var HB=function(e){we(t,e);function t(n){n===void 0&&(n=new UB(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return re(function(){var i=n instanceof Xc?r.faceFeatureExtractor.forwardInput(n):n,a=Bu(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Sr(a,o.fc.age).as1D(),u=Sr(a,o.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return re(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:ro(a)}})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return he(this,function(c){switch(c.label){case 0:return[4,_t(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=vt(o.age),a=vt(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return fe(l,void 0,void 0,function(){var v,p,g,m,y;return he(this,function(x){switch(x.label){case 0:return[4,f.data()];case 1:return v=x.sent()[0],[4,h.data()];case 2:return p=x.sent()[0],g=p>.5,m=g?Yc.MALE:Yc.FEMALE,y=g?p:1-p,f.dispose(),h.dispose(),[2,{age:v,gender:m,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return VB(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=mS(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),jB(i)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(io),bS=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return re(function(){var s=function(f,h){return _n([Tr([68],f),Tr([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var v=i[f],p=v.width,g=v.height;return h(p,g)?Math.abs(p-g)/2:0},l=function(f){return u(f,function(h,v){return h<v})},c=function(f){return u(f,function(h,v){return v<h})},d=n.mul(Tr([a,136],r)).sub(_n(Array.from(Array(a),function(f,h){return s(l(h),c(h))}))).div(_n(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},t.prototype.forwardInput=function(n){var r=this;return re(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a=this;return he(this,function(s){switch(s.label){case 0:return[4,_t(n)];case 1:return r=s.sent(),o=re(function(){return vt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return fe(a,void 0,void 0,function(){var c,d,f,h,v;return he(this,function(p){switch(p.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return c=f.apply(d,[p.sent()]),h=c.filter(function(g,m){return h1(m)}),v=c.filter(function(g,m){return!h1(m)}),[2,new xB(Array(68).fill(0).map(function(g,m){return new Le(h[m],v[m])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(gS),CS=function(e){we(t,e);function t(n){return n===void 0&&(n=new vS),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(bS);function GB(e){var t=[],n=pS(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return ao(e,t),{params:r,paramMappings:t}}function KB(e){var t=[],n=so(e),r=n.extractWeights,o=n.getRemainingWeights,i=fS(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var qB=function(e){we(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return re(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=zu(o,i).div(ee(255)),s=lh(a,r.dense0,!0);return s=lh(s,r.dense1),s=lh(s,r.dense2),s=Bu(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return GB(n)},t.prototype.extractParams=function(n){return KB(n)},t}(io),XB=function(e){we(t,e);function t(n){return n===void 0&&(n=new qB),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(bS);(function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(CS);function YB(e,t){return Re($t(e,t.weights),t.biases)}function ig(e,t,n,r,o){o===void 0&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=Vn(e,a,n,o);return u=Re(u,s),u=YB(u,t.scale),r?Je(u):u}function QB(e,t){return ig(e,t,[1,1],!0)}function ES(e,t){return ig(e,t,[1,1],!1)}function SS(e,t){return ig(e,t,[2,2],!0,"valid")}function JB(e,t){function n(s,u,l){var c=e(s),d=c.length/(u*l*l);if(cB(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return re(function(){return Yo(Zt(c,[u,d,l,l]),[2,3,1,0])})}function r(s,u,l,c){var d=n(s,u,l),f=lt(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}function o(s,u){var l=lt(e(s)),c=lt(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var d=r(s,u,l,c+"/conv"),f=o(u,c+"/scale");return{conv:d,scale:f}}function a(s,u,l,c,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,u,l,c+"/conv1"),h=i(s,u,l,c+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function ZB(e){var t=so(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=JB(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),p=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),b=s(589824,256,3,"conv256_2"),C=s(589824,256,3,"conv256_down_out"),S=re(function(){return Yo($o(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var _={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:v,conv64_3:p,conv128_down:g,conv128_1:m,conv128_2:y,conv256_down:x,conv256_1:w,conv256_2:b,conv256_down_out:C,fc:S};return{params:_,paramMappings:o}}function eW(e,t){var n=oi(e,t);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function tW(e){var t=[],n=eW(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),v=o("conv128_1"),p=o("conv128_2"),g=o("conv256_down"),m=o("conv256_1"),y=o("conv256_2"),x=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!lB(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var b={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:v,conv128_2:p,conv256_down:g,conv256_1:m,conv256_2:y,conv256_down_out:x,fc:w};return ao(e,t),{params:b,paramMappings:t}}function hr(e,t){var n=QB(e,t.conv1);return n=ES(n,t.conv2),n=Re(n,e),n=Je(n),n}function Tl(e,t){var n=SS(e,t.conv1);n=ES(n,t.conv2);var r=Bu(e,2,2,"valid"),o=Ke(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=Us(n.shape);s[1]=1;var u=Ke(s);n=pt([n,u],1);var l=Us(n.shape);l[2]=1;var c=Ke(l);n=pt([n,c],2)}return r=i?pt([r,o],3):r,n=Re(r,n),n=Je(n),n}var nW=function(e){we(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return re(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=zu(o,i).div(ee(256)),s=SS(a,r.conv32_down);s=bt(s,3,2,"valid"),s=hr(s,r.conv32_1),s=hr(s,r.conv32_2),s=hr(s,r.conv32_3),s=Tl(s,r.conv64_down),s=hr(s,r.conv64_1),s=hr(s,r.conv64_2),s=hr(s,r.conv64_3),s=Tl(s,r.conv128_down),s=hr(s,r.conv128_1),s=hr(s,r.conv128_2),s=Tl(s,r.conv256_down),s=hr(s,r.conv256_1),s=hr(s,r.conv256_2),s=Tl(s,r.conv256_down_out);var u=s.mean([1,2]),l=zd(u,r.fc);return l})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a=this;return he(this,function(s){switch(s.label){case 0:return[4,_t(n)];case 1:return r=s.sent(),o=re(function(){return vt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return tW(n)},t.prototype.extractParams=function(n){return ZB(n)},t}(io);function _S(e,t){var n={descriptor:t};return Object.assign({},e,n)}function kS(e,t){var n={age:t};return Object.assign({},e,n)}function RS(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var IS=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function rW(e,t){function n(u,l){var c=Zt(e(9*u),[3,3,u,1]),d=lt(e(u)),f=lt(e(u)),h=lt(e(u)),v=lt(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:v}}function r(u,l,c,d,f){var h=Zt(e(u*l*c*c),[c,c,u,l]),v=lt(e(l));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:v}}function o(u,l,c,d){var f=r(u,l,c,d,!0),h=f.filters,v=f.bias;return{filters:h,batch_norm_offset:v}}function i(u,l,c){var d=n(u,c+"/depthwise_conv"),f=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),v=i(256,512,"mobilenetv1/conv_6"),p=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),m=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),x=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),b=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:p,conv_8:g,conv_9:m,conv_10:y,conv_11:x,conv_12:w,conv_13:b}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),v=o(256,64,1,"prediction_layer/conv_6"),p=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),b=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),S=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),_=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),k=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),R=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),N=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),P={box_encoding_predictor:g,class_predictor:m},L={box_encoding_predictor:y,class_predictor:x},M={box_encoding_predictor:w,class_predictor:b},W={box_encoding_predictor:C,class_predictor:S},B={box_encoding_predictor:_,class_predictor:k},z={box_encoding_predictor:R,class_predictor:N};return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:p,box_predictor_0:P,box_predictor_1:L,box_predictor_2:M,box_predictor_3:W,box_predictor_4:B,box_predictor_5:z}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function oW(e){var t=[],n=so(e),r=n.extractWeights,o=n.getRemainingWeights,i=rW(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=bm(r(5118*4),[1,5118,4]),d={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:t}}function iW(e,t){var n=oi(e,t);function r(l,c,d){var f=n(l+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),h=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(l){var c="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv",v=n(d+"/depthwise_weights",4,f+"/filters"),p=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),m=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:v,batch_norm_scale:p,batch_norm_offset:g,batch_norm_mean:m,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var d=n(l+"/weights",4,c+"/filters"),f=n(l+"/biases",1,c+"/bias");return{filters:d,bias:f}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function aW(e){var t=[],n=iW(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!jd(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return ao(e,t),{params:a,paramMappings:t}}function vr(e,t,n){return re(function(){var r=Vn(e,t.filters,n,"same");return r=Re(r,t.batch_norm_offset),Nm(r,0,6)})}var sW=.0010000000474974513;function uW(e,t,n){return re(function(){var r=Wd(e,t.filters,n,"same");return r=bE(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,sW),Nm(r,0,6)})}function lW(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function cW(e,t){return re(function(){var n=null,r=vr(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(i,a){var s=a+1,u=lW(s);r=uW(r,i.depthwise_conv,u),r=vr(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function dW(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var d=c.score,f=l.length-1;f>=0;--f){var h=fW(e,c.boxIndex,l[f]);if(h!==0&&(c.score*=u(h),c.score<=o))break}d===c.score&&l.push(c.boxIndex)}}),l}function fW(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(c-u)*(d-l);if(f<=0||h<=0)return 0;var v=Math.max(o,u),p=Math.max(i,l),g=Math.min(a,c),m=Math.min(s,d),y=Math.max(g-v,0)*Math.max(m-p,0);return y/(f+h-y)}function hW(e){var t=vt(Yo(e,[1,0])),n=[yt(t[2],t[0]),yt(t[3],t[1])],r=[Re(t[0],Jn(n[0],ee(2))),Re(t[1],Jn(n[1],ee(2)))];return{sizes:n,centers:r}}function pW(e,t){var n=hW(e),r=n.sizes,o=n.centers,i=vt(Yo(t,[1,0])),a=Jn($t(Up(Jn(i[2],ee(5))),r[0]),ee(2)),s=Re($t(Jn(i[0],ee(10)),r[0]),o[0]),u=Jn($t(Up(Jn(i[3],ee(5))),r[1]),ee(2)),l=Re($t(Jn(i[1],ee(10)),r[1]),o[1]);return Yo(_n([yt(s,a),yt(l,u),Re(s,a),Re(l,u)]),[1,0])}function vW(e,t,n){return re(function(){var r=e.shape[0],o=pW(Zn(_a(n.extra_dim,[r,1,1]),[-1,4]),Zn(e,[-1,4]));o=Zn(o,[r,o.shape[0]/r,4]);var i=gE(Ar(t,[0,0,1],[-1,-1,-1])),a=Ar(i,[0,0,0],[-1,-1,1]);a=Zn(a,[r,a.shape[1]]);var s=vt(o),u=vt(a);return{boxes:s,scores:u}})}function Qi(e,t){return re(function(){var n=e.shape[0],r=Zn(nr(e,t.box_encoding_predictor),[n,-1,1,4]),o=Zn(nr(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function mW(e,t,n){return re(function(){var r=vr(e,n.conv_0,[1,1]),o=vr(r,n.conv_1,[2,2]),i=vr(o,n.conv_2,[1,1]),a=vr(i,n.conv_3,[2,2]),s=vr(a,n.conv_4,[1,1]),u=vr(s,n.conv_5,[2,2]),l=vr(u,n.conv_6,[1,1]),c=vr(l,n.conv_7,[2,2]),d=Qi(t,n.box_predictor_0),f=Qi(e,n.box_predictor_1),h=Qi(o,n.box_predictor_2),v=Qi(a,n.box_predictor_3),p=Qi(u,n.box_predictor_4),g=Qi(c,n.box_predictor_5),m=pt([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,v.boxPredictionEncoding,p.boxPredictionEncoding,g.boxPredictionEncoding],1),y=pt([d.classPrediction,f.classPrediction,h.classPrediction,v.classPrediction,p.classPrediction,g.classPrediction],1);return{boxPredictions:m,classPredictions:y}})}var Xd=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),TS=function(e){we(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return re(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=yt($t(o,ee(.007843137718737125)),ee(1)),a=cW(i,r.mobilenetv1),s=mW(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return vW(u,l,r.output_layer)})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return he(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,_t(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,p,g,m,y,x,w,b,C,S,_;return he(this,function(k){switch(k.label){case 0:return o=new Xd(r),i=o.maxResults,a=o.minConfidence,[4,_t(n)];case 1:for(s=k.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,d=l[0],f=c[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return g=(p=Array).from,[4,f.data()];case 2:return v=g.apply(p,[k.sent()]),m=.5,y=dW(d,v,i,m,a),x=s.getReshapedInputDimensions(0),w=s.inputSize,b=w/x.width,C=w/x.height,S=d.arraySync(),_=y.map(function(R){var N=[Math.max(0,S[R][0]),Math.min(1,S[R][2])].map(function(z){return z*C}),P=N[0],L=N[1],M=[Math.max(0,S[R][1]),Math.min(1,S[R][3])].map(function(z){return z*b}),W=M[0],B=M[1];return new Rn(v[R],new Xm(W,P,B-W,L-P),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,_]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return aW(n)},t.prototype.extractParams=function(n){return oW(n)},t}(io);(function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(TS);var gW=.4,yW=[new Le(.738768,.874946),new Le(2.42204,2.65704),new Le(4.30971,7.04493),new Le(10.246,4.59428),new Le(12.6868,11.8741)],xW=[new Le(1.603231,2.094468),new Le(6.041143,7.080126),new Le(2.882459,3.518061),new Le(4.266906,5.178857),new Le(9.041765,10.66308)],wW=[117.001,114.697,97.404],bW="tiny_yolov2_model",CW="tiny_yolov2_separable_conv_model",Pl=function(e){return typeof e=="number"};function EW(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Pl(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return Pl(t.x)&&Pl(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(Pl)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function ag(e){return re(function(){var t=$t(e,ee(.10000000149011612));return Re(Je(yt(e,t)),t)})}function po(e,t){return re(function(){var n=Wi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Vn(n,t.conv.filters,[1,1],"valid"),n=yt(n,t.bn.sub),n=$t(n,t.bn.truediv),n=Re(n,t.conv.bias),ag(n)})}function vo(e,t){return re(function(){var n=Wi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Om(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Re(n,t.bias),ag(n)})}function SW(e,t){var n=Kd(e,t);function r(a,s){var u=lt(e(a)),l=lt(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=rg(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function _W(e,t,n,r){var o=so(e),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=SW(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(t.withSeparableConvs){var h=r[0],v=r[1],p=r[2],g=r[3],m=r[4],y=r[5],x=r[6],w=r[7],b=r[8],C=t.isFirstLayerConv2d?l(h,v,3,"conv0"):d(h,v,"conv0"),S=d(v,p,"conv1"),_=d(p,g,"conv2"),k=d(g,m,"conv3"),R=d(m,y,"conv4"),N=d(y,x,"conv5"),P=w?d(x,w,"conv6"):void 0,L=b?d(w,b,"conv7"):void 0,M=l(b||w||x,5*n,1,"conv8");f={conv0:C,conv1:S,conv2:_,conv3:k,conv4:R,conv5:N,conv6:P,conv7:L,conv8:M}}else{var h=r[0],v=r[1],p=r[2],g=r[3],m=r[4],y=r[5],x=r[6],w=r[7],b=r[8],C=c(h,v,"conv0"),S=c(v,p,"conv1"),_=c(p,g,"conv2"),k=c(g,m,"conv3"),R=c(m,y,"conv4"),N=c(y,x,"conv5"),P=c(x,w,"conv6"),L=c(w,b,"conv7"),M=l(b,5*n,1,"conv8");f={conv0:C,conv1:S,conv2:_,conv3:k,conv4:R,conv5:N,conv6:P,conv7:L,conv8:M}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function kW(e,t){var n=oi(e,t);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=og(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function RW(e,t){var n=[],r=kW(e,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return ao(e,n),{params:s,paramMappings:n}}var w1;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(w1||(w1={}));var sg=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),PS=function(e){we(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return EW(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=po(n,r.conv0);return o=bt(o,[2,2],[2,2],"same"),o=po(o,r.conv1),o=bt(o,[2,2],[2,2],"same"),o=po(o,r.conv2),o=bt(o,[2,2],[2,2],"same"),o=po(o,r.conv3),o=bt(o,[2,2],[2,2],"same"),o=po(o,r.conv4),o=bt(o,[2,2],[2,2],"same"),o=po(o,r.conv5),o=bt(o,[2,2],[1,1],"same"),o=po(o,r.conv6),o=po(o,r.conv7),nr(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?ag(nr(n,r.conv0,"valid",!1)):vo(n,r.conv0);return o=bt(o,[2,2],[2,2],"same"),o=vo(o,r.conv1),o=bt(o,[2,2],[2,2],"same"),o=vo(o,r.conv2),o=bt(o,[2,2],[2,2],"same"),o=vo(o,r.conv3),o=bt(o,[2,2],[2,2],"same"),o=vo(o,r.conv4),o=bt(o,[2,2],[2,2],"same"),o=vo(o,r.conv5),o=bt(o,[2,2],[1,1],"same"),o=r.conv6?vo(o,r.conv6):o,o=r.conv7?vo(o,r.conv7):o,nr(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return re(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?zu(a,o.config.meanRgb):a,a=a.div(ee(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},t.prototype.forward=function(n,r){return fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,_t(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,p,g,m,y=this;return he(this,function(x){switch(x.label){case 0:return o=new sg(r),i=o.inputSize,a=o.scoreThreshold,[4,_t(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,i)];case 2:return u=x.sent(),l=re(function(){return vt(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return d=x.sent(),u.dispose(),l.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),v=d.map(function(w){return w.classScore}),p=d.map(function(w){return y.config.classes[w.label]}),g=yu(f.map(function(w){return w.rescale(i)}),h,this.config.iouThreshold,!0),m=g.map(function(w){return new nS(h[w],v[w],p[w],f[w],c)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return RW(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return _W(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,p,g,m,y,x,w,b,C,S,_,k,R,N,P,L,M,W,B,z,A=this;return he(this,function(F){switch(F.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],d=this.config.anchors.length,f=re(function(){var U=n.reshape([c,c,d,A.boxEncodingSize]),j=U.slice([0,0,0,0],[c,c,d,4]),K=U.slice([0,0,0,4],[c,c,d,1]),Y=A.withClassScores?ro(U.slice([0,0,0,5],[c,c,d,A.config.classes.length]),3):ee(0);return[j,K,Y]}),h=f[0],v=f[1],p=f[2],g=[],[4,v.array()];case 1:return m=F.sent(),[4,h.array()];case 2:y=F.sent(),x=0,F.label=3;case 3:if(!(x<c))return[3,12];w=0,F.label=4;case 4:if(!(w<c))return[3,11];b=0,F.label=5;case 5:return b<d?(C=uh(m[x][w][b][0]),!o||C>o?(S=(w+uh(y[x][w][b][0]))/c*u,_=(x+uh(y[x][w][b][1]))/c*l,k=Math.exp(y[x][w][b][2])*this.config.anchors[b].x/c*u,R=Math.exp(y[x][w][b][3])*this.config.anchors[b].y/c*l,N=S-k/2,P=_-R/2,L={row:x,col:w,anchor:b},this.withClassScores?[4,this.extractPredictedClass(p,L)]:[3,7]):[3,9]):[3,10];case 6:return z=F.sent(),[3,8];case 7:z={classScore:1,label:0},F.label=8;case 8:M=z,W=M.classScore,B=M.label,g.push(Bt({box:new Hd(N,P,N+k,P+R),score:C,classScore:C*W,label:B},L)),F.label=9;case 9:return b++,[3,5];case 10:return w++,[3,4];case 11:return x++,[3,3];case 12:return h.dispose(),v.dispose(),p.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return fe(this,void 0,void 0,function(){var o,i,a,s;return he(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(io),IW=function(e){we(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:gW,classes:["face"]},n?{anchors:xW,meanRgb:wW}:{anchors:yW,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Rn(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?CW:bW},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(PS),TW=function(e){we(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(sg),$u=function(){function e(){}return e.prototype.then=function(t){return fe(this,void 0,void 0,function(){var n;return he(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return fe(this,void 0,void 0,function(){return he(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Yd(e,t,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),fe(this,void 0,void 0,function(){var i,a,s,u,l;return he(this,function(c){switch(c.label){case 0:return i=e.map(function(d){return xS(d)?o(d):d.detection}),s=r,s?[3,5]:t instanceof Qe?[4,tg(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,eg(t,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(d){return d instanceof Qe&&d.dispose()}),[2,l]}})})}function ug(e,t,n,r,o){return fe(this,void 0,void 0,function(){var i=this;return he(this,function(a){return[2,Yd([e],t,function(s){return fe(i,void 0,void 0,function(){return he(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function PW(e){return re(function(){return _n(vt(e,3).reverse(),3)})}var Al=2,Qc=12;function AW(e,t){var n=Kd(e,t),r=ng(e,t);function o(l,c){var d=lt(e(l));return t.push({paramPath:c}),d}function i(l,c,d){d===void 0&&(d=!1);var f=n(l[0],l[1],3,c+"/conv1"),h=o(l[1],c+"/prelu1_alpha"),v=n(l[1],l[2],3,c+"/conv2"),p=o(l[2],c+"/prelu2_alpha"),g=n(l[2],l[3],d?2:3,c+"/conv3"),m=o(l[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:v,prelu2_alpha:p,conv3:g,prelu3_alpha:m}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return Bt(Bt({},l),{conv4_1:c,conv4_2:d})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return Bt(Bt({},l),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),v=r(256,2,"onet/fc2_1"),p=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return Bt(Bt({},l),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:v,fc2_2:p,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function NW(e){var t=so(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=AW(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:d},paramMappings:o}}function DW(e,t){var n=oi(e,t);function r(c){var d=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:d,bias:f}}function o(c){var d=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:d,bias:f}}function i(c){return n(c,1)}function a(c){var d=r(c+"/conv1"),f=i(c+"/prelu1_alpha"),h=r(c+"/conv2"),v=i(c+"/prelu2_alpha"),p=r(c+"/conv3"),g=i(c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:v,conv3:p,prelu3_alpha:g}}function s(){var c=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Bt(Bt({},c),{conv4_1:d,conv4_2:f})}function u(){var c=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),v=o("rnet/fc2_2");return Bt(Bt({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:v})}function l(){var c=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),v=i("onet/prelu5_alpha"),p=o("onet/fc2_1"),g=o("onet/fc2_2"),m=o("onet/fc2_3");return Bt(Bt({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:v,fc2_1:p,fc2_2:g,fc2_3:m})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function MW(e){var t=[],n=DW(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return ao(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function Yp(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function FW(e,t,n){for(var r=n[0],o=n[1],i=Qc/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s=s*t,u+=1;return a}var lg=function(e){we(t,e);function t(n,r,o,i){return e.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return t}(Nr);function AS(e){return re(function(){return $t(yt(e,ee(127.5)),ee(.0078125))})}function Pa(e,t){return re(function(){return Re(Je(e),$t(t,jc(Je(jc(e)))))})}function cg(e,t,n){return n===void 0&&(n=!1),re(function(){var r=nr(e,t.conv1,"valid");return r=Pa(r,t.prelu1_alpha),r=bt(r,n?[2,2]:[3,3],[2,2],"same"),r=nr(r,t.conv2,"valid"),r=Pa(r,t.prelu2_alpha),r=n?r:bt(r,[3,3],[2,2],"valid"),r=nr(r,t.conv3,"valid"),r=Pa(r,t.prelu3_alpha),r})}function OW(e,t){return re(function(){var n=cg(e,t,!0),r=nr(n,t.conv4_1,"valid"),o=Mn($d(r,3),3),i=ro(yt(r,o),3),a=nr(n,t.conv4_2,"valid");return{prob:i,regions:a}})}function LW(e,t){return re(function(){var n=Yp(t,e.shape.slice(1)),r=n.height,o=n.width,i=$m.resizeBilinear(e,[r,o]),a=AS(i);return Yo(a,[0,2,1,3])})}function BW(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new Le(s,a));var u=o.map(function(l){var c=new Hd(Math.round((l.y*Al+1)/n),Math.round((l.x*Al+1)/n),Math.round((l.y*Al+Qc)/n),Math.round((l.x*Al+Qc)/n)),d=i[l.y][l.x],f=t.arraySync(),h=new lg(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3]);return{cell:c,score:d,region:h}});return u}function WW(e,t,n,r,o){o.stage1=[];var i=t.map(function(f){return re(function(){var h={scale:f},v=LW(e,f),p=Date.now(),g=OW(v,r),m=g.prob,y=g.regions;h.pnet=Date.now()-p;var x=vt(vt(m,3)[1])[0],w=vt(y)[0];return{scoresTensor:x,regionsTensor:w,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,v=f.regionsTensor,p=f.scale,g=f.statsForScale,m=BW(h,v,p,n);if(h.dispose(),v.dispose(),!m.length)return o.stage1.push(g),[];var y=Date.now(),x=yu(m.map(function(w){return w.cell}),m.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=x.length,o.stage1.push(g),x.map(function(w){return m[w]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),d=yu(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,v=f.region;return new Hd(h.left+v.left*h.width,h.top+v.top*h.height,h.right+v.right*h.width,h.bottom+v.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function NS(e,t,n){var r=n.width,o=n.height;return fe(this,void 0,void 0,function(){var i,a,s,u=this;return he(this,function(l){switch(l.label){case 0:return i=eo(e),[4,Promise.all(t.map(function(c){return fe(u,void 0,void 0,function(){var d,f,h,v,p,g,m,y;return he(this,function(x){return d=c.padAtBorders(e.height,e.width),f=d.y,h=d.ey,v=d.x,p=d.ex,g=v-1,m=f-1,y=i.getImageData(g,m,p-g,h-m),[2,Vt.isNodejs()?Zm(y):createImageBitmap(y)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var d=Gd({width:r,height:o}),f=eo(d);f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,v=[],p=0;p<h.length;p+=4)v.push(h[p+2]),v.push(h[p+1]),v.push(h[p]);s.push(v)}),[2,s.map(function(c){var d=re(function(){var f=Yo(Zt(c,[1,r,o,3]),[0,2,1,3]).toFloat();return AS(f)});return d})]}})})}function zW(e,t){return re(function(){var n=cg(e,t),r=Zn(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Sr(r,t.fc1),i=Pa(o,t.prelu4_alpha),a=Sr(i,t.fc2_1),s=Mn($d(a,1),1),u=ro(yt(a,s),1),l=Sr(i,t.fc2_2),c=vt(u,1)[1];return{scores:c,regions:l}})}function $W(e,t,n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,p,g,m,y;return he(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,NS(e,t,{width:24,height:24})];case 1:return a=x.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var b=zW(w,r);return w.dispose(),b}),o.stage2_rnet=Date.now()-i,u=s.length>1?pt(s.map(function(w){return w.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[x.sent()]),u.dispose(),f=l.map(function(w,b){return{score:w,idx:b}}).filter(function(w){return w.score>n}).map(function(w){var b=w.idx;return b}),h=f.map(function(w){return t[w]}),v=f.map(function(w){return l[w]}),p=[],g=[],h.length>0&&(i=Date.now(),m=yu(h,v,.7),o.stage2_nms=Date.now()-i,y=m.map(function(w){var b=s[f[w]].regions.arraySync();return new lg(b[0][0],b[0][1],b[0][2],b[0][3])}),g=m.map(function(w){return v[w]}),p=m.map(function(w,b){return h[w].calibrate(y[b])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:p,scores:g}]}})})}function UW(e,t){return re(function(){var n=cg(e,t);n=bt(n,[2,2],[2,2],"same"),n=nr(n,t.conv4,"valid"),n=Pa(n,t.prelu4_alpha);var r=Zn(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Sr(r,t.fc1),i=Pa(o,t.prelu5_alpha),a=Sr(i,t.fc2_1),s=Mn($d(a,1),1),u=ro(yt(a,s),1),l=Sr(i,t.fc2_2),c=Sr(i,t.fc2_3),d=vt(u,1)[1];return{scores:d,regions:l,points:c}})}function VW(e,t,n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,p,g,m,y,x;return he(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,NS(e,t,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(b){var C=UW(b,r);return b.dispose(),C}),o.stage3_onet=Date.now()-i,u=s.length>1?pt(s.map(function(b){return b.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[w.sent()]),u.dispose(),f=l.map(function(b,C){return{score:b,idx:C}}).filter(function(b){return b.score>n}).map(function(b){var C=b.idx;return C}),h=f.map(function(b){var C=s[b].regions.arraySync();return new lg(C[0][0],C[0][1],C[0][2],C[0][3])}),v=f.map(function(b,C){return t[b].calibrate(h[C])}),p=f.map(function(b){return l[b]}),g=[],m=[],y=[],v.length>0&&(i=Date.now(),x=yu(v,p,.7,!1),o.stage3_nms=Date.now()-i,g=x.map(function(b){return v[b]}),m=x.map(function(b){return p[b]}),y=x.map(function(b,C){return Array(5).fill(0).map(function(S,_){var k=s[b].points.arraySync();return new Le(k[0][_]*(g[C].width+1)+g[C].left,k[0][_+5]*(g[C].height+1)+g[C].top)})})),s.forEach(function(b){b.regions.dispose(),b.scores.dispose(),b.points.dispose()}),[2,{boxes:g,scores:m,points:y}]}})})}var jW=function(e){we(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return fe(this,void 0,void 0,function(){return he(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return fe(this,void 0,void 0,function(){return he(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,p,g,m,y,x,w,b,C,S,_;return he(this,function(k){switch(k.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=re(function(){return PW(Mn(Km.fromPixels(i)).toFloat())}),l=function(R){return u.dispose(),a.total=Date.now()-s,R},c=u.shape.slice(1),d=c[0],f=c[1],h=new IS(r),v=h.minFaceSize,p=h.scaleFactor,g=h.maxNumScales,m=h.scoreThresholds,y=h.scaleSteps,x=(y||FW(v,p,[d,f])).filter(function(R){var N=Yp(R,[d,f]);return Math.min(N.width,N.height)>Qc}).slice(0,g),a.scales=x,a.pyramid=x.map(function(R){return Yp(R,[d,f])}),w=Date.now(),[4,WW(u,x,m[0],o.pnet,a)];case 1:return b=k.sent(),a.total_stage1=Date.now()-w,b.boxes.length?(a.stage2_numInputBoxes=b.boxes.length,w=Date.now(),[4,$W(i,b.boxes,m[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return C=k.sent(),a.total_stage2=Date.now()-w,C.boxes.length?(a.stage3_numInputBoxes=C.boxes.length,w=Date.now(),[4,VW(i,C.boxes,m[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return S=k.sent(),a.total_stage3=Date.now()-w,_=S.boxes.map(function(R,N){return qd(wu({},new Rn(S.scores[N],new Xm(R.left/f,R.top/d,R.width/f,R.height/d),{height:d,width:f})),new yB(S.points[N].map(function(P){return P.sub(new Le(R.left,R.top)).div(new Le(R.width,R.height))}),{width:R.width,height:R.height}))}),[2,l({results:_,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,_t(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,_t(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return MW(n)},t.prototype.extractParams=function(n){return NW(n)},t}(io),HW=.4,GW=[new Le(1.603231,2.094468),new Le(6.041143,7.080126),new Le(2.882459,3.518061),new Le(4.266906,5.178857),new Le(9.041765,10.66308)],KW=[117.001,114.697,97.404],qW=function(e){we(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:HW,classes:["face"],anchors:GW,meanRgb:KW,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return fe(this,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Rn(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(PS),Bn={ssdMobilenetv1:new TS,tinyFaceDetector:new qW,tinyYolov2:new IW,mtcnn:new jW,faceLandmark68Net:new CS,faceLandmark68TinyNet:new XB,faceRecognitionNet:new nW,faceExpressionNet:new OB,ageGenderNet:new HB},DS=function(e){we(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}($u),dg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o=this;return he(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Yd(n,this.input,function(a){return fe(o,void 0,void 0,function(){return he(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Bn.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return yS(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new vg(this,this.input)},t}(DS),fg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,ug(n,this.input,function(i){return Bn.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,yS(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new mg(this,this.input)},t}(DS),hg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new gg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new xg(this,this.input)},t}(dg),pg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new yg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new wg(this,this.input)},t}(fg),MS=function(e){we(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}($u),vg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o=this;return he(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Yd(n,this.input,function(a){return fe(o,void 0,void 0,function(){return he(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Bn.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,d=u.genderProbability;return kS(RS(a,c,d),l)})]}})})},t.prototype.withFaceExpressions=function(){return new dg(this,this.input)},t}(MS),mg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a;return he(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,ug(n,this.input,function(u){return Bn.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,kS(RS(n,i,a),o)]}})})},t.prototype.withFaceExpressions=function(){return new fg(this,this.input)},t}(MS),gg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new hg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new xg(this,this.input)},t}(vg),yg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new pg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new wg(this,this.input)},t}(mg),FS=function(e){we(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}($u),xg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Yd(n,this.input,function(i){return Promise.all(i.map(function(a){return Bn.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return _S(n[a],i)})]}})})},t.prototype.withFaceExpressions=function(){return new hg(this,this.input)},t.prototype.withAgeAndGender=function(){return new gg(this,this.input)},t}(FS),wg=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,ug(n,this.input,function(i){return Bn.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,_S(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new pg(this,this.input)},t.prototype.withAgeAndGender=function(){return new yg(this,this.input)},t}(FS),OS=function(e){we(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Bn.faceLandmark68TinyNet:Bn.faceLandmark68Net},enumerable:!0,configurable:!0}),t}($u),XW=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return he(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof Qe?[4,tg(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,eg(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof Qe&&l.dispose()}),[2,n.map(function(l,c){return qd(l,a[c])})]}})})},t.prototype.withFaceExpressions=function(){return new hg(this,this.input)},t.prototype.withAgeAndGender=function(){return new gg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new xg(this,this.input)},t}(OS),YW=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a;return he(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof Qe?[4,tg(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,eg(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof Qe&&u.dispose()}),[2,qd(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new pg(this,this.input)},t.prototype.withAgeAndGender=function(){return new yg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new wg(this,this.input)},t}(OS),LS=function(e){we(t,e);function t(n,r){r===void 0&&(r=new Xd);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}($u),BS=function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i;return he(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof IS?[4,Bn.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof TW?function(s){return Bn.tinyFaceDetector.locateFaces(s,o)}:o instanceof Xd?function(s){return Bn.ssdMobilenetv1.locateFaces(s,o)}:o instanceof sg?function(s){return Bn.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return fe(n,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return wu({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new XW(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new dg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new vg(this.runAndExtendWithFaceDetections(),this.input)},t}(LS);(function(e){we(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return he(this,function(o){switch(o.label){case 0:return[4,new BS(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return fe(n,void 0,void 0,function(){var o;return he(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?wu({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new YW(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new fg(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new mg(this.runAndExtendWithFaceDetection(),this.input)},t})(LS);function y5(e,t){return t===void 0&&(t=new Xd),new BS(e,t)}function QW(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Rl)return a;if(a instanceof Float32Array)return new Rl(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Rl(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return QW(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new m1(i,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new m1("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return Rl.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();function JW(e,t){var n=new Si(t.width,t.height),r=n.width,o=n.height;if(r<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:o}));if(Array.isArray(e))return e.map(function(s){return JW(s,{width:r,height:o})});if(xS(e)){var i=e.detection.forSize(r,o),a=e.unshiftedLandmarks.forSize(i.box.width,i.box.height);return qd(wu(e,i),a)}return qc(e)?wu(e,e.detection.forSize(r,o)):e instanceof xu||e instanceof Rn?e.forSize(r,o):e}export{_z as $,az as A,Jz as B,sz as C,iz as D,n5 as E,Vz as F,Hz as G,$z as H,Gz as I,hz as J,vz as K,Yz as L,yz as M,bz as N,wz as O,tz as P,Bz as Q,rz as R,au as S,oz as T,xz as U,nz as V,Rz as W,Iz as X,o5 as Y,i5 as Z,a5 as _,uz as a,Sz as a0,u5 as a1,l5 as a2,c5 as a3,d5 as a4,kz as a5,Ez as a6,mz as a7,gz as a8,h5 as a9,p5 as aa,v5 as ab,xD as ac,_D as ad,pz as ae,Cz as af,lz as ag,Bn as ah,g5 as ai,TW as aj,y5 as ak,JW as al,m5 as am,Pz as b,tI as c,Nz as d,Lz as e,Oz as f,Z as g,Wz as h,zz as i,$ as j,FA as k,hR as l,jz as m,dz as n,e5 as o,fz as p,t5 as q,E as r,Kz as s,Tz as t,EA as u,qz as v,Xz as w,Qz as x,Zz as y,cz as z};
